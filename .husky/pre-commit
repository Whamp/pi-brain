#!/bin/sh
set -e

# Check if there are any staged files
if [ -z "$(git diff --cached --name-only)" ]; then
  echo "No staged files to check"
  exit 0
fi

# Build (includes DTS which enforces type correctness)
npm run build

# Check formatting
npx oxfmt --check -c .oxfmtrc.jsonc .

# Lint
npx oxlint -c .oxlintrc.json .

# Run tests
npm test -- --run

# Refresh codemap documentation
./scripts/refresh-codemap.sh
