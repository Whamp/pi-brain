# Code Review Fix Progress

Branch: fix/code-review-20260127-113810
Created: 2026-01-27 11:38
Main branch: major/pi-brain

## Issues to Fix

1. **P1 - Handoff Detection Missing** (src/parser/boundary.ts)
   - handoff boundary type specified in PLAN.md but not implemented
   - SessionEntry type lacks explicit handoff marker
   - Solution: Add handoff detection using heuristic (user message "handoff to X")

2. **P2 - Loose Root Handling** (src/parser/session.ts)
   - Multiple root entries handling returns first one silently
   - More defensive approach needed for corrupt sessions
   - Solution: Log warning when multiple roots detected

3. **P2 - Deprecated getProjectName** (src/parser/analyzer.ts)
   - Uses deprecated decodeProjectDir
   - Should require SessionHeader or SessionInfo for accurate paths
   - Solution: Add proper JSDoc deprecation, document alternative clearly

4. **P2 - Scalability - scanSessions** (src/parser/analyzer.ts)
   - Loads all sessions into memory
   - Will be bottleneck for large histories (thousands of sessions)
   - Solution: Add async generator variant (scanSessionsIterator)

5. **P3 - Hardcoded RESUME_GAP_MINUTES** (src/parser/boundary.ts)
   - Should move to configuration object
   - Solution: Accept config parameter with default fallback

---

## Progress Log

[2026-01-27 11:38] Started code review fix session

