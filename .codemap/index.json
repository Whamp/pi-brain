{
  "stats": {
    "totalFiles": 90,
    "totalSymbols": 1171,
    "byLanguage": {
      "typescript": 90
    },
    "bySymbolKind": {
      "function": 523,
      "type": 44,
      "interface": 274,
      "variable": 121,
      "class": 12,
      "property": 51,
      "constructor": 11,
      "method": 133,
      "getter": 2
    }
  },
  "total_tokens": 40226,
  "codebase_tokens": 1159465,
  "files": [
    {
      "path": "src/api/index.ts",
      "language": "typescript",
      "lines": [
        1,
        22
      ],
      "detail_level": "full",
      "token_estimate": 19,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./server.js",
        "./websocket.js"
      ]
    },
    {
      "path": "src/api/responses.ts",
      "language": "typescript",
      "lines": [
        1,
        52
      ],
      "detail_level": "full",
      "token_estimate": 199,
      "symbols": [
        {
          "name": "successResponse",
          "kind": "function",
          "signature": "successResponse<T>(data: T, durationMs?: number): { status: \"success\"; data: T; meta: { timestamp: any; duration_ms: number; }; }",
          "lines": [
            10,
            19
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "API response helpers\n\nShared response formatting utilities used by all route handlers.\nAPI response wrapper for success",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ApiErrorCode",
          "kind": "type",
          "signature": "ApiErrorCode = | \"BAD_REQUEST\"\n  | \"NOT_FOUND\"\n  | \"CONFLICT\"\n  | \"RATE_LIMITED\"\n  | \"INTERNAL_ERROR\"\n  | \"SERVICE_UNAVAILABLE\"",
          "lines": [
            24,
            30
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "API error codes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "errorResponse",
          "kind": "function",
          "signature": "errorResponse(code: ApiErrorCode, message: string, details?: Record<string, unknown>): { status: \"error\"; error: { code: ApiErrorCode; message: string; details: Record<string, unknown>; }; meta: { timestamp: any; }; }",
          "lines": [
            35,
            51
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "API response wrapper for errors",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/api/routes/agents.ts",
      "language": "typescript",
      "lines": [
        1,
        207
      ],
      "detail_level": "full",
      "token_estimate": 62,
      "symbols": [
        {
          "name": "agentsRoutes",
          "kind": "function",
          "signature": "async agentsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            22,
            206
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Register AGENTS.md routes",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../prompt/agents-generator.js",
        "../server.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/clusters.ts",
      "language": "typescript",
      "lines": [
        1,
        375
      ],
      "detail_level": "full",
      "token_estimate": 245,
      "symbols": [
        {
          "name": "ClusterNodeWithDetails",
          "kind": "interface",
          "signature": "ClusterNodeWithDetails extends ClusterNode",
          "lines": [
            16,
            21
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterWithNodes",
          "kind": "interface",
          "signature": "ClusterWithNodes extends Cluster",
          "lines": [
            23,
            25
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterRow",
          "kind": "interface",
          "signature": "ClusterRow",
          "lines": [
            28,
            40
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Database row shape for cluster queries",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterNodeRow",
          "kind": "interface",
          "signature": "ClusterNodeRow",
          "lines": [
            43,
            52
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Database row shape for cluster node queries",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "mapClusterRow",
          "kind": "function",
          "signature": "mapClusterRow(row: ClusterRow): ClusterWithNodes",
          "lines": [
            59,
            73
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Map a database row to a ClusterWithNodes object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "mapNodeRow",
          "kind": "function",
          "signature": "mapNodeRow(nr: ClusterNodeRow): ClusterNodeWithDetails",
          "lines": [
            76,
            87
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Map a node row to ClusterNodeWithDetails",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "fetchRepresentativeNodes",
          "kind": "function",
          "signature": "fetchRepresentativeNodes(db: Database, clusterIds: string[], limitPerCluster: number): Map<string, {}>",
          "lines": [
            93,
            136
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Batch fetch representative nodes for multiple clusters.\nReturns a map of clusterId -> nodes array.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clustersRoutes",
          "kind": "function",
          "signature": "async clustersRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            142,
            374
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../types/index.js",
        "better-sqlite3",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/config.ts",
      "language": "typescript",
      "lines": [
        1,
        1743
      ],
      "detail_level": "full",
      "token_estimate": 1243,
      "symbols": [
        {
          "name": "ValidationResult",
          "kind": "type",
          "signature": "ValidationResult = string | null",
          "lines": [
            32,
            32
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validation result - either success (null) or error message",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateIntRange",
          "kind": "function",
          "signature": "validateIntRange(value: number | undefined, field: string, min: number, max: number): string",
          "lines": [
            37,
            50
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate an integer field is within a range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateFloatRange",
          "kind": "function",
          "signature": "validateFloatRange(value: number | undefined, field: string, min: number, max: number): string",
          "lines": [
            55,
            68
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate a float field is within a range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateCronSchedule",
          "kind": "function",
          "signature": "validateCronSchedule(value: string | null | undefined, field: string): string",
          "lines": [
            74,
            85
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate a cron schedule expression\nReturns error message if invalid, null if valid or undefined",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "VALID_EMBEDDING_PROVIDERS",
          "kind": "variable",
          "signature": "readonly [\"ollama\", \"openai\", \"openrouter\"]",
          "lines": [
            90,
            90
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Valid embedding providers",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EmbeddingProvider",
          "kind": "type",
          "signature": "EmbeddingProvider = (typeof VALID_EMBEDDING_PROVIDERS)[number]",
          "lines": [
            91,
            91
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonConfigUpdateBody",
          "kind": "interface",
          "signature": "DaemonConfigUpdateBody",
          "lines": [
            96,
            124
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Daemon configuration update request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueryConfigUpdateBody",
          "kind": "interface",
          "signature": "QueryConfigUpdateBody",
          "lines": [
            129,
            132
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Query configuration update request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ApiConfigUpdateBody",
          "kind": "interface",
          "signature": "ApiConfigUpdateBody",
          "lines": [
            137,
            141
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "API configuration update request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "HubConfigUpdateBody",
          "kind": "interface",
          "signature": "HubConfigUpdateBody",
          "lines": [
            146,
            150
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Hub configuration update request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "VALID_SYNC_METHODS",
          "kind": "variable",
          "signature": "SyncMethod[]",
          "lines": [
            155,
            155
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Valid sync methods for spokes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RsyncOptionsBody",
          "kind": "interface",
          "signature": "RsyncOptionsBody",
          "lines": [
            160,
            165
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spoke rsync options request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeCreateBody",
          "kind": "interface",
          "signature": "SpokeCreateBody",
          "lines": [
            170,
            178
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spoke configuration create request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeUpdateBody",
          "kind": "interface",
          "signature": "SpokeUpdateBody",
          "lines": [
            183,
            190
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spoke configuration update request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeResponse",
          "kind": "interface",
          "signature": "SpokeResponse",
          "lines": [
            195,
            203
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spoke response format",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateDaemonUpdate",
          "kind": "function",
          "signature": "validateDaemonUpdate(body: DaemonConfigUpdateBody): string",
          "lines": [
            208,
            328
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate daemon configuration update fields",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasAnyDaemonField",
          "kind": "function",
          "signature": "hasAnyDaemonField(body: DaemonConfigUpdateBody): boolean",
          "lines": [
            333,
            335
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if daemon config update body has at least one field defined",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyNullableString",
          "kind": "function",
          "signature": "applyNullableString(target: NonNullable<RawConfig[\"daemon\"]>, key: keyof NonNullable<RawConfig[\"daemon\"]>, value: string | null | undefined): void",
          "lines": [
            341,
            356
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply an optional nullable string field to a raw config object\nnull/empty clears the field, undefined skips, string sets",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyNullableNumber",
          "kind": "function",
          "signature": "applyNullableNumber(target: NonNullable<RawConfig[\"daemon\"]>, key: keyof NonNullable<RawConfig[\"daemon\"]>, value: number | null | undefined): void",
          "lines": [
            362,
            376
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply an optional nullable numeric field to a raw config object\nnull clears the field, undefined skips, number sets",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyEmbeddingUpdates",
          "kind": "function",
          "signature": "applyEmbeddingUpdates(daemon: NonNullable<RawConfig[\"daemon\"]>, body: DaemonConfigUpdateBody): void",
          "lines": [
            381,
            402
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply embedding config updates to raw config object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyScheduleUpdates",
          "kind": "function",
          "signature": "applyScheduleUpdates(daemon: NonNullable<RawConfig[\"daemon\"]>, body: DaemonConfigUpdateBody): void",
          "lines": [
            407,
            436
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply schedule config updates to raw config object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyDaemonUpdates",
          "kind": "function",
          "signature": "applyDaemonUpdates(rawConfig: RawConfig, body: DaemonConfigUpdateBody): void",
          "lines": [
            441,
            504
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply daemon config updates to raw config object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateQueryUpdate",
          "kind": "function",
          "signature": "validateQueryUpdate(body: QueryConfigUpdateBody): string",
          "lines": [
            509,
            523
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate query configuration update fields",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateApiUpdate",
          "kind": "function",
          "signature": "validateApiUpdate(body: ApiConfigUpdateBody): string",
          "lines": [
            528,
            557
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate API configuration update fields",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validatePath",
          "kind": "function",
          "signature": "validatePath(p: string, field: string): string",
          "lines": [
            562,
            584
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate a path exists or has a writable parent",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateHubUpdate",
          "kind": "function",
          "signature": "validateHubUpdate(body: HubConfigUpdateBody): string",
          "lines": [
            589,
            623
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate hub configuration update fields",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateSpokeName",
          "kind": "function",
          "signature": "validateSpokeName(name: string): string",
          "lines": [
            628,
            639
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate spoke name is valid (alphanumeric, dash, underscore)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateRsyncOptions",
          "kind": "function",
          "signature": "validateRsyncOptions(options: RsyncOptionsBody | undefined, field: string): string",
          "lines": [
            644,
            682
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate rsync options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateSpokeCreate",
          "kind": "function",
          "signature": "validateSpokeCreate(body: SpokeCreateBody): string",
          "lines": [
            687,
            741
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate spoke create request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateSpokeUpdate",
          "kind": "function",
          "signature": "validateSpokeUpdate(body: SpokeUpdateBody): string",
          "lines": [
            746,
            787
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate spoke update request body",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spokeToResponse",
          "kind": "function",
          "signature": "spokeToResponse(spoke: {\n  name: string;\n  syncMethod: SyncMethod;\n  path: string;\n  source?: string;\n  enabled: boolean;\n  schedule?: string;\n  rsyncOptions?: RsyncOptions;\n}): SpokeResponse",
          "lines": [
            792,
            819
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Convert a spoke config to response format",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyQueryUpdates",
          "kind": "function",
          "signature": "applyQueryUpdates(rawConfig: RawConfig, body: QueryConfigUpdateBody): void",
          "lines": [
            824,
            842
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply query config updates to raw config object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyApiUpdates",
          "kind": "function",
          "signature": "applyApiUpdates(rawConfig: RawConfig, body: ApiConfigUpdateBody): void",
          "lines": [
            847,
            868
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply API config updates to raw config object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "applyHubUpdates",
          "kind": "function",
          "signature": "applyHubUpdates(rawConfig: RawConfig, body: HubConfigUpdateBody): void",
          "lines": [
            873,
            894
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Apply hub config updates to raw config object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "configRoutes",
          "kind": "function",
          "signature": "async configRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            896,
            1742
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../config/config.js",
        "../../config/types.js",
        "../../daemon/scheduler.js",
        "../responses.js",
        "fastify",
        "node:fs",
        "node:path",
        "yaml"
      ]
    },
    {
      "path": "src/api/routes/daemon.ts",
      "language": "typescript",
      "lines": [
        1,
        157
      ],
      "detail_level": "full",
      "token_estimate": 64,
      "symbols": [
        {
          "name": "daemonRoutes",
          "kind": "function",
          "signature": "async daemonRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            22,
            156
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../daemon/cli.js",
        "../../daemon/queue.js",
        "../responses.js",
        "fastify",
        "node:fs",
        "node:path"
      ]
    },
    {
      "path": "src/api/routes/decisions.ts",
      "language": "typescript",
      "lines": [
        1,
        94
      ],
      "detail_level": "full",
      "token_estimate": 79,
      "symbols": [
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            18,
            24
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "decisionsRoutes",
          "kind": "function",
          "signature": "async decisionsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            26,
            93
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/decision-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/edges.ts",
      "language": "typescript",
      "lines": [
        1,
        221
      ],
      "detail_level": "full",
      "token_estimate": 85,
      "symbols": [
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            21,
            27
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "edgesRoutes",
          "kind": "function",
          "signature": "async edgesRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            29,
            220
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/edge-repository.js",
        "../../storage/node-types.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/lessons.ts",
      "language": "typescript",
      "lines": [
        1,
        94
      ],
      "detail_level": "full",
      "token_estimate": 105,
      "symbols": [
        {
          "name": "parseArrayParam",
          "kind": "function",
          "signature": "parseArrayParam(value: string | undefined): {}",
          "lines": [
            18,
            26
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse comma-separated string to array",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            31,
            37
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "lessonsRoutes",
          "kind": "function",
          "signature": "async lessonsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            39,
            93
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/lesson-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/nodes.ts",
      "language": "typescript",
      "lines": [
        1,
        243
      ],
      "detail_level": "full",
      "token_estimate": 205,
      "symbols": [
        {
          "name": "parseArrayParam",
          "kind": "function",
          "signature": "parseArrayParam(value: string | undefined): {}",
          "lines": [
            28,
            36
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse comma-separated string to array",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseBooleanParam",
          "kind": "function",
          "signature": "parseBooleanParam(value: string | undefined): boolean",
          "lines": [
            41,
            46
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse boolean query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            51,
            57
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodesRoutes",
          "kind": "function",
          "signature": "async nodesRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            59,
            242
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/graph-repository.js",
        "../../storage/index.js",
        "../../storage/lesson-repository.js",
        "../../storage/node-conversion.js",
        "../../storage/node-queries.js",
        "../../storage/node-storage.js",
        "../../storage/node-types.js",
        "../../storage/quirk-repository.js",
        "../../storage/tool-error-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/patterns.ts",
      "language": "typescript",
      "lines": [
        1,
        119
      ],
      "detail_level": "full",
      "token_estimate": 103,
      "symbols": [
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined, paramName?: string, logger?: FastifyBaseLogger): number",
          "lines": [
            22,
            39
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param with optional debug logging for invalid values",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "patternsRoutes",
          "kind": "function",
          "signature": "async patternsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            41,
            118
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/pattern-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/prompt-learning.ts",
      "language": "typescript",
      "lines": [
        1,
        166
      ],
      "detail_level": "full",
      "token_estimate": 67,
      "symbols": [
        {
          "name": "promptLearningRoutes",
          "kind": "function",
          "signature": "async promptLearningRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            18,
            165
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../prompt/effectiveness.js",
        "../../storage/pattern-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/query.ts",
      "language": "typescript",
      "lines": [
        1,
        281
      ],
      "detail_level": "full",
      "token_estimate": 234,
      "symbols": [
        {
          "name": "DEFAULT_QUERY_CONFIG",
          "kind": "variable",
          "signature": "DEFAULT_QUERY_CONFIG",
          "lines": [
            24,
            47
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default daemon config for query processing",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "cachedEmbeddingProvider",
          "kind": "variable",
          "signature": "EmbeddingProvider | undefined",
          "lines": [
            53,
            53
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Cached embedding provider instance.\nCreated once on first use to avoid HTTP client setup overhead per request.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "cachedEmbeddingConfig",
          "kind": "variable",
          "signature": "string | undefined",
          "lines": [
            54,
            54
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEmbeddingProvider",
          "kind": "function",
          "signature": "getEmbeddingProvider(config: {\n  embeddingProvider?: \"openrouter\" | \"ollama\" | \"openai\";\n  embeddingModel?: string;\n  embeddingApiKey?: string;\n  embeddingBaseUrl?: string;\n  embeddingDimensions?: number;\n}): any",
          "lines": [
            60,
            104
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get or create the embedding provider with caching.\nCache is invalidated if the configuration changes.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "queryRoutes",
          "kind": "function",
          "signature": "async queryRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            106,
            280
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../daemon/facet-discovery.js",
        "../../daemon/query-processor.js",
        "../responses.js",
        "fastify",
        "node:child_process",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/api/routes/quirks.ts",
      "language": "typescript",
      "lines": [
        1,
        110
      ],
      "detail_level": "full",
      "token_estimate": 78,
      "symbols": [
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            19,
            25
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "quirksRoutes",
          "kind": "function",
          "signature": "async quirksRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            27,
            109
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/quirk-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/search.ts",
      "language": "typescript",
      "lines": [
        1,
        105
      ],
      "detail_level": "full",
      "token_estimate": 114,
      "symbols": [
        {
          "name": "parseArrayParam",
          "kind": "function",
          "signature": "parseArrayParam(value: string | undefined): {}",
          "lines": [
            19,
            27
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse comma-separated string to array",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            32,
            38
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "searchRoutes",
          "kind": "function",
          "signature": "async searchRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            40,
            104
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/node-queries.js",
        "../../storage/search-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/sessions.ts",
      "language": "typescript",
      "lines": [
        1,
        273
      ],
      "detail_level": "full",
      "token_estimate": 134,
      "symbols": [
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            20,
            26
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionSummary",
          "kind": "interface",
          "signature": "SessionSummary",
          "lines": [
            31,
            45
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Session summary for the file browser",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ProjectSummary",
          "kind": "interface",
          "signature": "ProjectSummary",
          "lines": [
            50,
            55
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Project summary for the file browser",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sessionsRoutes",
          "kind": "function",
          "signature": "async sessionsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            57,
            272
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/node-conversion.js",
        "../../storage/node-queries.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/signals.ts",
      "language": "typescript",
      "lines": [
        1,
        260
      ],
      "detail_level": "full",
      "token_estimate": 238,
      "symbols": [
        {
          "name": "AbandonedRestartPattern",
          "kind": "interface",
          "signature": "AbandonedRestartPattern",
          "lines": [
            19,
            33
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FrictionSummary",
          "kind": "interface",
          "signature": "FrictionSummary",
          "lines": [
            35,
            48
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "signalsRoutes",
          "kind": "function",
          "signature": "async signalsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            54,
            111
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAbandonedRestartPatterns",
          "kind": "function",
          "signature": "getAbandonedRestartPatterns(db: Database.Database, limit: number, offset: number): {}",
          "lines": [
            122,
            166
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get abandoned restart patterns by querying the signals column.\n\nUses SQLite's json_extract to query the stored signals JSON.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countAbandonedRestartPatterns",
          "kind": "function",
          "signature": "countAbandonedRestartPatterns(db: Database.Database): number",
          "lines": [
            173,
            181
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count total abandoned restart patterns using the signals column.\n\nThis is now accurate instead of an approximation.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getFrictionSummary",
          "kind": "function",
          "signature": "getFrictionSummary(db: Database.Database): FrictionSummary",
          "lines": [
            188,
            259
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get friction summary statistics using the signals column.\n\nQueries are now efficient using SQLite's json_extract.",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../types/index.js",
        "../responses.js",
        "better-sqlite3",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/stats.ts",
      "language": "typescript",
      "lines": [
        1,
        165
      ],
      "detail_level": "full",
      "token_estimate": 92,
      "symbols": [
        {
          "name": "statsRoutes",
          "kind": "function",
          "signature": "async statsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            16,
            155
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countEdges",
          "kind": "function",
          "signature": "countEdges(db: Database.Database): number",
          "lines": [
            160,
            164
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count edges in the database",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/node-queries.js",
        "../../storage/tool-error-repository.js",
        "../responses.js",
        "better-sqlite3",
        "fastify"
      ]
    },
    {
      "path": "src/api/routes/tool-errors.ts",
      "language": "typescript",
      "lines": [
        1,
        121
      ],
      "detail_level": "full",
      "token_estimate": 81,
      "symbols": [
        {
          "name": "parseIntParam",
          "kind": "function",
          "signature": "parseIntParam(value: string | undefined): number",
          "lines": [
            19,
            25
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse integer query param",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "toolErrorsRoutes",
          "kind": "function",
          "signature": "async toolErrorsRoutes(app: FastifyInstance): Promise<void>",
          "lines": [
            27,
            120
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../storage/tool-error-repository.js",
        "../responses.js",
        "fastify"
      ]
    },
    {
      "path": "src/api/server.ts",
      "language": "typescript",
      "lines": [
        1,
        205
      ],
      "detail_level": "full",
      "token_estimate": 321,
      "symbols": [
        {
          "name": "ServerContext",
          "kind": "interface",
          "signature": "ServerContext",
          "lines": [
            49,
            54
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Server context passed to route handlers",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createServer",
          "kind": "function",
          "signature": "async createServer(db: Database, config: ApiConfig, daemonConfig?: DaemonConfig, wsManager?: WebSocketManager): Promise<FastifyInstance>",
          "lines": [
            68,
            166
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create and configure the Fastify server",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ServerResult",
          "kind": "interface",
          "signature": "ServerResult",
          "lines": [
            171,
            174
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Server result including the Fastify instance and WebSocket manager",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "startServer",
          "kind": "function",
          "signature": "async startServer(db: Database, config: ApiConfig, daemonConfig?: DaemonConfig, wsManager?: WebSocketManager): Promise<ServerResult>",
          "lines": [
            179,
            197
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Start the API server",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/types.js",
        "./responses.js",
        "./routes/agents.js",
        "./routes/clusters.js",
        "./routes/config.js",
        "./routes/daemon.js",
        "./routes/decisions.js",
        "./routes/edges.js",
        "./routes/lessons.js",
        "./routes/nodes.js",
        "./routes/patterns.js",
        "./routes/prompt-learning.js",
        "./routes/query.js",
        "./routes/quirks.js",
        "./routes/search.js",
        "./routes/sessions.js",
        "./routes/signals.js",
        "./routes/stats.js",
        "./routes/tool-errors.js",
        "./websocket.js",
        "@fastify/cors",
        "@fastify/websocket",
        "better-sqlite3",
        "fastify"
      ]
    },
    {
      "path": "src/api/websocket.ts",
      "language": "typescript",
      "lines": [
        1,
        404
      ],
      "detail_level": "full",
      "token_estimate": 942,
      "symbols": [
        {
          "name": "WS_READY_STATE",
          "kind": "variable",
          "signature": "{ readonly CONNECTING: 0; readonly OPEN: 1; readonly CLOSING: 2; readonly CLOSED: 3; }",
          "lines": [
            19,
            24
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "WebSocket ready state values (mirrors WebSocket.OPEN, etc.)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WSChannel",
          "kind": "type",
          "signature": "WSChannel = \"daemon\" | \"analysis\" | \"node\" | \"queue\"",
          "lines": [
            31,
            31
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Available subscription channels",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WSEventType",
          "kind": "type",
          "signature": "WSEventType = | \"daemon.status\"\n  | \"analysis.started\"\n  | \"analysis.completed\"\n  | \"analysis.failed\"\n  | \"node.created\"\n  | \"queue.updated\"\n  | \"subscribed\"\n  | \"error\"",
          "lines": [
            34,
            42
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "WebSocket message types from server to client",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WSMessage",
          "kind": "interface",
          "signature": "WSMessage",
          "lines": [
            45,
            49
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Message format for WebSocket events",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SubscribeMessage",
          "kind": "interface",
          "signature": "SubscribeMessage",
          "lines": [
            52,
            55
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Client subscription request",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClientMessage",
          "kind": "type",
          "signature": "ClientMessage = SubscribeMessage",
          "lines": [
            58,
            58
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Client message union type",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WSClient",
          "kind": "interface",
          "signature": "WSClient",
          "lines": [
            61,
            65
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Connected client with subscriptions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WebSocketManager",
          "kind": "class",
          "signature": "WebSocketManager",
          "lines": [
            74,
            359
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Manages WebSocket connections and broadcasts events",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clients",
          "kind": "property",
          "signature": "clients",
          "lines": [
            75,
            75
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "logger",
          "kind": "property",
          "signature": "logger: {\n    info: (msg: string) => void;\n    error: (msg: string) => void;\n    debug: (msg: string) => void;\n  }",
          "lines": [
            76,
            80
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(logger?: {\n    info: (msg: string) => void;\n    error: (msg: string) => void;\n    debug: (msg: string) => void;\n  })",
          "lines": [
            82,
            92
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleConnection",
          "kind": "method",
          "signature": "handleConnection(socket: WebSocket): void",
          "lines": [
            97,
            124
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Handle a new WebSocket connection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleMessage",
          "kind": "method",
          "signature": "handleMessage(client: WSClient, data: Buffer | string): void",
          "lines": [
            129,
            158
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Handle incoming message from client",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleSubscribe",
          "kind": "method",
          "signature": "handleSubscribe(client: WSClient, message: SubscribeMessage): void",
          "lines": [
            163,
            196
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Handle subscription request",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sendToClient",
          "kind": "method",
          "signature": "sendToClient(client: WSClient, message: WSMessage): void",
          "lines": [
            201,
            211
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Send message to a specific client",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "broadcast",
          "kind": "method",
          "signature": "broadcast(channel: WSChannel, message: WSMessage): void",
          "lines": [
            216,
            229
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Broadcast message to all subscribed clients",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getClientCount",
          "kind": "method",
          "signature": "getClientCount(): number",
          "lines": [
            234,
            236
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Get connected client count",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "closeAll",
          "kind": "method",
          "signature": "closeAll(): void",
          "lines": [
            241,
            246
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Close all connections",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "broadcastDaemonStatus",
          "kind": "method",
          "signature": "broadcastDaemonStatus(status: {\n    running: boolean;\n    pid?: number;\n    uptime?: number;\n    workers?: {\n      total: number;\n      active: number;\n      idle: number;\n    };\n    queue?: {\n      pending: number;\n      running: number;\n      completedToday: number;\n      failedToday: number;\n    };\n    lastAnalysis?: string;\n    nextScheduled?: {\n      reanalysis?: string;\n      connectionDiscovery?: string;\n    };\n  }): void",
          "lines": [
            255,
            281
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Broadcast daemon status update",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "broadcastAnalysisStarted",
          "kind": "method",
          "signature": "broadcastAnalysisStarted(job: AnalysisJob, workerId: string): void",
          "lines": [
            286,
            296
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Broadcast analysis started event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "broadcastAnalysisCompleted",
          "kind": "method",
          "signature": "broadcastAnalysisCompleted(job: AnalysisJob, node: Node): void",
          "lines": [
            301,
            323
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Broadcast analysis completed event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "broadcastAnalysisFailed",
          "kind": "method",
          "signature": "broadcastAnalysisFailed(job: AnalysisJob, error: Error, willRetry: boolean): void",
          "lines": [
            328,
            342
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Broadcast analysis failed event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "broadcastQueueUpdate",
          "kind": "method",
          "signature": "broadcastQueueUpdate(stats: {\n    pending: number;\n    running: number;\n    completed: number;\n    failed: number;\n  }): void",
          "lines": [
            347,
            358
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "WebSocketManager",
          "annotation": null,
          "comment": "Broadcast queue update event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "registerWebSocketRoute",
          "kind": "function",
          "signature": "registerWebSocketRoute(app: FastifyInstance, wsManager: WebSocketManager): void",
          "lines": [
            368,
            380
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Register the WebSocket route on a Fastify instance",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "globalWSManager",
          "kind": "variable",
          "signature": "WebSocketManager | null",
          "lines": [
            386,
            386
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getWebSocketManager",
          "kind": "function",
          "signature": "getWebSocketManager(): WebSocketManager",
          "lines": [
            391,
            396
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get or create the global WebSocket manager",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "setWebSocketManager",
          "kind": "function",
          "signature": "setWebSocketManager(manager: WebSocketManager): void",
          "lines": [
            401,
            403
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Set the global WebSocket manager (for testing or custom config)",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../daemon/queue.js",
        "../storage/node-types.js",
        "fastify",
        "ws"
      ]
    },
    {
      "path": "src/cli.ts",
      "language": "typescript",
      "lines": [
        1,
        1148
      ],
      "detail_level": "full",
      "token_estimate": 157,
      "symbols": [
        {
          "name": "program",
          "kind": "variable",
          "signature": "any",
          "lines": [
            73,
            73
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "daemonCmd",
          "kind": "variable",
          "signature": "any",
          "lines": [
            200,
            202
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "syncCmd",
          "kind": "variable",
          "signature": "any",
          "lines": [
            389,
            391
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "promptCmd",
          "kind": "variable",
          "signature": "any",
          "lines": [
            554,
            556
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "agentsCmd",
          "kind": "variable",
          "signature": "any",
          "lines": [
            941,
            943
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "exportCmd",
          "kind": "variable",
          "signature": "any",
          "lines": [
            1092,
            1094
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./config/index.js",
        "./daemon/export.js",
        "./daemon/graph-export.js",
        "./daemon/index.js",
        "./parser/analyzer.js",
        "./prompt/agents-generator.js",
        "./prompt/effectiveness.js",
        "./prompt/prompt-generator.js",
        "./prompt/prompt-injector.js",
        "./storage/database.js",
        "./storage/pattern-repository.js",
        "./sync/index.js",
        "./types/index.js",
        "./web/generator.js",
        "commander",
        "node:fs",
        "node:fs/promises",
        "node:path",
        "open"
      ]
    },
    {
      "path": "src/config/config.ts",
      "language": "typescript",
      "lines": [
        1,
        773
      ],
      "detail_level": "full",
      "token_estimate": 836,
      "symbols": [
        {
          "name": "DEFAULT_CONFIG_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            25,
            25
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default configuration directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_CONFIG_PATH",
          "kind": "variable",
          "signature": "any",
          "lines": [
            30,
            30
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default configuration file path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "expandPath",
          "kind": "function",
          "signature": "expandPath(p: string): string",
          "lines": [
            35,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Expand ~ in paths to home directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultHubConfig",
          "kind": "function",
          "signature": "getDefaultHubConfig(): HubConfig",
          "lines": [
            48,
            54
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default hub configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultDaemonConfig",
          "kind": "function",
          "signature": "getDefaultDaemonConfig(): DaemonConfig",
          "lines": [
            59,
            93
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default daemon configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultQueryConfig",
          "kind": "function",
          "signature": "getDefaultQueryConfig(): QueryConfig",
          "lines": [
            98,
            103
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default query configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultApiConfig",
          "kind": "function",
          "signature": "getDefaultApiConfig(): ApiConfig",
          "lines": [
            108,
            118
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default API configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultConfig",
          "kind": "function",
          "signature": "getDefaultConfig(): PiBrainConfig",
          "lines": [
            123,
            131
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get complete default configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateSyncMethod",
          "kind": "function",
          "signature": "validateSyncMethod(method: string, spokeName: string): SyncMethod",
          "lines": [
            136,
            153
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate sync method",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateSpoke",
          "kind": "function",
          "signature": "validateSpoke(raw: RawConfig[\"spokes\"], index: number): SpokeConfig",
          "lines": [
            160,
            273
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate spoke configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateCronSchedule",
          "kind": "function",
          "signature": "validateCronSchedule(schedule: string, field: string): void",
          "lines": [
            278,
            286
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate cron schedule format (basic validation)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validatePort",
          "kind": "function",
          "signature": "validatePort(port: number, field: string): void",
          "lines": [
            291,
            297
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate port number",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validatePositiveInt",
          "kind": "function",
          "signature": "validatePositiveInt(value: number, field: string): void",
          "lines": [
            302,
            308
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate positive integer",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateNonNegativeInt",
          "kind": "function",
          "signature": "validateNonNegativeInt(value: number, field: string): void",
          "lines": [
            313,
            319
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate non-negative integer",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "transformConfig",
          "kind": "function",
          "signature": "transformConfig(raw: RawConfig): PiBrainConfig",
          "lines": [
            326,
            504
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Transform raw YAML config to typed config with validation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ConfigError",
          "kind": "class",
          "signature": "ConfigError extends Error",
          "lines": [
            509,
            517
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Configuration loading errors",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(message: string, public readonly configPath?: string)",
          "lines": [
            510,
            516
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConfigError",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "loadConfig",
          "kind": "function",
          "signature": "loadConfig(configPath?: string): PiBrainConfig",
          "lines": [
            522,
            577
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Load configuration from a YAML file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ensureConfigDir",
          "kind": "function",
          "signature": "ensureConfigDir(configDir?: string): void",
          "lines": [
            582,
            587
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Ensure the config directory exists",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ensureDirectories",
          "kind": "function",
          "signature": "ensureDirectories(config: PiBrainConfig): void",
          "lines": [
            592,
            627
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Ensure all required directories exist based on configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "writeDefaultConfig",
          "kind": "function",
          "signature": "writeDefaultConfig(configPath?: string): void",
          "lines": [
            632,
            691
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Write a default configuration file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSessionDirs",
          "kind": "function",
          "signature": "getSessionDirs(config: PiBrainConfig): {}",
          "lines": [
            696,
            704
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all session directories to watch (hub + enabled spokes)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEnabledSpokes",
          "kind": "function",
          "signature": "getEnabledSpokes(config: PiBrainConfig): {}",
          "lines": [
            709,
            711
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get enabled spokes from configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getRsyncSpokes",
          "kind": "function",
          "signature": "getRsyncSpokes(config: PiBrainConfig): {}",
          "lines": [
            716,
            720
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get rsync spokes (enabled spokes with rsync sync method)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getScheduledRsyncSpokes",
          "kind": "function",
          "signature": "getScheduledRsyncSpokes(config: PiBrainConfig): {}",
          "lines": [
            725,
            732
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get scheduled rsync spokes (rsync spokes with a schedule)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getComputerFromPath",
          "kind": "function",
          "signature": "getComputerFromPath(sessionPath: string, config: PiBrainConfig): string",
          "lines": [
            743,
            772
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the computer name for a session based on its path.\n\nFor sessions from spoke directories, returns the spoke name.\nFor local sessions (hub), returns the local hostname.\n\nUses proper path boundary checking to avoid false matches\n(e.g., `/synced/laptop` should not match `/synced/laptop-backup/...`)",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./types.js",
        "node:fs",
        "node:os",
        "node:path",
        "yaml"
      ]
    },
    {
      "path": "src/config/index.ts",
      "language": "typescript",
      "lines": [
        1,
        36
      ],
      "detail_level": "full",
      "token_estimate": 18,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./config.js",
        "./types.js"
      ]
    },
    {
      "path": "src/config/types.ts",
      "language": "typescript",
      "lines": [
        1,
        264
      ],
      "detail_level": "full",
      "token_estimate": 306,
      "symbols": [
        {
          "name": "SyncMethod",
          "kind": "type",
          "signature": "SyncMethod = \"syncthing\" | \"rsync\" | \"api\"",
          "lines": [
            11,
            11
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Configuration types for pi-brain\n\nConfiguration is loaded from ~/.pi-brain/config.yaml\nAll paths support ~ expansion for home directory\nSpoke sync method options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RsyncOptions",
          "kind": "interface",
          "signature": "RsyncOptions",
          "lines": [
            16,
            28
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Rsync-specific options for spoke configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeConfig",
          "kind": "interface",
          "signature": "SpokeConfig",
          "lines": [
            34,
            55
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spoke machine configuration\nSpokes are secondary machines that sync sessions to the hub",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "HubConfig",
          "kind": "interface",
          "signature": "HubConfig",
          "lines": [
            61,
            70
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Hub configuration\nThe hub is the primary computer where daemon runs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonConfig",
          "kind": "interface",
          "signature": "DaemonConfig",
          "lines": [
            76,
            154
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Daemon configuration\nControls the background analysis process",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueryConfig",
          "kind": "interface",
          "signature": "QueryConfig",
          "lines": [
            160,
            166
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Query configuration\nControls the /brain query interface",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ApiConfig",
          "kind": "interface",
          "signature": "ApiConfig",
          "lines": [
            171,
            180
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "API server configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiBrainConfig",
          "kind": "interface",
          "signature": "PiBrainConfig",
          "lines": [
            185,
            200
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Complete pi-brain configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RawConfig",
          "kind": "interface",
          "signature": "RawConfig",
          "lines": [
            206,
            263
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Raw YAML configuration (snake_case, before transformation)\nThis matches the YAML file structure",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/daemon/cli.ts",
      "language": "typescript",
      "lines": [
        1,
        1222
      ],
      "detail_level": "full",
      "token_estimate": 1207,
      "symbols": [
        {
          "name": "isPortAvailable",
          "kind": "function",
          "signature": "isPortAvailable(port: number): Promise<boolean>",
          "lines": [
            61,
            70
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a port is available",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findProcessOnPort",
          "kind": "function",
          "signature": "findProcessOnPort(port: number): number",
          "lines": [
            75,
            88
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find process using a port (Linux/macOS)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sleep",
          "kind": "function",
          "signature": "sleep(ms: number): Promise<void>",
          "lines": [
            97,
            101
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Sleep for a specified duration (lint-compliant)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PID_FILE",
          "kind": "variable",
          "signature": "any",
          "lines": [
            108,
            108
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "PID file location",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LOG_FILE",
          "kind": "variable",
          "signature": "any",
          "lines": [
            111,
            111
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Log file location",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonStatus",
          "kind": "interface",
          "signature": "DaemonStatus",
          "lines": [
            114,
            120
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Daemon status info",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueueStatus",
          "kind": "interface",
          "signature": "QueueStatus",
          "lines": [
            123,
            128
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Queue status info",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "HealthCheckResult",
          "kind": "interface",
          "signature": "HealthCheckResult",
          "lines": [
            131,
            136
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Health check result",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "HealthStatus",
          "kind": "interface",
          "signature": "HealthStatus",
          "lines": [
            139,
            143
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Overall health status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "OutputOptions",
          "kind": "interface",
          "signature": "OutputOptions",
          "lines": [
            146,
            149
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "CLI output options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "readPidFile",
          "kind": "function",
          "signature": "readPidFile(): number",
          "lines": [
            158,
            169
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Read the daemon PID from the PID file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "writePidFile",
          "kind": "function",
          "signature": "writePidFile(pid: number): void",
          "lines": [
            174,
            180
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Write the daemon PID to the PID file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "removePidFile",
          "kind": "function",
          "signature": "removePidFile(): void",
          "lines": [
            185,
            193
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Remove the PID file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isProcessRunning",
          "kind": "function",
          "signature": "isProcessRunning(pid: number): boolean",
          "lines": [
            198,
            206
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a process with the given PID is running",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isDaemonRunning",
          "kind": "function",
          "signature": "isDaemonRunning(): { running: boolean; pid: number; }",
          "lines": [
            211,
            224
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if the daemon is currently running",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatUptime",
          "kind": "function",
          "signature": "formatUptime(seconds: number): string",
          "lines": [
            233,
            254
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format uptime in a human-readable way",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getProcessUptime",
          "kind": "function",
          "signature": "getProcessUptime(): number",
          "lines": [
            259,
            269
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get process uptime (approximate based on PID file modification time)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "StartOptions",
          "kind": "interface",
          "signature": "StartOptions",
          "lines": [
            276,
            280
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Start options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "StopOptions",
          "kind": "interface",
          "signature": "StopOptions",
          "lines": [
            283,
            286
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Stop options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "startDaemon",
          "kind": "function",
          "signature": "async startDaemon(options: StartOptions = {}): Promise<{ success: boolean; message: string; pid?: number; }>",
          "lines": [
            291,
            436
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Start the daemon process",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "stopDaemon",
          "kind": "function",
          "signature": "async stopDaemon(options: StopOptions = {}): Promise<{ success: boolean; message: string; }>",
          "lines": [
            441,
            503
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Stop the daemon process",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDaemonStatus",
          "kind": "function",
          "signature": "getDaemonStatus(configPath?: string): DaemonStatus",
          "lines": [
            508,
            520
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get daemon status information",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getQueueStatus",
          "kind": "function",
          "signature": "getQueueStatus(configPath?: string): QueueStatus",
          "lines": [
            529,
            558
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get queue status information",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "queueAnalysis",
          "kind": "function",
          "signature": "queueAnalysis(sessionPath: string, configPath?: string): { success: boolean; message: string; jobId?: string; }",
          "lines": [
            563,
            616
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Queue a session for analysis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkPiCli",
          "kind": "function",
          "signature": "checkPiCli(): Promise<HealthCheckResult>",
          "lines": [
            625,
            662
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if the pi CLI is available",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkRequiredSkills",
          "kind": "function",
          "signature": "async checkRequiredSkills(): Promise<HealthCheckResult>",
          "lines": [
            667,
            692
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check required skills",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkOptionalSkills",
          "kind": "function",
          "signature": "async checkOptionalSkills(): Promise<HealthCheckResult>",
          "lines": [
            697,
            722
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check optional skills",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkSessionsDir",
          "kind": "function",
          "signature": "checkSessionsDir(config: PiBrainConfig): HealthCheckResult",
          "lines": [
            727,
            777
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check sessions directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkDatabaseAccess",
          "kind": "function",
          "signature": "checkDatabaseAccess(config: PiBrainConfig): HealthCheckResult",
          "lines": [
            782,
            810
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check database access",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkPromptFile",
          "kind": "function",
          "signature": "checkPromptFile(config: PiBrainConfig): HealthCheckResult",
          "lines": [
            815,
            831
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check prompt file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runHealthChecks",
          "kind": "function",
          "signature": "async runHealthChecks(configPath?: string): Promise<HealthStatus>",
          "lines": [
            836,
            866
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Run all health checks",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatDaemonStatus",
          "kind": "function",
          "signature": "formatDaemonStatus(status: DaemonStatus, _options: OutputOptions = {}): string",
          "lines": [
            875,
            896
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format daemon status for display",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatQueueStatus",
          "kind": "function",
          "signature": "formatQueueStatus(queueStatus: QueueStatus, _options: OutputOptions = {}): string",
          "lines": [
            901,
            951
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format queue status for display",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getHealthIcon",
          "kind": "function",
          "signature": "getHealthIcon(result: HealthCheckResult): string",
          "lines": [
            956,
            961
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get icon for health check result",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatHealthStatus",
          "kind": "function",
          "signature": "formatHealthStatus(status: HealthStatus, _options: OutputOptions = {}): string",
          "lines": [
            966,
            989
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format health check results for display",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "truncatePath",
          "kind": "function",
          "signature": "truncatePath(filePath: string, maxLen: number): string",
          "lines": [
            994,
            999
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Truncate a path for display",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "rebuildIndex",
          "kind": "function",
          "signature": "rebuildIndex(configPath?: string): { success: boolean; message: string; count: number; }",
          "lines": [
            1004,
            1124
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Rebuild the SQLite index from JSON files",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "rebuildEmbeddings",
          "kind": "function",
          "signature": "async rebuildEmbeddings(configPath?: string, options: { force?: boolean } = {}): Promise<{ success: boolean; message: string; count: number; }>",
          "lines": [
            1129,
            1211
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Rebuild embeddings for all nodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "truncateString",
          "kind": "function",
          "signature": "truncateString(str: string, maxLen: number): string",
          "lines": [
            1216,
            1221
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Truncate a string for display",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/config.js",
        "../config/types.js",
        "../storage/database.js",
        "../storage/embedding-utils.js",
        "../storage/index.js",
        "../storage/node-storage.js",
        "./facet-discovery.js",
        "./processor.js",
        "./queue.js",
        "node:child_process",
        "node:fs",
        "node:net",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/connection-discovery.ts",
      "language": "typescript",
      "lines": [
        1,
        620
      ],
      "detail_level": "full",
      "token_estimate": 646,
      "symbols": [
        {
          "name": "LessonRow",
          "kind": "interface",
          "signature": "LessonRow",
          "lines": [
            17,
            24
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "STOPWORDS",
          "kind": "variable",
          "signature": "any",
          "lines": [
            27,
            136
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ConnectionResult",
          "kind": "interface",
          "signature": "ConnectionResult",
          "lines": [
            138,
            143
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ConnectionDiscoverer",
          "kind": "class",
          "signature": "ConnectionDiscoverer",
          "lines": [
            159,
            619
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Discovers semantic connections between nodes in the knowledge graph.\n\nUses keyword/tag similarity, explicit references, and lesson reinforcement\npatterns to find related nodes. Does not use LLM - relies on FTS and\nJaccard similarity for performance.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(private db: Database.Database)",
          "lines": [
            164,
            164
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": "Create a new ConnectionDiscoverer instance",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "discover",
          "kind": "method",
          "signature": "discover(nodeId: string, options: {\n      threshold?: number;\n      limit?: number;\n      daysToLookBack?: number;\n    } = {}): ConnectionResult",
          "lines": [
            192,
            284
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": "Discover and create connections for a node\n\nAnalyzes the source node and finds semantically related older nodes.\nCreates edges of three types:\n- `semantic`: Nodes with similar tags/topics/summaries\n- `reference`: Nodes explicitly referenced by ID in text\n- `lesson_application`: Nodes with matching lessons learned",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeMetadata",
          "kind": "method",
          "signature": "getNodeMetadata(nodeId: string): { tags: Set<string>; topics: Set<string>; }",
          "lines": [
            286,
            304
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findCandidates",
          "kind": "method",
          "signature": "findCandidates(excludeNodeId: string, sourceTimestamp: string, days: number, limit: number): {}",
          "lines": [
            306,
            335
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeFullText",
          "kind": "method",
          "signature": "getNodeFullText(nodeId: string): string",
          "lines": [
            337,
            358
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "escapeFtsToken",
          "kind": "method",
          "signature": "escapeFtsToken(token: string): string",
          "lines": [
            364,
            366
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": "Escape a token for use in FTS5 quoted strings.\nDouble quotes are escaped by doubling them (FTS5 convention).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectReferences",
          "kind": "method",
          "signature": "detectReferences(sourceNodeId: string, sourceText: string): {}",
          "lines": [
            368,
            409
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectLessonReinforcement",
          "kind": "method",
          "signature": "detectLessonReinforcement(nodeId: string, sourceTimestamp: string, threshold: number, limit: number): {}",
          "lines": [
            411,
            504
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLessons",
          "kind": "method",
          "signature": "getLessons(nodeId: string): {}",
          "lines": [
            506,
            510
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findBestLessonMatch",
          "kind": "method",
          "signature": "findBestLessonMatch(targetLesson: LessonRow, candidateLessons: LessonRow[]): { lesson: LessonRow; score: number; }",
          "lines": [
            512,
            546
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateSimilarity",
          "kind": "method",
          "signature": "calculateSimilarity(a: { tags: Set<string>; topics: Set<string>; summary: string }, b: { tags: Set<string>; topics: Set<string>; summary: string }): number",
          "lines": [
            575,
            588
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": "Calculate similarity score between two nodes\n\nUses a weighted average of Jaccard indices:\n- Tags: 40% weight\n- Topics: 30% weight\n- Summary words (tokenized, stopwords removed): 30% weight",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "jaccardIndex",
          "kind": "method",
          "signature": "jaccardIndex(setA: Set<string>, setB: Set<string>): number",
          "lines": [
            590,
            604
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "tokenize",
          "kind": "method",
          "signature": "tokenize(text: string): Set<string>",
          "lines": [
            606,
            618
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "ConnectionDiscoverer",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../storage/edge-repository.js",
        "../storage/index.js",
        "../storage/node-crud.js",
        "../storage/node-queries.js",
        "../types/index.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/daemon/daemon-process.ts",
      "language": "typescript",
      "lines": [
        1,
        312
      ],
      "detail_level": "full",
      "token_estimate": 112,
      "symbols": [
        {
          "name": "args",
          "kind": "variable",
          "signature": "any",
          "lines": [
            30,
            30
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "configPath",
          "kind": "variable",
          "signature": "string | undefined",
          "lines": [
            31,
            31
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "force",
          "kind": "variable",
          "signature": "boolean",
          "lines": [
            32,
            32
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleWatcherError",
          "kind": "variable",
          "signature": "(event: Event): void",
          "lines": [
            47,
            50
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sleep",
          "kind": "variable",
          "signature": "(ms: number): any",
          "lines": [
            52,
            55
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "main",
          "kind": "function",
          "signature": "async main(): Promise<void>",
          "lines": [
            61,
            300
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../api/server.js",
        "../config/config.js",
        "../storage/database.js",
        "./cli.js",
        "./queue.js",
        "./scheduler.js",
        "./watcher-events.js",
        "./watcher.js",
        "./worker.js",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/errors.ts",
      "language": "typescript",
      "lines": [
        1,
        457
      ],
      "detail_level": "full",
      "token_estimate": 766,
      "symbols": [
        {
          "name": "RetryPolicy",
          "kind": "interface",
          "signature": "RetryPolicy",
          "lines": [
            15,
            24
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Retry policy configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ErrorCategoryType",
          "kind": "type",
          "signature": "ErrorCategoryType = \"transient\" | \"permanent\" | \"unknown\"",
          "lines": [
            27,
            27
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Error category types",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ErrorCategory",
          "kind": "type",
          "signature": "ErrorCategory = | {\n      type: \"transient\";\n      retryable: true;\n      /** Suggested max retries for this error type */\n      maxRetries: number;\n      /** Reason for classification */\n      reason: string;\n    }\n...",
          "lines": [
            30,
            52
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Error category - determines retry behavior",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClassifiedError",
          "kind": "interface",
          "signature": "ClassifiedError",
          "lines": [
            55,
            66
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Classified error with metadata",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_RETRY_POLICY",
          "kind": "variable",
          "signature": "RetryPolicy",
          "lines": [
            73,
            78
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default retry policy",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ERROR_PATTERNS",
          "kind": "variable",
          "signature": "{\n  patterns: RegExp[];\n  category: () => ErrorCategory;\n}[]",
          "lines": [
            88,
            246
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Error patterns for classification\nOrder matters - first match wins",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "classifyError",
          "kind": "function",
          "signature": "classifyError(error: Error, _context?: JobContext): ErrorCategory",
          "lines": [
            251,
            273
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Classify an error to determine retry behavior",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "classifyErrorWithContext",
          "kind": "function",
          "signature": "classifyErrorWithContext(error: Error, retryCount: number, maxRetries: number, policy: RetryPolicy = DEFAULT_RETRY_POLICY): ClassifiedError",
          "lines": [
            278,
            308
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Classify an error with full context",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateRetryDelay",
          "kind": "function",
          "signature": "calculateRetryDelay(retryCount: number, policy: RetryPolicy = DEFAULT_RETRY_POLICY): number",
          "lines": [
            317,
            324
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate retry delay with exponential backoff",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateRetryDelayMinutes",
          "kind": "function",
          "signature": "calculateRetryDelayMinutes(retryCount: number, policy: RetryPolicy = DEFAULT_RETRY_POLICY): number",
          "lines": [
            329,
            334
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate retry delay in minutes (for queue integration)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatErrorDescription",
          "kind": "function",
          "signature": "formatErrorDescription(error: Error, category: ErrorCategory): string",
          "lines": [
            343,
            351
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format error description for logging/storage",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatErrorForStorage",
          "kind": "function",
          "signature": "formatErrorForStorage(error: Error, category?: ErrorCategory): string",
          "lines": [
            356,
            370
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format error for storage in database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseStoredError",
          "kind": "function",
          "signature": "parseStoredError(stored: string): { timestamp: string; type: ErrorCategoryType; reason: string; message: string; stack?: string; }",
          "lines": [
            375,
            393
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse stored error back to object",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isRetryableError",
          "kind": "function",
          "signature": "isRetryableError(error: Error): boolean",
          "lines": [
            402,
            404
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if an error is retryable",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isPermanentError",
          "kind": "function",
          "signature": "isPermanentError(error: Error): boolean",
          "lines": [
            409,
            411
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if an error is permanent",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createTypedError",
          "kind": "function",
          "signature": "createTypedError(message: string, type: ErrorCategoryType): Error",
          "lines": [
            416,
            426
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a typed error with a specific category",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createFileNotFoundError",
          "kind": "function",
          "signature": "createFileNotFoundError(path: string): Error",
          "lines": [
            433,
            435
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a \"file not found\" error",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createInvalidSessionError",
          "kind": "function",
          "signature": "createInvalidSessionError(reason: string): Error",
          "lines": [
            438,
            440
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a \"session invalid\" error",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createTimeoutError",
          "kind": "function",
          "signature": "createTimeoutError(durationMinutes: number): Error",
          "lines": [
            443,
            445
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a \"timeout\" error",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createRateLimitError",
          "kind": "function",
          "signature": "createRateLimitError(retryAfter?: number): Error",
          "lines": [
            448,
            451
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a \"rate limit\" error",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createValidationError",
          "kind": "function",
          "signature": "createValidationError(details: string): Error",
          "lines": [
            454,
            456
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a \"validation\" error",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./queue.js"
      ]
    },
    {
      "path": "src/daemon/export.ts",
      "language": "typescript",
      "lines": [
        1,
        148
      ],
      "detail_level": "full",
      "token_estimate": 158,
      "symbols": [
        {
          "name": "getSegmentEntries",
          "kind": "function",
          "signature": "getSegmentEntries(entries: SessionEntry[], startId: string, endId: string): {}",
          "lines": [
            17,
            30
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract entries within a segment range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "exportFineTuneData",
          "kind": "function",
          "signature": "async exportFineTuneData(outputPath: string, configPath?: string): Promise<{ success: boolean; message: string; count: number; }>",
          "lines": [
            41,
            147
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Export fine-tuning data to JSONL\n\nFormat:\n{\n  \"input\": <JSON string of segment entries>,\n  \"output\": <JSON string of node analysis>\n}",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/index.js",
        "../parser/session.js",
        "../storage/node-storage.js",
        "../types.js",
        "node:fs",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/facet-discovery.ts",
      "language": "typescript",
      "lines": [
        1,
        1760
      ],
      "detail_level": "full",
      "token_estimate": 1857,
      "symbols": [
        {
          "name": "EMBEDDING_BATCH_SIZE",
          "kind": "variable",
          "signature": "50",
          "lines": [
            46,
            46
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default batch size for embedding requests",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_NODES",
          "kind": "variable",
          "signature": "10000",
          "lines": [
            49,
            49
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Maximum nodes to process in one clustering run",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_CLUSTER_SIZE",
          "kind": "variable",
          "signature": "3",
          "lines": [
            52,
            52
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default minimum cluster size for HDBSCAN",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "REPRESENTATIVE_COUNT",
          "kind": "variable",
          "signature": "5",
          "lines": [
            55,
            55
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Number of representative nodes to select per cluster",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeSummaryRow",
          "kind": "interface",
          "signature": "NodeSummaryRow",
          "lines": [
            61,
            68
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EmbeddingRow",
          "kind": "interface",
          "signature": "EmbeddingRow",
          "lines": [
            70,
            76
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterRow",
          "kind": "interface",
          "signature": "ClusterRow",
          "lines": [
            78,
            90
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterAnalysisConfig",
          "kind": "interface",
          "signature": "ClusterAnalysisConfig",
          "lines": [
            99,
            108
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Configuration for LLM cluster analysis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterAnalysisResult",
          "kind": "interface",
          "signature": "ClusterAnalysisResult",
          "lines": [
            113,
            121
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from analyzing a single cluster",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterAnalysisBatchResult",
          "kind": "interface",
          "signature": "ClusterAnalysisBatchResult",
          "lines": [
            126,
            131
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from analyzing multiple clusters",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EmbeddingProvider",
          "kind": "interface",
          "signature": "EmbeddingProvider",
          "lines": [
            140,
            144
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Interface for embedding providers",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isEmbeddingProvider",
          "kind": "function",
          "signature": "isEmbeddingProvider(value: EmbeddingConfig | EmbeddingProvider): boolean",
          "lines": [
            149,
            157
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Type guard to check if value is an EmbeddingProvider",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createEmbeddingProvider",
          "kind": "function",
          "signature": "createEmbeddingProvider(config: EmbeddingConfig): EmbeddingProvider",
          "lines": [
            162,
            198
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create an embedding provider from config",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createOllamaProvider",
          "kind": "function",
          "signature": "createOllamaProvider(model: string, baseUrl: string): EmbeddingProvider",
          "lines": [
            203,
            242
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create Ollama embedding provider",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createOpenAIProvider",
          "kind": "function",
          "signature": "createOpenAIProvider(model: string, apiKey: string, baseUrl: string, dims?: number): EmbeddingProvider",
          "lines": [
            247,
            283
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create OpenAI embedding provider",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createOpenRouterProvider",
          "kind": "function",
          "signature": "createOpenRouterProvider(model: string, apiKey: string, baseUrl: string, dims = 4096): EmbeddingProvider",
          "lines": [
            289,
            325
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create OpenRouter embedding provider\nUses OpenAI-compatible API at https://openrouter.ai/api/v1",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createMockEmbeddingProvider",
          "kind": "function",
          "signature": "createMockEmbeddingProvider(dims = 384): EmbeddingProvider",
          "lines": [
            331,
            355
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create mock embedding provider for testing only.\nNot exposed in EmbeddingConfig - use createMockEmbeddingProvider() directly in tests.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hashString",
          "kind": "function",
          "signature": "hashString(str: string): number",
          "lines": [
            360,
            367
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Simple string hash for mock embeddings",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "KMeansResult",
          "kind": "interface",
          "signature": "KMeansResult",
          "lines": [
            376,
            379
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "K-means clustering result",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "kMeansClustering",
          "kind": "function",
          "signature": "kMeansClustering(embeddings: number[][], k: number, maxIterations = 100): KMeansResult",
          "lines": [
            384,
            451
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Simple K-means++ clustering implementation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "kMeansPlusPlusInit",
          "kind": "function",
          "signature": "kMeansPlusPlusInit(embeddings: number[][], k: number): {}",
          "lines": [
            456,
            489
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "K-means++ initialization",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hdbscanClustering",
          "kind": "function",
          "signature": "hdbscanClustering(embeddings: number[][], minClusterSize = 3, minSamples = 3): {}",
          "lines": [
            494,
            513
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "HDBSCAN-like density-based clustering (simplified)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "computeDistanceMatrix",
          "kind": "function",
          "signature": "computeDistanceMatrix(embeddings: number[][]): {}",
          "lines": [
            515,
            530
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "computeCoreDistances",
          "kind": "function",
          "signature": "computeCoreDistances(distances: number[][], minSamples: number): {}",
          "lines": [
            532,
            540
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "computeMutualReachability",
          "kind": "function",
          "signature": "computeMutualReachability(distances: number[][], coreDistances: number[]): {}",
          "lines": [
            542,
            560
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractClusters",
          "kind": "function",
          "signature": "extractClusters(reachability: number[][], n: number, minClusterSize: number): {}",
          "lines": [
            562,
            641
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "euclideanDistance",
          "kind": "function",
          "signature": "euclideanDistance(a: number[], b: number[]): number",
          "lines": [
            643,
            650
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FacetDiscoveryLogger",
          "kind": "interface",
          "signature": "FacetDiscoveryLogger",
          "lines": [
            656,
            660
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "noopLogger",
          "kind": "variable",
          "signature": "FacetDiscoveryLogger",
          "lines": [
            663,
            667
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FacetDiscovery",
          "kind": "class",
          "signature": "FacetDiscovery",
          "lines": [
            670,
            1731
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "provider",
          "kind": "property",
          "signature": "provider: EmbeddingProvider",
          "lines": [
            671,
            671
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clusteringConfig",
          "kind": "property",
          "signature": "clusteringConfig: ClusteringConfig",
          "lines": [
            672,
            672
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "logger",
          "kind": "property",
          "signature": "logger: FacetDiscoveryLogger",
          "lines": [
            673,
            673
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(private db: Database.Database, embeddingConfigOrProvider: EmbeddingConfig | EmbeddingProvider, clusteringConfig?: ClusteringConfig, logger?: FacetDiscoveryLogger)",
          "lines": [
            675,
            690
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "run",
          "kind": "method",
          "signature": "async run(options?: {\n    signalType?: ClusterSignalType;\n    model?: string;\n    maxNodes?: number;\n  }): Promise<FacetDiscoveryResult>",
          "lines": [
            692,
            760
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodesForClustering",
          "kind": "method",
          "signature": "getNodesForClustering(maxNodes: number, _signalType?: ClusterSignalType, model?: string): {}",
          "lines": [
            762,
            797
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "embedNodes",
          "kind": "method",
          "signature": "async embedNodes(nodes: NodeSummaryRow[], runId: string): Promise<{}>",
          "lines": [
            799,
            864
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildNodeEmbeddingText",
          "kind": "method",
          "signature": "buildNodeEmbeddingText(node: NodeSummaryRow): string",
          "lines": [
            872,
            884
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Build embedding text for a node, using the rich format when possible.\n\nAttempts to load the full node from JSON storage to include decisions\nand lessons in the embedding. Falls back to simple format if loading fails.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getCachedEmbeddings",
          "kind": "method",
          "signature": "getCachedEmbeddings(nodeIds: string[]): {}",
          "lines": [
            886,
            906
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "cacheEmbedding",
          "kind": "method",
          "signature": "cacheEmbedding(nodeId: string, embedding: number[], inputText: string): void",
          "lines": [
            908,
            921
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clusterEmbeddings",
          "kind": "method",
          "signature": "clusterEmbeddings(embeddings: { nodeId: string; embedding: number[] }[]): {}",
          "lines": [
            923,
            941
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createClusters",
          "kind": "method",
          "signature": "createClusters(_nodes: NodeSummaryRow[], embeddings: { nodeId: string; embedding: number[] }[], labels: number[], runId: string, signalType?: ClusterSignalType, model?: string): {}",
          "lines": [
            943,
            1035
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "computeCentroid",
          "kind": "method",
          "signature": "computeCentroid(embeddings: number[][]): {}",
          "lines": [
            1037,
            1056
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "completeRun",
          "kind": "method",
          "signature": "completeRun(runId: string, clusters: Cluster[], nodesEmbedded: number, nodesClustered: number, clustersCreated: number): FacetDiscoveryResult",
          "lines": [
            1058,
            1084
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "failRun",
          "kind": "method",
          "signature": "failRun(runId: string, error: string): void",
          "lines": [
            1086,
            1098
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getClusteringRun",
          "kind": "method",
          "signature": "getClusteringRun(runId: string): any",
          "lines": [
            1100,
            1123
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getClusters",
          "kind": "method",
          "signature": "getClusters(options?: {\n    status?: string;\n    signalType?: ClusterSignalType;\n    limit?: number;\n  }): {}",
          "lines": [
            1125,
            1169
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getClusterNodes",
          "kind": "method",
          "signature": "getClusterNodes(clusterId: string, options?: { representativeOnly?: boolean }): {}",
          "lines": [
            1171,
            1201
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateClusterStatus",
          "kind": "method",
          "signature": "updateClusterStatus(clusterId: string, status: \"confirmed\" | \"dismissed\"): void",
          "lines": [
            1203,
            1216
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateClusterDetails",
          "kind": "method",
          "signature": "updateClusterDetails(clusterId: string, name: string, description: string): void",
          "lines": [
            1218,
            1230
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "analyzeClusters",
          "kind": "method",
          "signature": "async analyzeClusters(config: ClusterAnalysisConfig, options?: { limit?: number }): Promise<ClusterAnalysisBatchResult>",
          "lines": [
            1246,
            1301
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Analyze pending clusters using an LLM to generate names and descriptions.\n\nThis method:\n1. Gets clusters with status 'pending' that haven't been named\n2. For each cluster, gets the representative nodes\n3. Builds a prompt with node summaries\n4. Invokes a pi agent to analyze and name the cluster\n5. Updates the cluster with the generated name and description",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "analyzeCluster",
          "kind": "method",
          "signature": "async analyzeCluster(cluster: Cluster, config: ClusterAnalysisConfig): Promise<ClusterAnalysisResult>",
          "lines": [
            1306,
            1368
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Analyze a single cluster",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeSummaries",
          "kind": "method",
          "signature": "getNodeSummaries(nodeIds: string[]): {}",
          "lines": [
            1373,
            1394
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Get node summaries for a list of node IDs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildClusterAnalysisPrompt",
          "kind": "method",
          "signature": "buildClusterAnalysisPrompt(nodes: NodeSummaryRow[], cluster: Cluster): string",
          "lines": [
            1399,
            1448
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Build the prompt for cluster analysis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "invokeClusterAnalysisAgent",
          "kind": "method",
          "signature": "async invokeClusterAnalysisAgent(prompt: string, config: ClusterAnalysisConfig): Promise<{ success: boolean; name?: string; description?: string; confidence?: \"high\" | \"medium\" | \"low\"; reasoning?: string; error?: string; }>",
          "lines": [
            1453,
            1552
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Invoke the pi agent to analyze a cluster",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spawnPiProcess",
          "kind": "method",
          "signature": "spawnPiProcess(args: string[], timeoutMinutes: number): Promise<{ stdout: string; stderr: string; exitCode: number; timedOut: boolean; spawnError?: string; }>",
          "lines": [
            1557,
            1645
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Spawn a pi process and wait for completion",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseClusterAnalysisOutput",
          "kind": "method",
          "signature": "parseClusterAnalysisOutput(stdout: string): { success: boolean; name?: string; description?: string; confidence?: \"high\" | \"medium\" | \"low\"; reasoning?: string; error?: string; }",
          "lines": [
            1650,
            1730
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "FacetDiscovery",
          "annotation": null,
          "comment": "Parse the LLM output for cluster analysis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateId",
          "kind": "function",
          "signature": "generateId(): string",
          "lines": [
            1737,
            1739
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "serializeEmbedding",
          "kind": "function",
          "signature": "serializeEmbedding(embedding: number[]): Buffer",
          "lines": [
            1741,
            1747
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "deserializeEmbedding",
          "kind": "function",
          "signature": "deserializeEmbedding(buffer: Buffer): {}",
          "lines": [
            1749,
            1755
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countNoise",
          "kind": "function",
          "signature": "countNoise(labels: number[]): number",
          "lines": [
            1757,
            1759
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../storage/embedding-utils.js",
        "../storage/node-storage.js",
        "../types/index.js",
        "better-sqlite3",
        "node:child_process",
        "node:crypto",
        "node:fs/promises",
        "node:os",
        "node:path",
        "node:url"
      ]
    },
    {
      "path": "src/daemon/graph-export.ts",
      "language": "typescript",
      "lines": [
        1,
        131
      ],
      "detail_level": "full",
      "token_estimate": 177,
      "symbols": [
        {
          "name": "GraphExportOptions",
          "kind": "interface",
          "signature": "GraphExportOptions",
          "lines": [
            15,
            20
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "exportGraphviz",
          "kind": "function",
          "signature": "exportGraphviz(outputPath: string, configPath?: string, options: GraphExportOptions = {}): { success: boolean; message: string; }",
          "lines": [
            25,
            91
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Export knowledge graph to Graphviz DOT format",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "escapeString",
          "kind": "function",
          "signature": "escapeString(str: string): string",
          "lines": [
            93,
            95
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatNodeLabel",
          "kind": "function",
          "signature": "formatNodeLabel(node: NodeRow): string",
          "lines": [
            97,
            104
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeColor",
          "kind": "function",
          "signature": "getNodeColor(type: string): string",
          "lines": [
            106,
            117
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEdgeStyle",
          "kind": "function",
          "signature": "getEdgeStyle(type: string): string",
          "lines": [
            119,
            130
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/index.js",
        "../storage/database.js",
        "../storage/edge-repository.js",
        "../storage/node-crud.js",
        "../storage/node-queries.js",
        "node:fs",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/index.ts",
      "language": "typescript",
      "lines": [
        1,
        182
      ],
      "detail_level": "full",
      "token_estimate": 91,
      "symbols": [
        {
          "name": "DAEMON_MODULE_VERSION",
          "kind": "variable",
          "signature": "\"0.1.0\"",
          "lines": [
            181,
            181
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Daemon module version",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./cli.js",
        "./connection-discovery.js",
        "./errors.js",
        "./facet-discovery.js",
        "./pattern-aggregation.js",
        "./processor.js",
        "./queue.js",
        "./scheduler.js",
        "./watcher-events.js",
        "./watcher.js",
        "./worker.js"
      ]
    },
    {
      "path": "src/daemon/insight-aggregation.ts",
      "language": "typescript",
      "lines": [
        1,
        553
      ],
      "detail_level": "full",
      "token_estimate": 503,
      "symbols": [
        {
          "name": "InsightGroup",
          "kind": "interface",
          "signature": "InsightGroup",
          "lines": [
            26,
            38
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelQuirkRow",
          "kind": "interface",
          "signature": "ModelQuirkRow",
          "lines": [
            40,
            48
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolErrorRow",
          "kind": "interface",
          "signature": "ToolErrorRow",
          "lines": [
            50,
            57
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LessonRow",
          "kind": "interface",
          "signature": "LessonRow",
          "lines": [
            59,
            66
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeRow",
          "kind": "interface",
          "signature": "NodeRow",
          "lines": [
            68,
            71
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MAX_PATTERNS",
          "kind": "variable",
          "signature": "10000",
          "lines": [
            77,
            77
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MAX_EXAMPLES",
          "kind": "variable",
          "signature": "10",
          "lines": [
            78,
            78
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NODE_BATCH_SIZE",
          "kind": "variable",
          "signature": "1000",
          "lines": [
            79,
            79
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "normalizePattern",
          "kind": "function",
          "signature": "normalizePattern(text: string): string",
          "lines": [
            88,
            90
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Normalize pattern text for grouping similar patterns",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "frequencyToConfidence",
          "kind": "function",
          "signature": "frequencyToConfidence(freq: string | null): number",
          "lines": [
            95,
            113
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Convert frequency string to confidence score",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateInsightId",
          "kind": "function",
          "signature": "generateInsightId(type: InsightType, pattern: string, model?: string, tool?: string): string",
          "lines": [
            118,
            129
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate deterministic ID for an insight",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "maxDate",
          "kind": "function",
          "signature": "maxDate(a: string, b: string): string",
          "lines": [
            134,
            136
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get max of two date strings",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "minDate",
          "kind": "function",
          "signature": "minDate(a: string, b: string): string",
          "lines": [
            141,
            143
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get min of two date strings",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InsightAggregator",
          "kind": "class",
          "signature": "InsightAggregator",
          "lines": [
            149,
            552
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(private db: Database.Database)",
          "lines": [
            150,
            150
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateAll",
          "kind": "method",
          "signature": "aggregateAll(): void",
          "lines": [
            156,
            169
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": "Run full insight aggregation.\nCollects from all sources and updates aggregated_insights table.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateModelQuirks",
          "kind": "method",
          "signature": "aggregateModelQuirks(insights: Map<string, InsightGroup>): void",
          "lines": [
            174,
            236
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": "Aggregate model quirks from model_quirks table",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateToolErrors",
          "kind": "method",
          "signature": "aggregateToolErrors(insights: Map<string, InsightGroup>): void",
          "lines": [
            241,
            303
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": "Aggregate tool errors from tool_errors table",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateLessons",
          "kind": "method",
          "signature": "aggregateLessons(insights: Map<string, InsightGroup>): void",
          "lines": [
            308,
            367
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": "Aggregate lessons from lessons table (model, tool, user levels)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregatePromptingPatterns",
          "kind": "method",
          "signature": "aggregatePromptingPatterns(insights: Map<string, InsightGroup>): void",
          "lines": [
            373,
            507
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": "Aggregate prompting wins and failures from node JSON files.\nProcesses nodes in batches to limit memory pressure.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "storeInsights",
          "kind": "method",
          "signature": "storeInsights(insights: Map<string, InsightGroup>): void",
          "lines": [
            512,
            551
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "InsightAggregator",
          "annotation": null,
          "comment": "Store aggregated insights in the database",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../storage/node-storage.js",
        "../types/index.js",
        "better-sqlite3",
        "node:crypto"
      ]
    },
    {
      "path": "src/daemon/pattern-aggregation.ts",
      "language": "typescript",
      "lines": [
        1,
        332
      ],
      "detail_level": "full",
      "token_estimate": 201,
      "symbols": [
        {
          "name": "FailurePatternGroup",
          "kind": "interface",
          "signature": "FailurePatternGroup",
          "lines": [
            5,
            12
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolErrorRow",
          "kind": "interface",
          "signature": "ToolErrorRow",
          "lines": [
            14,
            20
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PatternAggregator",
          "kind": "class",
          "signature": "PatternAggregator",
          "lines": [
            22,
            331
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MAX_PATTERNS",
          "kind": "property",
          "signature": "MAX_PATTERNS",
          "lines": [
            24,
            24
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": true,
          "is_abstract": false,
          "parent_name": "PatternAggregator",
          "annotation": null,
          "comment": "Maximum unique patterns to track before logging warning",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(private db: Database.Database)",
          "lines": [
            26,
            26
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "PatternAggregator",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateFailurePatterns",
          "kind": "method",
          "signature": "aggregateFailurePatterns(): number",
          "lines": [
            33,
            127
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "PatternAggregator",
          "annotation": null,
          "comment": "Aggregates tool errors into failure patterns.\nThis is intended to be run nightly or periodically.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateLessons",
          "kind": "method",
          "signature": "aggregateLessons(): number",
          "lines": [
            134,
            245
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "PatternAggregator",
          "annotation": null,
          "comment": "Aggregates lessons into lesson patterns.\nGroups by level and exact summary text.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "aggregateModelStats",
          "kind": "method",
          "signature": "aggregateModelStats(): number",
          "lines": [
            251,
            330
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "PatternAggregator",
          "annotation": null,
          "comment": "Aggregates model statistics from quirks and tool errors.",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3",
        "node:crypto"
      ]
    },
    {
      "path": "src/daemon/processor.ts",
      "language": "typescript",
      "lines": [
        1,
        809
      ],
      "detail_level": "full",
      "token_estimate": 1060,
      "symbols": [
        {
          "name": "AgentResult",
          "kind": "interface",
          "signature": "AgentResult",
          "lines": [
            21,
            34
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from invoking the pi agent",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AgentNodeOutput",
          "kind": "interface",
          "signature": "AgentNodeOutput",
          "lines": [
            37,
            116
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Output schema from the session analyzer (matches session-analyzer.md)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LessonOutput",
          "kind": "interface",
          "signature": "LessonOutput",
          "lines": [
            118,
            125
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SkillInfo",
          "kind": "interface",
          "signature": "SkillInfo",
          "lines": [
            128,
            132
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Skill availability information",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ProcessorLogger",
          "kind": "interface",
          "signature": "ProcessorLogger",
          "lines": [
            135,
            140
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Logger interface for processor",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "consoleLogger",
          "kind": "variable",
          "signature": "ProcessorLogger",
          "lines": [
            143,
            148
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default console logger",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "REQUIRED_SKILLS",
          "kind": "variable",
          "signature": "readonly []",
          "lines": [
            155,
            155
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Required skills for analysis - must be available",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "OPTIONAL_SKILLS",
          "kind": "variable",
          "signature": "readonly [\"codemap\"]",
          "lines": [
            158,
            158
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Optional skills - enhance analysis but not required",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CONDITIONAL_SKILLS",
          "kind": "variable",
          "signature": "readonly [\"rlm\"]",
          "lines": [
            161,
            161
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Skills that are conditionally included based on file size",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RLM_SIZE_THRESHOLD",
          "kind": "variable",
          "signature": "number",
          "lines": [
            164,
            164
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "File size threshold (in bytes) for including RLM skill",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SKILLS_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            167,
            167
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Skills directory location",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkSkillAvailable",
          "kind": "function",
          "signature": "async checkSkillAvailable(skillName: string): Promise<boolean>",
          "lines": [
            176,
            184
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a skill is available by looking for SKILL.md",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSkillAvailability",
          "kind": "function",
          "signature": "async getSkillAvailability(): Promise<Map<string, SkillInfo>>",
          "lines": [
            189,
            209
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get availability information for all skills",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EnvironmentValidationResult",
          "kind": "interface",
          "signature": "EnvironmentValidationResult",
          "lines": [
            212,
            219
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of environment validation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateRequiredSkills",
          "kind": "function",
          "signature": "async validateRequiredSkills(): Promise<EnvironmentValidationResult>",
          "lines": [
            225,
            237
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate that all required skills are available\nReturns validation result instead of throwing",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildSkillsArg",
          "kind": "function",
          "signature": "async buildSkillsArg(sessionFile?: string): Promise<string>",
          "lines": [
            246,
            283
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build the skills argument for pi invocation\nReturns comma-separated list of available skills\n\nRLM skill is only included for files larger than RLM_SIZE_THRESHOLD\nto avoid confusing smaller models with RLM instructions.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildAnalysisPrompt",
          "kind": "function",
          "signature": "buildAnalysisPrompt(job: AnalysisJob): string",
          "lines": [
            292,
            324
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build the analysis prompt for a job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatJobContext",
          "kind": "function",
          "signature": "formatJobContext(context: Record<string, unknown>): string",
          "lines": [
            329,
            348
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format job context for the prompt",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "invokeAgent",
          "kind": "function",
          "signature": "async invokeAgent(job: AnalysisJob, config: DaemonConfig, logger: ProcessorLogger = consoleLogger): Promise<AgentResult>",
          "lines": [
            357,
            465
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Invoke the pi agent to analyze a session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpawnResult",
          "kind": "interface",
          "signature": "SpawnResult",
          "lines": [
            468,
            474
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from spawning the pi process",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spawnPiProcess",
          "kind": "function",
          "signature": "spawnPiProcess(args: string[], timeoutMinutes: number, logger: ProcessorLogger): Promise<SpawnResult>",
          "lines": [
            479,
            543
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spawn the pi process and wait for completion",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiJsonEvent",
          "kind": "interface",
          "signature": "PiJsonEvent",
          "lines": [
            550,
            555
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Pi JSON mode event types",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiMessage",
          "kind": "interface",
          "signature": "PiMessage",
          "lines": [
            557,
            560
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiContentBlock",
          "kind": "interface",
          "signature": "PiContentBlock",
          "lines": [
            562,
            566
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseAgentOutput",
          "kind": "function",
          "signature": "parseAgentOutput(stdout: string, logger: ProcessorLogger = consoleLogger): Omit<AgentResult, \"exitCode\" | \"durationMs\">",
          "lines": [
            571,
            640
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse the pi agent's JSON mode output",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractNodeFromText",
          "kind": "function",
          "signature": "extractNodeFromText(text: string, logger: ProcessorLogger = consoleLogger): AgentNodeOutput",
          "lines": [
            646,
            679
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract node JSON from text content\nHandles both raw JSON and code-fenced JSON",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isValidNodeOutput",
          "kind": "function",
          "signature": "isValidNodeOutput(obj: unknown): boolean",
          "lines": [
            684,
            730
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Basic validation that output matches expected schema",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ProcessorConfig",
          "kind": "interface",
          "signature": "ProcessorConfig",
          "lines": [
            737,
            742
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Processor configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "JobProcessor",
          "kind": "class",
          "signature": "JobProcessor",
          "lines": [
            747,
            801
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Job processor that invokes pi agents for analysis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "config",
          "kind": "property",
          "signature": "config: DaemonConfig",
          "lines": [
            748,
            748
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "JobProcessor",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "logger",
          "kind": "property",
          "signature": "logger: ProcessorLogger",
          "lines": [
            749,
            749
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "JobProcessor",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(processorConfig: ProcessorConfig)",
          "lines": [
            751,
            754
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "JobProcessor",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "process",
          "kind": "method",
          "signature": "async process(job: AnalysisJob): Promise<AgentResult>",
          "lines": [
            759,
            775
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "JobProcessor",
          "annotation": null,
          "comment": "Process a single analysis job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "validateEnvironment",
          "kind": "method",
          "signature": "async validateEnvironment(): Promise<EnvironmentValidationResult>",
          "lines": [
            781,
            800
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "JobProcessor",
          "annotation": null,
          "comment": "Validate environment before processing\nReturns validation result - does not throw",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createProcessor",
          "kind": "function",
          "signature": "createProcessor(config: ProcessorConfig): JobProcessor",
          "lines": [
            806,
            808
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a job processor",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/types.js",
        "./queue.js",
        "node:child_process",
        "node:fs/promises",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/query-processor.ts",
      "language": "typescript",
      "lines": [
        1,
        786
      ],
      "detail_level": "full",
      "token_estimate": 727,
      "symbols": [
        {
          "name": "QueryRequest",
          "kind": "interface",
          "signature": "QueryRequest",
          "lines": [
            32,
            45
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Query request from the API",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueryResponse",
          "kind": "interface",
          "signature": "QueryResponse",
          "lines": [
            48,
            66
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Query response to return to the client",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AgentQueryResult",
          "kind": "interface",
          "signature": "AgentQueryResult",
          "lines": [
            69,
            74
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from the pi agent",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AgentQueryOutput",
          "kind": "interface",
          "signature": "AgentQueryOutput",
          "lines": [
            77,
            85
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Internal structure for agent output",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueryProcessorConfig",
          "kind": "interface",
          "signature": "QueryProcessorConfig",
          "lines": [
            91,
            104
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "processQuery",
          "kind": "function",
          "signature": "async processQuery(request: QueryRequest, config: QueryProcessorConfig): Promise<QueryResponse>",
          "lines": [
            109,
            188
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Process a natural language query against the knowledge graph",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RelevantNode",
          "kind": "interface",
          "signature": "RelevantNode",
          "lines": [
            194,
            202
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findRelevantNodes",
          "kind": "function",
          "signature": "async findRelevantNodes(db: Database, query: string, project: string | undefined, maxNodes: number, embeddingProvider: EmbeddingProvider | undefined, semanticSearchThreshold: number | undefined, logger: ProcessorLogger): Promise<{}>",
          "lines": [
            213,
            291
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find nodes relevant to the query.\n\nUses a two-phase search strategy:\n1. Semantic search (if embedding provider configured) - finds nodes by meaning\n2. FTS fallback - finds nodes by keyword match\n\nFalls back to listing recent nodes if both searches return no results.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodeRowToRelevant",
          "kind": "function",
          "signature": "nodeRowToRelevant(row: NodeRow): RelevantNode",
          "lines": [
            296,
            306
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Convert a NodeRow to RelevantNode summary",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AdditionalContext",
          "kind": "interface",
          "signature": "AdditionalContext",
          "lines": [
            312,
            315
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "gatherAdditionalContext",
          "kind": "function",
          "signature": "gatherAdditionalContext(db: Database, query: string, logger: ProcessorLogger): AdditionalContext",
          "lines": [
            320,
            370
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Gather additional context based on query keywords",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "invokeQueryAgent",
          "kind": "function",
          "signature": "async invokeQueryAgent(query: string, nodes: RelevantNode[], additionalContext: AdditionalContext, config: QueryProcessorConfig, logger: ProcessorLogger): Promise<AgentQueryResult>",
          "lines": [
            379,
            480
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Invoke the pi agent to synthesize an answer",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildQueryPrompt",
          "kind": "function",
          "signature": "buildQueryPrompt(query: string, nodes: RelevantNode[], additionalContext: AdditionalContext): string",
          "lines": [
            485,
            547
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build the prompt for the query agent",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpawnResult",
          "kind": "interface",
          "signature": "SpawnResult",
          "lines": [
            553,
            559
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spawnPiProcess",
          "kind": "function",
          "signature": "spawnPiProcess(args: string[], timeoutMinutes: number, logger: ProcessorLogger): Promise<SpawnResult>",
          "lines": [
            561,
            623
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiJsonEvent",
          "kind": "interface",
          "signature": "PiJsonEvent",
          "lines": [
            629,
            633
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiMessage",
          "kind": "interface",
          "signature": "PiMessage",
          "lines": [
            635,
            638
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PiContentBlock",
          "kind": "interface",
          "signature": "PiContentBlock",
          "lines": [
            640,
            643
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ParseResult",
          "kind": "interface",
          "signature": "ParseResult",
          "lines": [
            645,
            649
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseQueryOutput",
          "kind": "function",
          "signature": "parseQueryOutput(stdout: string, logger: ProcessorLogger): ParseResult",
          "lines": [
            651,
            727
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractQueryOutput",
          "kind": "function",
          "signature": "extractQueryOutput(text: string, logger: ProcessorLogger): AgentQueryOutput",
          "lines": [
            729,
            762
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isValidQueryOutput",
          "kind": "function",
          "signature": "isValidQueryOutput(obj: unknown): boolean",
          "lines": [
            764,
            785
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/types.js",
        "../storage/database.js",
        "../storage/node-crud.js",
        "../storage/node-queries.js",
        "../storage/quirk-repository.js",
        "../storage/search-repository.js",
        "../storage/semantic-search.js",
        "../storage/tool-error-repository.js",
        "./facet-discovery.js",
        "./processor.js",
        "better-sqlite3",
        "node:child_process",
        "node:fs/promises",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/queue.ts",
      "language": "typescript",
      "lines": [
        1,
        787
      ],
      "detail_level": "full",
      "token_estimate": 1273,
      "symbols": [
        {
          "name": "JobType",
          "kind": "type",
          "signature": "JobType = \"initial\" | \"reanalysis\" | \"connection_discovery\"",
          "lines": [
            17,
            17
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Job type determines analysis behavior",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "JobStatus",
          "kind": "type",
          "signature": "JobStatus = \"pending\" | \"running\" | \"completed\" | \"failed\"",
          "lines": [
            20,
            20
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Job status tracks progress through the queue",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PRIORITY",
          "kind": "variable",
          "signature": "PRIORITY",
          "lines": [
            23,
            34
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Priority levels (lower = higher priority)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "JobContext",
          "kind": "interface",
          "signature": "JobContext",
          "lines": [
            37,
            50
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Additional context for analysis jobs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AnalysisJob",
          "kind": "interface",
          "signature": "AnalysisJob",
          "lines": [
            53,
            88
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Analysis job structure",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "JobInput",
          "kind": "type",
          "signature": "JobInput = Omit<\n  AnalysisJob,\n  \"id\" | \"status\" | \"queuedAt\" | \"retryCount\" | \"maxRetries\" | \"priority\"\n> & {\n  /** Priority (defaults to PRIORITY.INITIAL) */\n  priority?: number;\n  /** Override default max re...",
          "lines": [
            91,
            99
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Job creation input (id, status, queuedAt are auto-generated)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueueStats",
          "kind": "interface",
          "signature": "QueueStats",
          "lines": [
            102,
            115
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Queue statistics",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueueRow",
          "kind": "interface",
          "signature": "QueueRow",
          "lines": [
            118,
            136
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Raw database row from analysis_queue",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_RETRIES",
          "kind": "variable",
          "signature": "3",
          "lines": [
            139,
            139
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_LOCK_DURATION_MINUTES",
          "kind": "variable",
          "signature": "30",
          "lines": [
            140,
            140
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QueueManager",
          "kind": "class",
          "signature": "QueueManager",
          "lines": [
            151,
            742
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Manages the analysis job queue\n\nThread-safe queue operations backed by SQLite with optimistic locking.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(private readonly db: Database.Database, private readonly lockDurationMinutes: number = DEFAULT_LOCK_DURATION_MINUTES)",
          "lines": [
            152,
            155
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "enqueue",
          "kind": "method",
          "signature": "enqueue(job: JobInput): string",
          "lines": [
            160,
            189
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Add a job to the queue",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "enqueueMany",
          "kind": "method",
          "signature": "enqueueMany(jobs: JobInput[]): {}",
          "lines": [
            194,
            227
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Add multiple jobs to the queue in a single transaction",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "dequeue",
          "kind": "method",
          "signature": "dequeue(workerId: string): AnalysisJob",
          "lines": [
            235,
            280
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get the next available job and lock it for processing\n\nUses optimistic locking to prevent multiple workers from\nprocessing the same job.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "complete",
          "kind": "method",
          "signature": "complete(jobId: string, nodeId: string): void",
          "lines": [
            285,
            299
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Mark a job as completed successfully",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "fail",
          "kind": "method",
          "signature": "fail(jobId: string, error: string): void",
          "lines": [
            307,
            346
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Mark a job as failed\n\nIf retry count is below max, the job will be re-queued with\nexponential backoff.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "failPermanently",
          "kind": "method",
          "signature": "failPermanently(jobId: string, error: string): void",
          "lines": [
            354,
            368
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Mark a job as permanently failed (no retries)\n\nUse this for errors that will never succeed on retry,\nsuch as file not found or validation errors.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getJob",
          "kind": "method",
          "signature": "getJob(jobId: string): AnalysisJob",
          "lines": [
            373,
            379
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get a job by ID",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getPendingJobs",
          "kind": "method",
          "signature": "getPendingJobs(sessionFile?: string, limit?: number): {}",
          "lines": [
            384,
            402
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get all pending jobs (optionally filtered by session file)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getRunningJobs",
          "kind": "method",
          "signature": "getRunningJobs(): {}",
          "lines": [
            407,
            415
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get all running jobs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getFailedJobs",
          "kind": "method",
          "signature": "getFailedJobs(limit = 100): {}",
          "lines": [
            420,
            433
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get failed jobs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getJobsForSession",
          "kind": "method",
          "signature": "getJobsForSession(sessionFile: string): {}",
          "lines": [
            438,
            450
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get jobs for a specific session file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasExistingJob",
          "kind": "method",
          "signature": "hasExistingJob(sessionFile: string, segmentStart?: string, segmentEnd?: string): boolean",
          "lines": [
            457,
            485
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Check if a job already exists for a session segment\n\nPrevents duplicate jobs for the same work.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "retryJob",
          "kind": "method",
          "signature": "retryJob(jobId: string): boolean",
          "lines": [
            490,
            511
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Retry a failed job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "cancelJob",
          "kind": "method",
          "signature": "cancelJob(jobId: string): boolean",
          "lines": [
            516,
            527
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Cancel a pending job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "cancelJobsForSession",
          "kind": "method",
          "signature": "cancelJobsForSession(sessionFile: string): number",
          "lines": [
            532,
            543
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Cancel all pending jobs for a session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "releaseStale",
          "kind": "method",
          "signature": "releaseStale(): number",
          "lines": [
            552,
            571
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Release stale locks (jobs that were running but never completed)\n\nCall this periodically to recover from worker crashes.\nNote: We clear the error field on retry to give jobs a clean slate.\nThe stale lock condition itself is logged by the daemon when this returns > 0.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "releaseAllRunning",
          "kind": "method",
          "signature": "releaseAllRunning(): number",
          "lines": [
            580,
            598
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Release ALL running jobs back to pending\n\nUse this on daemon startup to recover from a crash.\nNote: We clear the error field on retry to give jobs a clean slate.\nThe daemon logs the count of released jobs for observability.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDailyStats",
          "kind": "method",
          "signature": "getDailyStats(): { completedToday: number; failedToday: number; }",
          "lines": [
            603,
            619
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get queue statistics for today",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getStats",
          "kind": "method",
          "signature": "getStats(): QueueStats",
          "lines": [
            624,
            659
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get queue statistics",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getJobCounts",
          "kind": "method",
          "signature": "getJobCounts(): Record<JobStatus, number>",
          "lines": [
            664,
            689
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Get the count of jobs by status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clearOldCompleted",
          "kind": "method",
          "signature": "clearOldCompleted(daysOld: number): number",
          "lines": [
            694,
            706
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Clear completed jobs older than the specified number of days",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clearAll",
          "kind": "method",
          "signature": "clearAll(): number",
          "lines": [
            711,
            714
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Clear all jobs (for testing)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseRow",
          "kind": "method",
          "signature": "parseRow(row: QueueRow): AnalysisJob",
          "lines": [
            719,
            741
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "QueueManager",
          "annotation": null,
          "comment": "Parse a database row into an AnalysisJob",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateJobId",
          "kind": "function",
          "signature": "generateJobId(): string",
          "lines": [
            753,
            755
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate a unique job ID\n\nUses the same format as node IDs: 16-char hex string",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createQueueManager",
          "kind": "function",
          "signature": "createQueueManager(db: Database.Database): QueueManager",
          "lines": [
            760,
            762
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a queue manager from a database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getQueueStatusSummary",
          "kind": "function",
          "signature": "getQueueStatusSummary(db: Database.Database): { stats: QueueStats; pendingJobs: {}; runningJobs: {}; recentFailed: {}; }",
          "lines": [
            768,
            786
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get aggregated queue status\nUsed by CLI and API",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3"
      ]
    },
    {
      "path": "src/daemon/scheduler.ts",
      "language": "typescript",
      "lines": [
        1,
        978
      ],
      "detail_level": "full",
      "token_estimate": 1210,
      "symbols": [
        {
          "name": "EFFECTIVENESS_BEFORE_PERIOD_DAYS",
          "kind": "variable",
          "signature": "14",
          "lines": [
            42,
            42
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Days to look back for \"before\" period when measuring effectiveness",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_SPLIT_DAYS",
          "kind": "variable",
          "signature": "7",
          "lines": [
            45,
            45
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default days to look back when no prompt version timestamp is available",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MS_PER_DAY",
          "kind": "variable",
          "signature": "number",
          "lines": [
            48,
            48
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Milliseconds per day",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ScheduledJobType",
          "kind": "type",
          "signature": "ScheduledJobType = | \"reanalysis\"\n  | \"connection_discovery\"\n  | \"pattern_aggregation\"\n  | \"clustering\"\n  | \"backfill_embeddings\"",
          "lines": [
            51,
            56
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Job types that can be scheduled",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ScheduledJobResult",
          "kind": "interface",
          "signature": "ScheduledJobResult",
          "lines": [
            59,
            66
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of a scheduled job execution",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SchedulerLogger",
          "kind": "interface",
          "signature": "SchedulerLogger",
          "lines": [
            69,
            74
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Logger interface for scheduler",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "noopLogger",
          "kind": "variable",
          "signature": "SchedulerLogger",
          "lines": [
            78,
            83
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default no-op logger",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "consoleLogger",
          "kind": "variable",
          "signature": "SchedulerLogger",
          "lines": [
            87,
            92
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Console logger for production use",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SchedulerConfig",
          "kind": "interface",
          "signature": "SchedulerConfig",
          "lines": [
            95,
            146
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Scheduler configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SchedulerStatus",
          "kind": "interface",
          "signature": "SchedulerStatus",
          "lines": [
            149,
            158
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Scheduler state",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Scheduler",
          "kind": "class",
          "signature": "Scheduler",
          "lines": [
            163,
            904
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Scheduler manages cron-based scheduled jobs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "reanalysisJob",
          "kind": "property",
          "signature": "reanalysisJob: Cron | null",
          "lines": [
            164,
            164
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "connectionDiscoveryJob",
          "kind": "property",
          "signature": "connectionDiscoveryJob: Cron | null",
          "lines": [
            165,
            165
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "patternAggregationJob",
          "kind": "property",
          "signature": "patternAggregationJob: Cron | null",
          "lines": [
            166,
            166
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clusteringJob",
          "kind": "property",
          "signature": "clusteringJob: Cron | null",
          "lines": [
            167,
            167
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "backfillEmbeddingsJob",
          "kind": "property",
          "signature": "backfillEmbeddingsJob: Cron | null",
          "lines": [
            168,
            168
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "running",
          "kind": "property",
          "signature": "running",
          "lines": [
            169,
            169
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "lastReanalysisResult",
          "kind": "property",
          "signature": "lastReanalysisResult: ScheduledJobResult | null",
          "lines": [
            170,
            170
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "lastConnectionDiscoveryResult",
          "kind": "property",
          "signature": "lastConnectionDiscoveryResult: ScheduledJobResult | null",
          "lines": [
            171,
            171
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "lastPatternAggregationResult",
          "kind": "property",
          "signature": "lastPatternAggregationResult: ScheduledJobResult | null",
          "lines": [
            172,
            172
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "lastClusteringResult",
          "kind": "property",
          "signature": "lastClusteringResult: ScheduledJobResult | null",
          "lines": [
            173,
            173
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "lastBackfillEmbeddingsResult",
          "kind": "property",
          "signature": "lastBackfillEmbeddingsResult: ScheduledJobResult | null",
          "lines": [
            174,
            174
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "patternAggregator",
          "kind": "property",
          "signature": "patternAggregator: PatternAggregator",
          "lines": [
            175,
            175
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insightAggregator",
          "kind": "property",
          "signature": "insightAggregator: InsightAggregator",
          "lines": [
            176,
            176
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(private config: SchedulerConfig, private queue: QueueManager, private db: Database.Database, private logger: SchedulerLogger = noopLogger)",
          "lines": [
            178,
            186
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "start",
          "kind": "method",
          "signature": "start(): void",
          "lines": [
            191,
            320
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Start the scheduler - creates cron jobs for each configured schedule",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "stop",
          "kind": "method",
          "signature": "stop(): void",
          "lines": [
            325,
            358
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Stop the scheduler - cancels all cron jobs",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isRunning",
          "kind": "method",
          "signature": "isRunning(): boolean",
          "lines": [
            363,
            365
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Check if scheduler is running",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getStatus",
          "kind": "method",
          "signature": "getStatus(): SchedulerStatus",
          "lines": [
            372,
            429
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Get scheduler status including next run times",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "triggerReanalysis",
          "kind": "method",
          "signature": "triggerReanalysis(): Promise<ScheduledJobResult>",
          "lines": [
            434,
            436
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Manually trigger reanalysis job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "triggerConnectionDiscovery",
          "kind": "method",
          "signature": "triggerConnectionDiscovery(): Promise<ScheduledJobResult>",
          "lines": [
            441,
            443
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Manually trigger connection discovery job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "triggerPatternAggregation",
          "kind": "method",
          "signature": "triggerPatternAggregation(): ScheduledJobResult",
          "lines": [
            448,
            450
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Manually trigger pattern aggregation job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "triggerClustering",
          "kind": "method",
          "signature": "triggerClustering(): Promise<ScheduledJobResult>",
          "lines": [
            455,
            457
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Manually trigger clustering job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "triggerBackfillEmbeddings",
          "kind": "method",
          "signature": "triggerBackfillEmbeddings(): Promise<ScheduledJobResult>",
          "lines": [
            462,
            464
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Manually trigger backfill embeddings job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runReanalysis",
          "kind": "method",
          "signature": "async runReanalysis(): Promise<ScheduledJobResult>",
          "lines": [
            469,
            558
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Run reanalysis - queues nodes that were analyzed with older prompt versions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runConnectionDiscovery",
          "kind": "method",
          "signature": "async runConnectionDiscovery(): Promise<ScheduledJobResult>",
          "lines": [
            563,
            639
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Run connection discovery - queues recently analyzed nodes for connection finding",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runPatternAggregation",
          "kind": "method",
          "signature": "runPatternAggregation(): ScheduledJobResult",
          "lines": [
            645,
            734
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Run pattern aggregation - aggregates tool errors into failure patterns\nand model-specific insights for prompt learning",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createSchedulerEmbeddingProvider",
          "kind": "method",
          "signature": "createSchedulerEmbeddingProvider(): any",
          "lines": [
            739,
            759
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Create embedding provider from configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runBackfillEmbeddings",
          "kind": "method",
          "signature": "async runBackfillEmbeddings(): Promise<ScheduledJobResult>",
          "lines": [
            765,
            823
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Run backfill embeddings - finds nodes missing embeddings or with old format\nand generates rich embeddings for them",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runClustering",
          "kind": "method",
          "signature": "async runClustering(): Promise<ScheduledJobResult>",
          "lines": [
            829,
            903
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Scheduler",
          "annotation": null,
          "comment": "Run clustering - discovers patterns across nodes using embedding + clustering\nand analyzes clusters with LLM to generate names/descriptions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createScheduler",
          "kind": "function",
          "signature": "createScheduler(config: DaemonConfig, queue: QueueManager, db: Database.Database, logger?: SchedulerLogger): Scheduler",
          "lines": [
            909,
            939
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a scheduler from daemon config",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isValidCronExpression",
          "kind": "function",
          "signature": "isValidCronExpression(expression: string): boolean",
          "lines": [
            945,
            955
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate a cron expression\nReturns true if valid, false otherwise",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNextRunTimes",
          "kind": "function",
          "signature": "getNextRunTimes(expression: string, count = 5): {}",
          "lines": [
            960,
            977
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the next N run times for a cron expression",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/types.js",
        "../prompt/effectiveness.js",
        "../prompt/prompt.js",
        "../storage/embedding-utils.js",
        "../storage/node-storage.js",
        "./facet-discovery.js",
        "./insight-aggregation.js",
        "./pattern-aggregation.js",
        "./queue.js",
        "better-sqlite3",
        "croner"
      ]
    },
    {
      "path": "src/daemon/watcher-events.ts",
      "language": "typescript",
      "lines": [
        1,
        117
      ],
      "detail_level": "full",
      "token_estimate": 333,
      "symbols": [
        {
          "name": "SessionEventDetail",
          "kind": "interface",
          "signature": "SessionEventDetail",
          "lines": [
            8,
            11
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Event types for the SessionWatcher\nEvent detail for session events",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ErrorEventDetail",
          "kind": "interface",
          "signature": "ErrorEventDetail",
          "lines": [
            16,
            19
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Event detail for error events",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SESSION_EVENTS",
          "kind": "variable",
          "signature": "SESSION_EVENTS",
          "lines": [
            24,
            37
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Session event names",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionEventName",
          "kind": "type",
          "signature": "SessionEventName = (typeof SESSION_EVENTS)[keyof typeof SESSION_EVENTS]",
          "lines": [
            42,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Type for session event names",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createSessionEvent",
          "kind": "function",
          "signature": "createSessionEvent(type: string, sessionPath: string): CustomEvent<SessionEventDetail>",
          "lines": [
            48,
            55
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a session event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createErrorEvent",
          "kind": "function",
          "signature": "createErrorEvent(error: Error): CustomEvent<ErrorEventDetail>",
          "lines": [
            60,
            64
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create an error event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createReadyEvent",
          "kind": "function",
          "signature": "createReadyEvent(): Event",
          "lines": [
            69,
            71
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a ready event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isSessionEvent",
          "kind": "function",
          "signature": "isSessionEvent(event: Event): boolean",
          "lines": [
            76,
            84
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Type guard to check if an event is a session event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isErrorEvent",
          "kind": "function",
          "signature": "isErrorEvent(event: Event): boolean",
          "lines": [
            89,
            96
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Type guard to check if an event is an error event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSessionPath",
          "kind": "function",
          "signature": "getSessionPath(event: Event): string",
          "lines": [
            101,
            106
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Helper to get session path from a session event",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEventError",
          "kind": "function",
          "signature": "getEventError(event: Event): any",
          "lines": [
            111,
            116
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Helper to get error from an error event",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/daemon/watcher.ts",
      "language": "typescript",
      "lines": [
        1,
        582
      ],
      "detail_level": "full",
      "token_estimate": 1254,
      "symbols": [
        {
          "name": "SessionState",
          "kind": "interface",
          "signature": "SessionState",
          "lines": [
            27,
            42
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "State tracking for a single session file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WatcherConfig",
          "kind": "interface",
          "signature": "WatcherConfig",
          "lines": [
            47,
            62
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Watcher configuration options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_WATCHER_CONFIG",
          "kind": "variable",
          "signature": "WatcherConfig",
          "lines": [
            67,
            73
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default watcher configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionWatcher",
          "kind": "class",
          "signature": "SessionWatcher extends EventTarget",
          "lines": [
            83,
            541
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Session file watcher\n\nMonitors directories for .jsonl session files, tracks their state,\nand emits events when sessions are ready for analysis.\n\nUses EventTarget for cross-platform compatibility.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "watcher",
          "kind": "property",
          "signature": "watcher: FSWatcher | null",
          "lines": [
            84,
            84
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sessionStates",
          "kind": "property",
          "signature": "sessionStates",
          "lines": [
            85,
            85
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "watchConfig",
          "kind": "property",
          "signature": "watchConfig: WatcherConfig",
          "lines": [
            86,
            86
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "watchPaths",
          "kind": "property",
          "signature": "watchPaths: string[]",
          "lines": [
            87,
            87
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spokePaths",
          "kind": "property",
          "signature": "spokePaths",
          "lines": [
            88,
            88
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isRunning",
          "kind": "property",
          "signature": "isRunning",
          "lines": [
            89,
            89
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spokeStabilityTimers",
          "kind": "property",
          "signature": "spokeStabilityTimers",
          "lines": [
            91,
            94
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Pending stability timers for spoke files (extra delay beyond chokidar's threshold)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(config?: Partial<WatcherConfig>)",
          "lines": [
            96,
            99
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "fromConfig",
          "kind": "method",
          "signature": "fromConfig(config: PiBrainConfig): SessionWatcher",
          "lines": [
            104,
            117
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": true,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Create a SessionWatcher from pi-brain config",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "addSpokePath",
          "kind": "method",
          "signature": "addSpokePath(spokePath: string): void",
          "lines": [
            123,
            127
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Add a path as a spoke (synced) directory\nSynced directories use longer stability thresholds",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isFromSpoke",
          "kind": "method",
          "signature": "isFromSpoke(sessionPath: string): boolean",
          "lines": [
            135,
            146
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Check if a session file is from a spoke (synced) directory\n\nUses proper path boundary checking to avoid false matches\n(e.g., `/synced/laptop` should not match `/synced/laptop-backup/...`)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getStabilityThreshold",
          "kind": "method",
          "signature": "getStabilityThreshold(sessionPath: string): number",
          "lines": [
            156,
            160
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Get the stability threshold for a given session path\n\nNOTE: This method is for caller reference only. Chokidar uses a single\nglobal `stabilityThreshold` for all paths (awaitWriteFinish doesn't support\nper-path thresholds). Callers can use this to implement additional delays\nfor synced paths after receiving events, if needed.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "emitWithSpokeDelay",
          "kind": "method",
          "signature": "emitWithSpokeDelay(filePath: string, emitFn: () => void): void",
          "lines": [
            173,
            200
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Emit an event, applying extra delay for spoke (synced) files.\n\nChokidar's awaitWriteFinish uses a single global threshold (5s for local).\nFor spoke files, we add the difference between synced threshold (30s) and\nlocal threshold (5s) as an extra delay before emitting the event.\nThis accounts for network sync latency and partial file transfers.\n\nIf the file changes again during the delay, the previous pending event is\ncanceled and a new delay starts (debounce behavior).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSpokePaths",
          "kind": "method",
          "signature": "getSpokePaths(): Set<string>",
          "lines": [
            205,
            207
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Get the set of spoke paths being watched",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "start",
          "kind": "method",
          "signature": "async start(watchPaths: string | string[]): Promise<void>",
          "lines": [
            212,
            279
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Start watching the specified directories",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "startFromConfig",
          "kind": "method",
          "signature": "startFromConfig(config: PiBrainConfig): Promise<void>",
          "lines": [
            287,
            297
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Start watching directories from pi-brain config\n\nThis automatically includes both local sessions (hub) and synced sessions (enabled spokes).\nSpoke paths are registered here to support standalone usage without fromConfig().",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "stop",
          "kind": "method",
          "signature": "async stop(): Promise<void>",
          "lines": [
            302,
            330
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Stop watching",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSessionState",
          "kind": "method",
          "signature": "getSessionState(sessionPath: string): SessionState",
          "lines": [
            335,
            337
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Get the current state of a session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllSessions",
          "kind": "method",
          "signature": "getAllSessions(): Map<string, SessionState>",
          "lines": [
            342,
            344
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Get all tracked sessions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getWatchPaths",
          "kind": "method",
          "signature": "getWatchPaths(): {}",
          "lines": [
            349,
            351
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Get paths being watched",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "running",
          "kind": "getter",
          "signature": "get running(): boolean",
          "lines": [
            356,
            358
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Check if watcher is running",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sessionCount",
          "kind": "getter",
          "signature": "get sessionCount(): number",
          "lines": [
            363,
            365
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Get count of tracked sessions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "markAnalyzed",
          "kind": "method",
          "signature": "markAnalyzed(sessionPath: string): void",
          "lines": [
            370,
            376
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Mark a session as analyzed",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "markAnalyzing",
          "kind": "method",
          "signature": "markAnalyzing(sessionPath: string): void",
          "lines": [
            381,
            386
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Mark a session as being analyzed",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleNewFile",
          "kind": "method",
          "signature": "handleNewFile(filePath: string): void",
          "lines": [
            391,
            422
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Handle new file detected",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleFileChange",
          "kind": "method",
          "signature": "handleFileChange(filePath: string): void",
          "lines": [
            427,
            454
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Handle file change detected",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleFileRemove",
          "kind": "method",
          "signature": "handleFileRemove(filePath: string): void",
          "lines": [
            459,
            480
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Handle file removal",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "scheduleIdleCheck",
          "kind": "method",
          "signature": "scheduleIdleCheck(filePath: string): void",
          "lines": [
            485,
            502
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Schedule an idle check for a session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkIdle",
          "kind": "method",
          "signature": "checkIdle(filePath: string): void",
          "lines": [
            507,
            540
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "SessionWatcher",
          "annotation": null,
          "comment": "Check if a session is idle and trigger analysis if so",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createWatcher",
          "kind": "function",
          "signature": "createWatcher(daemonConfig: DaemonConfig): SessionWatcher",
          "lines": [
            546,
            550
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a watcher from daemon config",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isSessionFile",
          "kind": "function",
          "signature": "isSessionFile(filePath: string): boolean",
          "lines": [
            555,
            557
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a path is a valid session file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSessionName",
          "kind": "function",
          "signature": "getSessionName(sessionPath: string): string",
          "lines": [
            562,
            564
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract session name from path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getProjectFromSessionPath",
          "kind": "function",
          "signature": "getProjectFromSessionPath(sessionPath: string): string",
          "lines": [
            571,
            581
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract project name from session path\n\nSession paths are typically: ~/.pi/agent/sessions/<project-name>/<session-file>.jsonl",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/config.js",
        "../config/types.js",
        "./watcher-events.js",
        "chokidar",
        "node:fs",
        "node:fs/promises",
        "node:path"
      ]
    },
    {
      "path": "src/daemon/worker.ts",
      "language": "typescript",
      "lines": [
        1,
        717
      ],
      "detail_level": "full",
      "token_estimate": 961,
      "symbols": [
        {
          "name": "WorkerConfig",
          "kind": "interface",
          "signature": "WorkerConfig",
          "lines": [
            66,
            83
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Worker configuration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "WorkerStatus",
          "kind": "interface",
          "signature": "WorkerStatus",
          "lines": [
            86,
            101
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Worker status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "JobProcessingResult",
          "kind": "interface",
          "signature": "JobProcessingResult",
          "lines": [
            104,
            117
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from processing a single job",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Worker",
          "kind": "class",
          "signature": "Worker",
          "lines": [
            126,
            656
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Worker that processes jobs from the analysis queue",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "id",
          "kind": "property",
          "signature": "id: string",
          "lines": [
            127,
            127
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "config",
          "kind": "property",
          "signature": "config: PiBrainConfig",
          "lines": [
            128,
            128
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "retryPolicy",
          "kind": "property",
          "signature": "retryPolicy: RetryPolicy",
          "lines": [
            129,
            129
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "logger",
          "kind": "property",
          "signature": "logger: ProcessorLogger",
          "lines": [
            130,
            130
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "onJobStarted",
          "kind": "property",
          "signature": "onJobStarted?: (\n    job: AnalysisJob,\n    workerId: string\n  ) => Promise<void>",
          "lines": [
            131,
            134
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "onNodeCreated",
          "kind": "property",
          "signature": "onNodeCreated?: (\n    job: AnalysisJob,\n    node: Node\n  ) => Promise<void>",
          "lines": [
            135,
            138
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "onJobFailed",
          "kind": "property",
          "signature": "onJobFailed?: (\n    job: AnalysisJob,\n    error: Error\n  ) => Promise<void>",
          "lines": [
            139,
            142
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "pollIntervalMs",
          "kind": "property",
          "signature": "pollIntervalMs: number",
          "lines": [
            143,
            143
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "queue",
          "kind": "property",
          "signature": "queue: QueueManager | null",
          "lines": [
            145,
            145
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "processor",
          "kind": "property",
          "signature": "processor: JobProcessor | null",
          "lines": [
            146,
            146
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "connectionDiscoverer",
          "kind": "property",
          "signature": "connectionDiscoverer: ConnectionDiscoverer | null",
          "lines": [
            147,
            147
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "embeddingProvider",
          "kind": "property",
          "signature": "embeddingProvider: EmbeddingProvider | null",
          "lines": [
            148,
            148
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "db",
          "kind": "property",
          "signature": "db: Database.Database | null",
          "lines": [
            149,
            149
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "running",
          "kind": "property",
          "signature": "running",
          "lines": [
            150,
            150
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "currentJob",
          "kind": "property",
          "signature": "currentJob: AnalysisJob | null",
          "lines": [
            151,
            151
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "startedAt",
          "kind": "property",
          "signature": "startedAt: Date | null",
          "lines": [
            152,
            152
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "jobsProcessed",
          "kind": "property",
          "signature": "jobsProcessed",
          "lines": [
            155,
            155
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "jobsSucceeded",
          "kind": "property",
          "signature": "jobsSucceeded",
          "lines": [
            156,
            156
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "jobsFailed",
          "kind": "property",
          "signature": "jobsFailed",
          "lines": [
            157,
            157
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "constructor",
          "kind": "constructor",
          "signature": "constructor(config: WorkerConfig)",
          "lines": [
            159,
            168
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "initialize",
          "kind": "method",
          "signature": "initialize(db: Database.Database): void",
          "lines": [
            173,
            184
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Initialize the worker with database connection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "initializeEmbeddingProvider",
          "kind": "method",
          "signature": "initializeEmbeddingProvider(): void",
          "lines": [
            190,
            229
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Initialize the embedding provider from config.\nCalled during worker initialization. Safe to call multiple times.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "start",
          "kind": "method",
          "signature": "async start(): Promise<void>",
          "lines": [
            234,
            293
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Start the worker loop",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "stop",
          "kind": "method",
          "signature": "stop(): void",
          "lines": [
            298,
            301
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Stop the worker gracefully",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isRunning",
          "kind": "method",
          "signature": "isRunning(): boolean",
          "lines": [
            306,
            308
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Check if worker is running",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getCurrentJob",
          "kind": "method",
          "signature": "getCurrentJob(): any",
          "lines": [
            313,
            315
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Get the current job being processed",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getStatus",
          "kind": "method",
          "signature": "getStatus(): WorkerStatus",
          "lines": [
            320,
            330
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Get worker status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "processJob",
          "kind": "method",
          "signature": "async processJob(job: AnalysisJob): Promise<JobProcessingResult>",
          "lines": [
            337,
            529
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Process a single job (can be called directly for testing)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleJobFailure",
          "kind": "method",
          "signature": "async handleJobFailure(job: AnalysisJob, error: Error, startTime: number): Promise<JobProcessingResult>",
          "lines": [
            534,
            601
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Handle a job failure with proper error classification and retry logic",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateNodeEmbedding",
          "kind": "method",
          "signature": "async generateNodeEmbedding(node: Node): Promise<void>",
          "lines": [
            609,
            646
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Generate and store embedding for a node.\n\nThis is called after node creation to enable semantic search.\nErrors are logged but don't fail the job - the backfill job will catch any gaps.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "sleep",
          "kind": "method",
          "signature": "sleep(ms: number): Promise<void>",
          "lines": [
            651,
            655
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "Worker",
          "annotation": null,
          "comment": "Sleep for a specified duration",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createWorker",
          "kind": "function",
          "signature": "createWorker(config: WorkerConfig): Worker",
          "lines": [
            665,
            667
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a worker instance",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "processSingleJob",
          "kind": "function",
          "signature": "processSingleJob(job: AnalysisJob, config: PiBrainConfig, db: Database.Database, logger?: ProcessorLogger): Promise<JobProcessingResult>",
          "lines": [
            673,
            687
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Process a single job without the full worker loop\nUseful for one-off processing or testing",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "handleJobError",
          "kind": "function",
          "signature": "handleJobError(error: Error, job: AnalysisJob, retryPolicy: RetryPolicy = DEFAULT_RETRY_POLICY): { shouldRetry: boolean; retryDelayMinutes: number; formattedError: string; category: ReturnType<any>; }",
          "lines": [
            692,
            716
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Handle job error manually (for custom queue implementations)",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/config.js",
        "../config/types.js",
        "../parser/index.js",
        "../prompt/prompt.js",
        "../storage/embedding-utils.js",
        "../storage/index.js",
        "../storage/node-conversion.js",
        "../storage/node-types.js",
        "./connection-discovery.js",
        "./errors.js",
        "./facet-discovery.js",
        "./processor.js",
        "./queue.js",
        "better-sqlite3",
        "node:path"
      ]
    },
    {
      "path": "src/index.ts",
      "language": "typescript",
      "lines": [
        1,
        58
      ],
      "detail_level": "full",
      "token_estimate": 85,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./config/index.js",
        "./daemon/index.js",
        "./parser/analyzer.js",
        "./parser/boundary.js",
        "./parser/fork.js",
        "./parser/session.js",
        "./prompt/index.js",
        "./storage/database.js",
        "./storage/node-storage.js",
        "./storage/node-types.js",
        "./types.js",
        "./web/generator.js"
      ]
    },
    {
      "path": "src/parser/analyzer.ts",
      "language": "typescript",
      "lines": [
        1,
        336
      ],
      "detail_level": "full",
      "token_estimate": 720,
      "symbols": [
        {
          "name": "getDefaultSessionDir",
          "kind": "function",
          "signature": "getDefaultSessionDir(): string",
          "lines": [
            16,
            18
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default session directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "scanSessions",
          "kind": "function",
          "signature": "async scanSessions(sessionDir?: string): Promise<{}>",
          "lines": [
            31,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Scan session directory and parse all sessions\n\nNote: This function loads all sessions into memory. For large session\nhistories (thousands of sessions), consider using `scanSessionsIterator`\nwhich processes sessions one at a time.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "scanSessionsIterator",
          "kind": "function",
          "signature": "async *scanSessionsIterator(sessionDir?: string): AsyncGenerator<SessionInfo, void, unknown>",
          "lines": [
            60,
            102
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Async generator that yields sessions one at a time for memory efficiency\n\nUse this instead of `scanSessions` when processing large session histories\n(hundreds or thousands of sessions) to avoid loading all sessions into memory.\nSessions are yielded in file system order, not sorted by timestamp.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findForkRelationships",
          "kind": "function",
          "signature": "findForkRelationships(sessions: SessionInfo[]): {}",
          "lines": [
            107,
            127
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find fork relationships between sessions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "groupByProject",
          "kind": "function",
          "signature": "groupByProject(sessions: SessionInfo[]): {}",
          "lines": [
            132,
            164
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Group sessions by project (cwd)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "decodeProjectDir",
          "kind": "function",
          "signature": "decodeProjectDir(encodedName: string): string",
          "lines": [
            185,
            196
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Decode project directory name to path\ne.g., \"--home-will-projects-myapp--\"  \"/home/will/projects/myapp\"\n\n**Warning**: Pi's encoding is lossy - hyphens in original paths are not escaped.\nThis means \"--home-will-projects-pi-brain--\" could be either:\n  - /home/will/projects/pi-brain (correct)\n  - /home/will/projects/pi/brain (wrong)\n\nPrefer using session.header.cwd which contains the accurate original path.\nThis function is only useful for display purposes when session data is unavailable.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getProjectName",
          "kind": "function",
          "signature": "getProjectName(sessionPath: string): string",
          "lines": [
            210,
            217
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get project name from session path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getProjectNameFromSession",
          "kind": "function",
          "signature": "getProjectNameFromSession(session: SessionInfo): string",
          "lines": [
            228,
            230
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get project name from a SessionInfo object (preferred over getProjectName)\n\nThis function returns the accurate project path from the session header,\nwhich is not affected by the lossy directory name encoding.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "filterByProject",
          "kind": "function",
          "signature": "filterByProject(sessions: SessionInfo[], projectPath: string): {}",
          "lines": [
            235,
            240
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filter sessions by project path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "filterByDateRange",
          "kind": "function",
          "signature": "filterByDateRange(sessions: SessionInfo[], startDate?: Date, endDate?: Date): {}",
          "lines": [
            245,
            260
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filter sessions by date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "searchSessions",
          "kind": "function",
          "signature": "searchSessions(sessions: SessionInfo[], query: string): {}",
          "lines": [
            265,
            294
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Search sessions for text content",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getOverallStats",
          "kind": "function",
          "signature": "getOverallStats(sessions: SessionInfo[]): { totalSessions: number; totalEntries: number; totalMessages: number; totalTokens: number; totalCost: number; projectCount: number; forkCount: number; }",
          "lines": [
            299,
            335
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get session summary statistics",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types.js",
        "./session.js",
        "node:fs/promises",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/parser/boundary.ts",
      "language": "typescript",
      "lines": [
        1,
        573
      ],
      "detail_level": "full",
      "token_estimate": 1062,
      "symbols": [
        {
          "name": "BoundaryType",
          "kind": "type",
          "signature": "BoundaryType = | \"branch\"\n  | \"tree_jump\"\n  | \"compaction\"\n  | \"resume\"\n  | \"handoff\"",
          "lines": [
            29,
            34
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Types of boundaries that can occur within a session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Boundary",
          "kind": "interface",
          "signature": "Boundary",
          "lines": [
            39,
            50
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A detected boundary in the session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BoundaryMetadata",
          "kind": "interface",
          "signature": "BoundaryMetadata",
          "lines": [
            55,
            70
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Metadata for different boundary types",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Segment",
          "kind": "interface",
          "signature": "Segment",
          "lines": [
            75,
            88
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A segment is a contiguous span of entries between boundaries",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_RESUME_GAP_MINUTES",
          "kind": "variable",
          "signature": "10",
          "lines": [
            98,
            98
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default minimum gap in minutes to trigger a resume boundary.\nCan be overridden via BoundaryOptions.resumeGapMinutes.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BoundaryOptions",
          "kind": "interface",
          "signature": "BoundaryOptions",
          "lines": [
            103,
            109
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for boundary detection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "HANDOFF_PATTERNS",
          "kind": "variable",
          "signature": "{}",
          "lines": [
            121,
            126
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Handoff detection patterns - matches user messages indicating a handoff.\nCase-insensitive matching against message text content.\n\nExamples that match:\n- \"handoff to claude\"\n- \"hand this off to the architect\"\n- \"passing to security-auditor\"\n- \"continue with worker agent\"",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "HANDOFF_CUSTOM_TYPE",
          "kind": "variable",
          "signature": "\"handoff\"",
          "lines": [
            129,
            129
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "CustomEntry type for explicit handoff markers (for future upstream support)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "METADATA_ENTRY_TYPES",
          "kind": "variable",
          "signature": "any",
          "lines": [
            132,
            132
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Entry types that don't participate in the conversation tree",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractUserMessageText",
          "kind": "function",
          "signature": "extractUserMessageText(entry: SessionMessageEntry): string",
          "lines": [
            141,
            158
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract text content from a user message",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectHandoffFromMessage",
          "kind": "function",
          "signature": "detectHandoffFromMessage(text: string): string",
          "lines": [
            166,
            174
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect handoff from a user message using heuristic patterns",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isExplicitHandoffEntry",
          "kind": "function",
          "signature": "isExplicitHandoffEntry(entry: SessionEntry): { isHandoff: boolean; target?: string; }",
          "lines": [
            182,
            201
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a custom entry is an explicit handoff marker\n\nWhen pi upstream supports explicit handoff entries, they will be\nCustomEntry with customType === \"handoff\" and data containing target info.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LeafTracker",
          "kind": "class",
          "signature": "LeafTracker",
          "lines": [
            214,
            291
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Tracks the \"current leaf\" as entries are processed.\n\nIn a session tree, the leaf is the most recently added entry that\nhasn't become a parent of another entry. This is used to detect\ntree jumps (when a new entry's parentId doesn't match the current leaf).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "childrenOf",
          "kind": "property",
          "signature": "childrenOf",
          "lines": [
            216,
            216
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Map of entry ID to its children",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "latestEntryId",
          "kind": "property",
          "signature": "latestEntryId: string | null",
          "lines": [
            218,
            218
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Most recently seen entry ID",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "previousEntryId",
          "kind": "property",
          "signature": "previousEntryId: string | null",
          "lines": [
            220,
            220
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Previous entry's ID (for gap detection)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "previousTimestamp",
          "kind": "property",
          "signature": "previousTimestamp: string | null",
          "lines": [
            222,
            222
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Previous entry's timestamp",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "update",
          "kind": "method",
          "signature": "update(entry: SessionEntry): void",
          "lines": [
            227,
            241
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Update the tracker with a new entry",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getCurrentLeaf",
          "kind": "method",
          "signature": "getCurrentLeaf(): string",
          "lines": [
            249,
            251
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Get the current leaf entry ID\n\nThe leaf is the entry that was most recently added and hasn't\nbecome a parent of another entry yet.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getPreviousEntryId",
          "kind": "method",
          "signature": "getPreviousEntryId(): string",
          "lines": [
            256,
            258
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Get the previous entry ID (for gap detection)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getPreviousTimestamp",
          "kind": "method",
          "signature": "getPreviousTimestamp(): string",
          "lines": [
            263,
            265
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Get the previous entry timestamp",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isLeaf",
          "kind": "method",
          "signature": "isLeaf(entryId: string): boolean",
          "lines": [
            270,
            272
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Check if an entry is a leaf (has no children)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isBranchPoint",
          "kind": "method",
          "signature": "isBranchPoint(entryId: string): boolean",
          "lines": [
            277,
            280
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Check if an entry has multiple children (branch point)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "reset",
          "kind": "method",
          "signature": "reset(): void",
          "lines": [
            285,
            290
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": "LeafTracker",
          "annotation": null,
          "comment": "Reset the tracker",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectBoundaries",
          "kind": "function",
          "signature": "detectBoundaries(entries: SessionEntry[], options: BoundaryOptions = {}): {}",
          "lines": [
            304,
            443
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect all boundaries in a list of session entries",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createSegment",
          "kind": "function",
          "signature": "createSegment(segmentEntries: SessionEntry[], endingBoundaries: Boundary[]): Segment",
          "lines": [
            449,
            463
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a segment from a slice of entries\nPrecondition: segmentEntries.length > 0 (ensured by caller)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractSegments",
          "kind": "function",
          "signature": "extractSegments(entries: SessionEntry[], options: BoundaryOptions = {}): {}",
          "lines": [
            474,
            530
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract segments from entries based on detected boundaries\n\nA segment is a contiguous span of entries. Boundaries define the split points.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BoundaryStats",
          "kind": "interface",
          "signature": "BoundaryStats",
          "lines": [
            535,
            539
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get boundary statistics for a session",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getBoundaryStats",
          "kind": "function",
          "signature": "getBoundaryStats(entries: SessionEntry[], options: BoundaryOptions = {}): BoundaryStats",
          "lines": [
            548,
            572
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate statistics about boundaries in a session",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types.js"
      ]
    },
    {
      "path": "src/parser/fork.ts",
      "language": "typescript",
      "lines": [
        1,
        191
      ],
      "detail_level": "full",
      "token_estimate": 347,
      "symbols": [
        {
          "name": "ForkInfo",
          "kind": "interface",
          "signature": "ForkInfo",
          "lines": [
            22,
            33
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of detecting a fork from a session header",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isForkSession",
          "kind": "function",
          "signature": "isForkSession(header: SessionHeader, sessionPath: string): ForkInfo",
          "lines": [
            46,
            57
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a session is a fork (has parentSession in header)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findForks",
          "kind": "function",
          "signature": "findForks(sessions: SessionInfo[]): {}",
          "lines": [
            70,
            85
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find all fork relationships from a list of parsed sessions\n\nNote: Similar to analyzer.ts:findForkRelationships() but without sorting.\nThe analyzer version sorts by timestamp; this version preserves input order.\nBoth are exported to avoid circular imports that would exceed the barrel\nfile module limit.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findForksFromHeaders",
          "kind": "function",
          "signature": "findForksFromHeaders(headers: [string, SessionHeader][]): {}",
          "lines": [
            94,
            111
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find fork relationships given just session headers and paths\nUseful when you don't have fully parsed sessions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildForkTree",
          "kind": "function",
          "signature": "buildForkTree(forks: ForkRelationship[]): Map<string, {}>",
          "lines": [
            119,
            131
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build a map of session paths to their fork children",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getForkChain",
          "kind": "function",
          "signature": "getForkChain(sessionPath: string, forks: ForkRelationship[]): {}",
          "lines": [
            140,
            159
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the fork chain for a session (all ancestors via fork)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getForkDescendants",
          "kind": "function",
          "signature": "getForkDescendants(sessionPath: string, forks: ForkRelationship[]): {}",
          "lines": [
            168,
            190
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all descendants of a session via forks",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types.js"
      ]
    },
    {
      "path": "src/parser/index.ts",
      "language": "typescript",
      "lines": [
        1,
        9
      ],
      "detail_level": "full",
      "token_estimate": 29,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./analyzer.js",
        "./boundary.js",
        "./session.js",
        "./signals.js"
      ]
    },
    {
      "path": "src/parser/session.ts",
      "language": "typescript",
      "lines": [
        1,
        419
      ],
      "detail_level": "full",
      "token_estimate": 435,
      "symbols": [
        {
          "name": "parseSession",
          "kind": "function",
          "signature": "async parseSession(filePath: string): Promise<SessionInfo>",
          "lines": [
            25,
            28
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse a session JSONL file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseSessionContent",
          "kind": "function",
          "signature": "parseSessionContent(content: string, filePath: string): SessionInfo",
          "lines": [
            33,
            82
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse session content from string",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildTree",
          "kind": "function",
          "signature": "buildTree(entries: SessionEntry[]): any",
          "lines": [
            87,
            180
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build a tree structure from entries",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findLeaf",
          "kind": "function",
          "signature": "findLeaf(entries: SessionEntry[]): string",
          "lines": [
            186,
            210
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find the current leaf entry ID\nThe leaf is the latest entry that has no children",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findBranchPoints",
          "kind": "function",
          "signature": "findBranchPoints(entries: SessionEntry[]): {}",
          "lines": [
            215,
            227
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find branch points (entries with multiple children)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateStats",
          "kind": "function",
          "signature": "calculateStats(entries: SessionEntry[], tree: TreeNode | null): SessionStats",
          "lines": [
            232,
            304
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate session statistics",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateMaxDepth",
          "kind": "function",
          "signature": "calculateMaxDepth(node: TreeNode): number",
          "lines": [
            309,
            314
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate maximum depth of tree",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findSessionName",
          "kind": "function",
          "signature": "findSessionName(entries: SessionEntry[]): string",
          "lines": [
            319,
            331
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find session name from session_info entries",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findFirstMessage",
          "kind": "function",
          "signature": "findFirstMessage(entries: SessionEntry[]): string",
          "lines": [
            336,
            346
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find first user message preview",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractTextPreview",
          "kind": "function",
          "signature": "extractTextPreview(message: UserMessage | AssistantMessage, maxLength = 100): string",
          "lines": [
            351,
            370
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract text preview from a message",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "truncate",
          "kind": "function",
          "signature": "truncate(str: string, maxLength: number): string",
          "lines": [
            375,
            381
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Truncate string with ellipsis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getPathToEntry",
          "kind": "function",
          "signature": "getPathToEntry(entries: SessionEntry[], targetId: string): {}",
          "lines": [
            386,
            408
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the path from root to a specific entry",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEntry",
          "kind": "function",
          "signature": "getEntry(entries: SessionEntry[], id: string): any",
          "lines": [
            413,
            418
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get entry by ID",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types.js",
        "node:fs/promises"
      ]
    },
    {
      "path": "src/parser/signals.ts",
      "language": "typescript",
      "lines": [
        1,
        1095
      ],
      "detail_level": "full",
      "token_estimate": 1699,
      "symbols": [
        {
          "name": "REPHRASING_CASCADE_THRESHOLD",
          "kind": "variable",
          "signature": "3",
          "lines": [
            30,
            30
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Minimum consecutive user messages to count as rephrasing cascade",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "TOOL_LOOP_THRESHOLD",
          "kind": "variable",
          "signature": "3",
          "lines": [
            33,
            33
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Minimum times same tool error to count as tool loop",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CONTEXT_CHURN_THRESHOLD",
          "kind": "variable",
          "signature": "10",
          "lines": [
            36,
            36
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "High context churn threshold (reads/ls on different files per segment)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ABANDONED_RESTART_WINDOW_MINUTES",
          "kind": "variable",
          "signature": "30",
          "lines": [
            39,
            39
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Maximum minutes between abandoned node and restart to count as abandoned restart",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "COMPLEX_TASK_TOOL_CALL_THRESHOLD",
          "kind": "variable",
          "signature": "3",
          "lines": [
            42,
            42
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Minimum tool calls to consider a task \"complex\" for one-shot success",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SARCASM_NEGATION_PATTERNS",
          "kind": "variable",
          "signature": "readonly RegExp[]",
          "lines": [
            51,
            60
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Patterns indicating sarcasm or frustration (false positives for praise/success)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PRAISE_PATTERNS",
          "kind": "variable",
          "signature": "readonly RegExp[]",
          "lines": [
            65,
            87
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Patterns indicating genuine praise or success",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CORRECTION_PATTERNS",
          "kind": "variable",
          "signature": "readonly RegExp[]",
          "lines": [
            92,
            110
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Patterns indicating user correction or confusion",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countRephrasingCascades",
          "kind": "function",
          "signature": "countRephrasingCascades(entries: SessionEntry[]): number",
          "lines": [
            126,
            163
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count rephrasing cascades in a segment\n\nA rephrasing cascade is 3+ consecutive user messages without a meaningful\nassistant response (no tool calls, no substantial text).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasToolCallOrSubstantialText",
          "kind": "function",
          "signature": "hasToolCallOrSubstantialText(msg: AssistantMessage): boolean",
          "lines": [
            168,
            183
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if an assistant message has a tool call or substantial text",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countToolLoops",
          "kind": "function",
          "signature": "countToolLoops(entries: SessionEntry[]): number",
          "lines": [
            190,
            220
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count tool loops in a segment\n\nA tool loop is when the same tool fails with the same error type 3+ times.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractErrorSignature",
          "kind": "function",
          "signature": "extractErrorSignature(toolResult: ToolResultMessage): string",
          "lines": [
            225,
            240
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract a normalized error signature from a tool result",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "normalizeErrorMessage",
          "kind": "function",
          "signature": "normalizeErrorMessage(msg: string): string",
          "lines": [
            245,
            253
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Normalize error message for comparison",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractLsDirectory",
          "kind": "function",
          "signature": "extractLsDirectory(cmd: string): string",
          "lines": [
            261,
            284
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract directory path from an ls command\n\nNote: This handles basic cases including options but does not fully\nparse shell quoting. Paths with spaces in quotes may not be extracted correctly.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countContextChurn",
          "kind": "function",
          "signature": "countContextChurn(entries: SessionEntry[]): number",
          "lines": [
            292,
            342
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count context churn events\n\nContext churn is high frequency of read/ls operations on different files,\nindicating the user is fighting the context window.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectModelSwitch",
          "kind": "function",
          "signature": "detectModelSwitch(entries: SessionEntry[], previousSegmentModel?: string): string",
          "lines": [
            349,
            381
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect if a model switch occurred for this segment\n\nReturns the model switched FROM if this segment is a retry with a different model.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectSilentTermination",
          "kind": "function",
          "signature": "detectSilentTermination(entries: SessionEntry[], isLastSegment: boolean, wasResumed: boolean): boolean",
          "lines": [
            389,
            436
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect silent termination\n\nSession ends mid-task (no handoff, no success) and is not resumed.\nThis is detected by checking if the last entry shows incomplete work.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractTextFromContent",
          "kind": "function",
          "signature": "extractTextFromContent(content: ContentBlock[]): string",
          "lines": [
            441,
            449
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract text from content blocks",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasGenuineSuccessIndicator",
          "kind": "function",
          "signature": "hasGenuineSuccessIndicator(text: string): boolean",
          "lines": [
            454,
            472
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if text contains genuine success indicators (not negated or sarcastic)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractManualFlags",
          "kind": "function",
          "signature": "extractManualFlags(entries: SessionEntry[]): {}",
          "lines": [
            479,
            507
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract manual flags from session entries\n\nLooks for custom entries with type 'brain_flag'",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateFrictionScore",
          "kind": "function",
          "signature": "calculateFrictionScore(friction: FrictionSignals): number",
          "lines": [
            518,
            546
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate overall friction score (0.0-1.0)\n\nWeights different friction signals based on severity.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FrictionDetectionOptions",
          "kind": "interface",
          "signature": "FrictionDetectionOptions",
          "lines": [
            555,
            564
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for friction detection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectFrictionSignals",
          "kind": "function",
          "signature": "detectFrictionSignals(entries: SessionEntry[], options: FrictionDetectionOptions = {}): FrictionSignals",
          "lines": [
            569,
            601
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect all friction signals in a session segment",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getFilesTouched",
          "kind": "function",
          "signature": "getFilesTouched(entries: SessionEntry[]): Set<string>",
          "lines": [
            611,
            642
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a segment touches similar files to another segment\n(for abandoned restart detection)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasFileOverlap",
          "kind": "function",
          "signature": "hasFileOverlap(files1: Set<string>, files2: Set<string>, threshold = 0.3): boolean",
          "lines": [
            647,
            665
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if two sets of files have significant overlap",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getPrimaryModel",
          "kind": "function",
          "signature": "getPrimaryModel(entries: SessionEntry[]): string",
          "lines": [
            670,
            700
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the primary model used in a segment",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSegmentTimestamp",
          "kind": "function",
          "signature": "getSegmentTimestamp(entries: SessionEntry[]): string",
          "lines": [
            705,
            714
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get segment timestamp for abandoned restart detection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isAbandonedRestart",
          "kind": "function",
          "signature": "isAbandonedRestart(segmentA: { entries: SessionEntry[]; outcome: string; endTime: string }, segmentB: { entries: SessionEntry[]; startTime: string }): boolean",
          "lines": [
            724,
            758
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if segment B is an abandoned restart of segment A\n\nCriteria:\n- Segment A has outcome 'abandoned'\n- Segment B starts within 30 minutes of segment A ending\n- Both segments touch similar files",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isAbandonedRestartFromNode",
          "kind": "function",
          "signature": "isAbandonedRestartFromNode(previousNode: {\n    outcome: string;\n    timestamp: string;\n    filesTouched: string[];\n  }, currentStartTime: string, currentFilesTouched: string[]): boolean",
          "lines": [
            771,
            810
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a current segment is an abandoned restart of a previous node.\n\nThis is similar to `isAbandonedRestart` but works with already-computed\nnode data (with filesTouched arrays) instead of raw session entries.\n\nCriteria:\n- Previous node has outcome 'abandoned'\n- Current segment starts within 30 minutes of previous node's timestamp\n- Both touch similar files (30% overlap threshold)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectResilientRecovery",
          "kind": "function",
          "signature": "detectResilientRecovery(entries: SessionEntry[]): boolean",
          "lines": [
            822,
            864
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect resilient recovery\n\nTool error occurs, but the model fixes it WITHOUT user intervention,\nand the task ultimately succeeds.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isMinimalAcknowledgment",
          "kind": "function",
          "signature": "isMinimalAcknowledgment(text: string): boolean",
          "lines": [
            869,
            887
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if text is a minimal acknowledgment (not a correction)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectOneShotSuccess",
          "kind": "function",
          "signature": "detectOneShotSuccess(entries: SessionEntry[]): boolean",
          "lines": [
            894,
            941
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect one-shot success\n\nComplex task (multiple tool calls) completed with zero user corrections/rephrasings.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isUserCorrection",
          "kind": "function",
          "signature": "isUserCorrection(text: string): boolean",
          "lines": [
            946,
            975
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if user message looks like a correction",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectExplicitPraise",
          "kind": "function",
          "signature": "detectExplicitPraise(entries: SessionEntry[]): boolean",
          "lines": [
            982,
            1005
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect explicit praise from user\n\nUser says \"great job\", \"perfect\", \"thanks\", etc.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasGenuinePraise",
          "kind": "function",
          "signature": "hasGenuinePraise(text: string): boolean",
          "lines": [
            1010,
            1028
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if text contains genuine praise",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateDelightScore",
          "kind": "function",
          "signature": "calculateDelightScore(delight: DelightSignals): number",
          "lines": [
            1039,
            1058
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate overall delight score (0.0-1.0)\n\nWeights different delight signals based on significance.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DelightDetectionOptions",
          "kind": "interface",
          "signature": "DelightDetectionOptions",
          "lines": [
            1067,
            1070
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for delight detection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "detectDelightSignals",
          "kind": "function",
          "signature": "detectDelightSignals(entries: SessionEntry[], _options: DelightDetectionOptions = {}): DelightSignals",
          "lines": [
            1075,
            1094
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Detect all delight signals in a session segment",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types.js",
        "../types/index.js"
      ]
    },
    {
      "path": "src/prompt/agents-generator.ts",
      "language": "typescript",
      "lines": [
        1,
        649
      ],
      "detail_level": "full",
      "token_estimate": 628,
      "symbols": [
        {
          "name": "AgentsGeneratorConfig",
          "kind": "interface",
          "signature": "AgentsGeneratorConfig",
          "lines": [
            31,
            52
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Configuration for AGENTS.md generation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AgentsGeneratorResult",
          "kind": "interface",
          "signature": "AgentsGeneratorResult",
          "lines": [
            57,
            76
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of AGENTS.md generation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelInsightData",
          "kind": "interface",
          "signature": "ModelInsightData",
          "lines": [
            81,
            90
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Data gathered for a model's AGENTS.md",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterRow",
          "kind": "interface",
          "signature": "ClusterRow",
          "lines": [
            96,
            108
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_OUTPUT_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            114,
            114
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_CONFIDENCE",
          "kind": "variable",
          "signature": "0.5",
          "lines": [
            115,
            115
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_FREQUENCY",
          "kind": "variable",
          "signature": "2",
          "lines": [
            116,
            116
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_QUIRKS",
          "kind": "variable",
          "signature": "10",
          "lines": [
            117,
            117
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_WINS",
          "kind": "variable",
          "signature": "10",
          "lines": [
            118,
            118
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_TOOL_ERRORS",
          "kind": "variable",
          "signature": "10",
          "lines": [
            119,
            119
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_TIMEOUT_MINUTES",
          "kind": "variable",
          "signature": "5",
          "lines": [
            120,
            120
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "gatherModelData",
          "kind": "function",
          "signature": "gatherModelData(db: Database.Database, model: string, config: AgentsGeneratorConfig = {}): ModelInsightData",
          "lines": [
            129,
            189
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Gather all insights and clusters for a specific model",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getFrictionClustersForModel",
          "kind": "function",
          "signature": "getFrictionClustersForModel(db: Database.Database, model: string): {}",
          "lines": [
            194,
            226
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get friction clusters associated with a model",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatDataForPrompt",
          "kind": "function",
          "signature": "formatDataForPrompt(data: ModelInsightData): string",
          "lines": [
            231,
            298
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format model data into a structured prompt for LLM synthesis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateFallbackAgents",
          "kind": "function",
          "signature": "generateFallbackAgents(data: ModelInsightData): string",
          "lines": [
            304,
            354
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate a fallback AGENTS.md without LLM synthesis\nUsed when LLM is not available or synthesis fails",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "synthesizeWithLLM",
          "kind": "function",
          "signature": "async synthesizeWithLLM(data: ModelInsightData, config: AgentsGeneratorConfig = {}): Promise<string>",
          "lines": [
            359,
            388
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Use LLM to synthesize model data into coherent AGENTS.md content",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultSystemPrompt",
          "kind": "function",
          "signature": "getDefaultSystemPrompt(): string",
          "lines": [
            393,
            415
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default system prompt for AGENTS.md generation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "spawnPiAgent",
          "kind": "function",
          "signature": "async spawnPiAgent(options: {\n  provider: string;\n  model: string;\n  systemPrompt: string;\n  userPrompt: string;\n  timeoutMinutes: number;\n}): Promise<string>",
          "lines": [
            420,
            495
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Spawn pi agent to process the synthesis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateAgentsForModel",
          "kind": "function",
          "signature": "async generateAgentsForModel(db: Database.Database, model: string, config: AgentsGeneratorConfig = {}): Promise<AgentsGeneratorResult>",
          "lines": [
            500,
            571
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate AGENTS.md for a specific model",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listModelsWithInsights",
          "kind": "function",
          "signature": "listModelsWithInsights(db: Database.Database): {}",
          "lines": [
            576,
            586
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List all models that have insights in the database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "previewAgentsForModel",
          "kind": "function",
          "signature": "async previewAgentsForModel(db: Database.Database, model: string, config: AgentsGeneratorConfig = {}): Promise<AgentsGeneratorResult>",
          "lines": [
            591,
            648
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Preview AGENTS.md generation without saving",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../storage/pattern-repository.js",
        "../types/index.js",
        "./prompt-generator.js",
        "better-sqlite3",
        "node:child_process",
        "node:fs/promises",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/prompt/effectiveness.ts",
      "language": "typescript",
      "lines": [
        1,
        881
      ],
      "detail_level": "full",
      "token_estimate": 1223,
      "symbols": [
        {
          "name": "MeasureEffectivenessOptions",
          "kind": "interface",
          "signature": "MeasureEffectivenessOptions",
          "lines": [
            32,
            38
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeDataFileRow",
          "kind": "interface",
          "signature": "NodeDataFileRow",
          "lines": [
            40,
            43
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_SESSIONS",
          "kind": "variable",
          "signature": "10",
          "lines": [
            49,
            49
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CHI_SQUARE_CRITICAL",
          "kind": "variable",
          "signature": "3.841",
          "lines": [
            52,
            52
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LIKE_ESCAPE_CHAR",
          "kind": "variable",
          "signature": "\"\\\\\"",
          "lines": [
            55,
            55
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MAX_PROMPTING_PATTERN_NODES",
          "kind": "variable",
          "signature": "1000",
          "lines": [
            59,
            59
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateId",
          "kind": "function",
          "signature": "generateId(): string",
          "lines": [
            68,
            70
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate a random ID for effectiveness records",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "normalizePattern",
          "kind": "function",
          "signature": "normalizePattern(text: string): string",
          "lines": [
            75,
            77
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Normalize pattern text for matching (same as insight-aggregation.ts)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "escapeLikePattern",
          "kind": "function",
          "signature": "escapeLikePattern(pattern: string): string",
          "lines": [
            82,
            87
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Escape SQL LIKE special characters (%, _) to prevent pattern interpretation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countSessions",
          "kind": "function",
          "signature": "countSessions(db: Database.Database, dateRange: DateRange): number",
          "lines": [
            92,
            104
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count unique sessions within a date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countNodes",
          "kind": "function",
          "signature": "countNodes(db: Database.Database, dateRange: DateRange): number",
          "lines": [
            109,
            121
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count nodes analyzed within a date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countQuirkOccurrences",
          "kind": "function",
          "signature": "countQuirkOccurrences(db: Database.Database, insight: AggregatedInsight, dateRange: DateRange): number",
          "lines": [
            126,
            157
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count occurrences of a quirk pattern within a date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countToolErrorOccurrences",
          "kind": "function",
          "signature": "countToolErrorOccurrences(db: Database.Database, insight: AggregatedInsight, dateRange: DateRange): number",
          "lines": [
            162,
            190
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count occurrences of a tool error pattern within a date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countLessonOccurrences",
          "kind": "function",
          "signature": "countLessonOccurrences(db: Database.Database, insight: AggregatedInsight, dateRange: DateRange): number",
          "lines": [
            195,
            219
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count occurrences of a lesson pattern within a date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countPromptingPatternOccurrences",
          "kind": "function",
          "signature": "countPromptingPatternOccurrences(db: Database.Database, insight: AggregatedInsight, dateRange: DateRange): number",
          "lines": [
            228,
            290
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count occurrences of win/failure patterns within a date range.\nThese are stored in node JSON files, not in the database directly.\n\nNote: This function limits the number of files read to MAX_PROMPTING_PATTERN_NODES\nto prevent unbounded I/O. For very large date ranges, results may be approximate.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countOccurrences",
          "kind": "function",
          "signature": "countOccurrences(db: Database.Database, insight: AggregatedInsight, dateRange: DateRange): number",
          "lines": [
            295,
            320
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count occurrences of an insight pattern within a date range",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculateAverageSeverity",
          "kind": "function",
          "signature": "calculateAverageSeverity(insight: AggregatedInsight): number",
          "lines": [
            326,
            342
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate average severity for occurrences within a date range.\nReturns a value between 0.0 and 1.0.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isStatisticallySignificant",
          "kind": "function",
          "signature": "isStatisticallySignificant(beforeCount: number, afterCount: number, beforeSessions: number, afterSessions: number, minSessions: number = DEFAULT_MIN_SESSIONS): boolean",
          "lines": [
            350,
            387
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Simplified chi-square test for statistical significance.\n\nTests whether the difference between before and after rates is\nstatistically significant at p < 0.05.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "measureEffectiveness",
          "kind": "function",
          "signature": "measureEffectiveness(db: Database.Database, insightId: string, beforePeriod: DateRange, afterPeriod: DateRange, options: MeasureEffectivenessOptions = {}): EffectivenessResult",
          "lines": [
            399,
            451
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Measure the effectiveness of a prompt addition for a specific insight.\n\nCompares occurrence rates before and after the prompt was added to\ndetermine if it actually helped reduce the targeted behavior.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "measureAndStoreEffectiveness",
          "kind": "function",
          "signature": "measureAndStoreEffectiveness(db: Database.Database, insightId: string, beforePeriod: DateRange, afterPeriod: DateRange, promptVersion: string, options: MeasureEffectivenessOptions = {}): PromptEffectiveness",
          "lines": [
            456,
            621
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Measure effectiveness and store the result in the database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEffectivenessHistory",
          "kind": "function",
          "signature": "getEffectivenessHistory(db: Database.Database, insightId: string): {}",
          "lines": [
            626,
            640
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get effectiveness measurements for an insight",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLatestEffectiveness",
          "kind": "function",
          "signature": "getLatestEffectiveness(db: Database.Database, insightId: string): any",
          "lines": [
            645,
            663
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the latest effectiveness measurement for an insight",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLatestEffectivenessBatch",
          "kind": "function",
          "signature": "getLatestEffectivenessBatch(db: Database.Database, insightIds: string[]): Map<string, PromptEffectiveness>",
          "lines": [
            669,
            699
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the latest effectiveness measurements for multiple insights in a single query.\nReturns a map of insightId -> PromptEffectiveness.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getInsightsNeedingMeasurement",
          "kind": "function",
          "signature": "getInsightsNeedingMeasurement(db: Database.Database, measureAfterDays = 7): {}",
          "lines": [
            705,
            731
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all insights that need effectiveness measurement.\nReturns insights that are included in prompts but haven't been measured recently.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "autoDisableIneffectiveInsights",
          "kind": "function",
          "signature": "autoDisableIneffectiveInsights(db: Database.Database, options: {\n    threshold?: number; // Improvement % threshold (e.g. -10)\n    minSessions?: number;\n  } = {}): {}",
          "lines": [
            737,
            792
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Auto-disable insights that have been measured as ineffective.\nReturns the IDs of disabled insights.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EffectivenessRow",
          "kind": "interface",
          "signature": "EffectivenessRow",
          "lines": [
            798,
            817
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InsightRow",
          "kind": "interface",
          "signature": "InsightRow",
          "lines": [
            819,
            836
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "rowToEffectiveness",
          "kind": "function",
          "signature": "rowToEffectiveness(row: EffectivenessRow): PromptEffectiveness",
          "lines": [
            838,
            859
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insightRowToAggregatedInsight",
          "kind": "function",
          "signature": "insightRowToAggregatedInsight(row: InsightRow): AggregatedInsight",
          "lines": [
            861,
            880
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../storage/node-storage.js",
        "../storage/pattern-repository.js",
        "../types/index.js",
        "better-sqlite3",
        "node:crypto"
      ]
    },
    {
      "path": "src/prompt/index.ts",
      "language": "typescript",
      "lines": [
        1,
        13
      ],
      "detail_level": "full",
      "token_estimate": 45,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./agents-generator.js",
        "./effectiveness.js",
        "./prompt-generator.js",
        "./prompt-injector.js",
        "./prompt.js",
        "./types.js"
      ]
    },
    {
      "path": "src/prompt/prompt-generator.ts",
      "language": "typescript",
      "lines": [
        1,
        360
      ],
      "detail_level": "full",
      "token_estimate": 515,
      "symbols": [
        {
          "name": "GeneratePromptOptions",
          "kind": "interface",
          "signature": "GeneratePromptOptions",
          "lines": [
            25,
            36
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_CONFIDENCE",
          "kind": "variable",
          "signature": "0.5",
          "lines": [
            42,
            42
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_FREQUENCY",
          "kind": "variable",
          "signature": "3",
          "lines": [
            43,
            43
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_QUIRKS",
          "kind": "variable",
          "signature": "5",
          "lines": [
            44,
            44
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_WINS",
          "kind": "variable",
          "signature": "5",
          "lines": [
            45,
            45
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MAX_TOOL_ISSUES",
          "kind": "variable",
          "signature": "5",
          "lines": [
            46,
            46
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getModelDisplayName",
          "kind": "function",
          "signature": "getModelDisplayName(model: string): string",
          "lines": [
            55,
            74
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get a human-readable model name from provider/model format",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "groupInsightsByModel",
          "kind": "function",
          "signature": "groupInsightsByModel(insights: AggregatedInsight[]): Map<string, {}>",
          "lines": [
            79,
            99
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Group insights by model",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "filterActionableInsights",
          "kind": "function",
          "signature": "filterActionableInsights(insights: AggregatedInsight[], options: GeneratePromptOptions = {}): {}",
          "lines": [
            104,
            129
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filter insights to actionable ones",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatModelSection",
          "kind": "function",
          "signature": "formatModelSection(model: string, insights: AggregatedInsight[], options: GeneratePromptOptions = {}): string",
          "lines": [
            134,
            198
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format a model-specific prompt section",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generatePromptAdditions",
          "kind": "function",
          "signature": "generatePromptAdditions(insights: AggregatedInsight[], options: GeneratePromptOptions = {}): {}",
          "lines": [
            207,
            246
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate prompt additions for all models with insights",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generatePromptAdditionsFromDb",
          "kind": "function",
          "signature": "generatePromptAdditionsFromDb(db: Database.Database, options: GeneratePromptOptions = {}): {}",
          "lines": [
            253,
            270
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate prompt additions from the database\n\nFetches insights from aggregated_insights table and generates additions.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatPromptAdditionsDocument",
          "kind": "function",
          "signature": "formatPromptAdditionsDocument(additions: PromptAddition[]): string",
          "lines": [
            277,
            300
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format a complete prompt additions document\n\nCombines all model-specific additions into a single markdown document.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateInsightPromptTexts",
          "kind": "function",
          "signature": "updateInsightPromptTexts(db: Database.Database, additions: PromptAddition[], promptVersion?: string): void",
          "lines": [
            308,
            332
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate and store prompt text for insights\n\nFor each insight that should be included in prompts, generates the\nappropriate prompt text and updates the database.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getPromptAdditionsForModel",
          "kind": "function",
          "signature": "getPromptAdditionsForModel(db: Database.Database, model: string, options: GeneratePromptOptions = {}): any",
          "lines": [
            337,
            359
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get prompt additions for a specific model",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../storage/pattern-repository.js",
        "../types/index.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/prompt/prompt-injector.ts",
      "language": "typescript",
      "lines": [
        1,
        445
      ],
      "detail_level": "full",
      "token_estimate": 582,
      "symbols": [
        {
          "name": "InjectionMethod",
          "kind": "type",
          "signature": "InjectionMethod = \"skill\" | \"agents_file\"",
          "lines": [
            30,
            30
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InjectionScope",
          "kind": "type",
          "signature": "InjectionScope = \"analysis_only\" | \"global\"",
          "lines": [
            31,
            31
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PromptInjectionConfig",
          "kind": "interface",
          "signature": "PromptInjectionConfig",
          "lines": [
            33,
            46
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InjectionResult",
          "kind": "interface",
          "signature": "InjectionResult",
          "lines": [
            48,
            57
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_CONFIDENCE",
          "kind": "variable",
          "signature": "0.7",
          "lines": [
            63,
            63
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_MIN_FREQUENCY",
          "kind": "variable",
          "signature": "5",
          "lines": [
            64,
            64
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_SKILL_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            65,
            65
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AGENTS_FILE_PATH",
          "kind": "variable",
          "signature": "any",
          "lines": [
            66,
            66
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AGENTS_MARKER_START",
          "kind": "variable",
          "signature": "\"<!-- pi-brain-insights -->\"",
          "lines": [
            69,
            69
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AGENTS_MARKER_END",
          "kind": "variable",
          "signature": "\"<!-- /pi-brain-insights -->\"",
          "lines": [
            70,
            70
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateSkillFrontmatter",
          "kind": "function",
          "signature": "generateSkillFrontmatter(models: string[]): string",
          "lines": [
            79,
            91
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate the brain-insights skill frontmatter",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateBrainInsightsSkill",
          "kind": "function",
          "signature": "generateBrainInsightsSkill(additions: PromptAddition[]): string",
          "lines": [
            96,
            126
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate the full brain-insights skill content",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "writeBrainInsightsSkill",
          "kind": "function",
          "signature": "writeBrainInsightsSkill(db: Database.Database, options: PromptInjectionConfig = {}): InjectionResult",
          "lines": [
            131,
            182
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Write the brain-insights skill to disk",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateModelSkill",
          "kind": "function",
          "signature": "generateModelSkill(db: Database.Database, model: string, options: PromptInjectionConfig = {}): string",
          "lines": [
            187,
            207
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate skill content for a specific model",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatAgentsSection",
          "kind": "function",
          "signature": "formatAgentsSection(additions: PromptAddition[]): string",
          "lines": [
            216,
            222
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format insights section for AGENTS.md",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateAgentsFile",
          "kind": "function",
          "signature": "updateAgentsFile(db: Database.Database, options: PromptInjectionConfig = {}): InjectionResult",
          "lines": [
            230,
            296
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Update AGENTS.md with insights section\n\nWARNING: This affects ALL pi sessions, not just analysis.\nUse skill-based injection instead.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "removeFromAgentsFile",
          "kind": "function",
          "signature": "removeFromAgentsFile(options: PromptInjectionConfig = {}): InjectionResult",
          "lines": [
            301,
            336
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Remove insights section from AGENTS.md",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "injectInsights",
          "kind": "function",
          "signature": "injectInsights(db: Database.Database, options: PromptInjectionConfig = {}): InjectionResult",
          "lines": [
            345,
            365
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Inject insights into prompts using configured method",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "removeInjectedInsights",
          "kind": "function",
          "signature": "removeInjectedInsights(options: PromptInjectionConfig = {}): InjectionResult",
          "lines": [
            370,
            407
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Remove injected insights",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getInjectionStatus",
          "kind": "function",
          "signature": "getInjectionStatus(options: PromptInjectionConfig = {}): { skillExists: boolean; skillPath: string; agentsHasSection: boolean; agentsPath: string; }",
          "lines": [
            412,
            436
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check current injection status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "escapeRegex",
          "kind": "function",
          "signature": "escapeRegex(str: string): string",
          "lines": [
            442,
            444
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types/index.js",
        "./prompt-generator.js",
        "better-sqlite3",
        "node:fs",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/prompt/prompt.ts",
      "language": "typescript",
      "lines": [
        1,
        388
      ],
      "detail_level": "full",
      "token_estimate": 867,
      "symbols": [
        {
          "name": "DEFAULT_PROMPTS_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            30,
            30
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default prompts directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_PROMPT_PATH",
          "kind": "variable",
          "signature": "any",
          "lines": [
            35,
            38
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default prompt file path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_HISTORY_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            43,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default history directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "normalizePromptContent",
          "kind": "function",
          "signature": "normalizePromptContent(content: string): string",
          "lines": [
            51,
            57
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Normalize prompt content for hashing\n\nThis ensures that whitespace changes and HTML comments don't\nunnecessarily trigger new versions.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "calculatePromptHash",
          "kind": "function",
          "signature": "calculatePromptHash(content: string): string",
          "lines": [
            64,
            67
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Calculate the hash of prompt content\n\nReturns an 8-character hex prefix of SHA-256 hash",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseVersionString",
          "kind": "function",
          "signature": "parseVersionString(version: string): { sequential: number; hash: string; }",
          "lines": [
            72,
            83
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse a version string into its components",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createVersionString",
          "kind": "function",
          "signature": "createVersionString(sequential: number, hash: string): string",
          "lines": [
            88,
            90
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a version string from components",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getArchiveFilename",
          "kind": "function",
          "signature": "getArchiveFilename(version: string): string",
          "lines": [
            95,
            98
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the archive filename for a version",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ensurePromptsDir",
          "kind": "function",
          "signature": "ensurePromptsDir(promptsDir?: string): void",
          "lines": [
            103,
            113
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Ensure the prompts directory structure exists",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getVersionByHash",
          "kind": "function",
          "signature": "getVersionByHash(db: Database.Database, hash: string): any",
          "lines": [
            118,
            126
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get prompt version by content hash from database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLatestVersion",
          "kind": "function",
          "signature": "getLatestVersion(db: Database.Database): any",
          "lines": [
            131,
            138
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the latest prompt version from database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNextSequential",
          "kind": "function",
          "signature": "getNextSequential(db: Database.Database): number",
          "lines": [
            143,
            151
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the next sequential version number",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "recordPromptVersion",
          "kind": "function",
          "signature": "recordPromptVersion(db: Database.Database, version: PromptVersion, notes?: string): void",
          "lines": [
            156,
            171
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Record a new prompt version in the database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "archivePrompt",
          "kind": "function",
          "signature": "archivePrompt(promptPath: string, historyDir: string, version: string): string",
          "lines": [
            176,
            194
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Archive prompt to history directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getOrCreatePromptVersion",
          "kind": "function",
          "signature": "getOrCreatePromptVersion(db: Database.Database, promptPath: string, historyDir?: string): PromptVersion",
          "lines": [
            203,
            255
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get or create a prompt version\n\nIf the current prompt has the same hash as an existing version,\nreturns that version. Otherwise, creates a new version, archives\nthe prompt, and records it in the database.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "compareVersions",
          "kind": "function",
          "signature": "compareVersions(a: string, b: string): number",
          "lines": [
            262,
            272
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Compare two version strings\n\nReturns negative if a < b, positive if a > b, 0 if equal",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listPromptVersions",
          "kind": "function",
          "signature": "listPromptVersions(db: Database.Database): {}",
          "lines": [
            277,
            292
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List all prompt versions from database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasOutdatedNodes",
          "kind": "function",
          "signature": "hasOutdatedNodes(db: Database.Database, currentVersion: string): boolean",
          "lines": [
            299,
            311
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a prompt needs reanalysis\n\nReturns true if nodes exist that were analyzed with an older version",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getOutdatedNodeCount",
          "kind": "function",
          "signature": "getOutdatedNodeCount(db: Database.Database, currentVersion: string): number",
          "lines": [
            316,
            328
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get count of nodes needing reanalysis",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getBundledPromptPath",
          "kind": "function",
          "signature": "getBundledPromptPath(): string",
          "lines": [
            335,
            340
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the path to the bundled default prompt\n\nThis is the prompt file shipped with the pi-brain package",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ensureDefaultPrompt",
          "kind": "function",
          "signature": "ensureDefaultPrompt(targetPath?: string): boolean",
          "lines": [
            348,
            387
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Ensure the default prompt exists at the target location\n\nIf no prompt file exists at the target path, copies the bundled default.\nReturns true if a new prompt was installed, false if one already existed.",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./types.js",
        "better-sqlite3",
        "node:crypto",
        "node:fs",
        "node:os",
        "node:path",
        "node:url"
      ]
    },
    {
      "path": "src/prompt/types.ts",
      "language": "typescript",
      "lines": [
        1,
        35
      ],
      "detail_level": "full",
      "token_estimate": 67,
      "symbols": [
        {
          "name": "PromptVersion",
          "kind": "interface",
          "signature": "PromptVersion",
          "lines": [
            8,
            23
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Types for prompt versioning and management\nPrompt version information",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PromptVersionRecord",
          "kind": "interface",
          "signature": "PromptVersionRecord",
          "lines": [
            28,
            34
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Prompt info retrieved from database",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/storage/database.ts",
      "language": "typescript",
      "lines": [
        1,
        298
      ],
      "detail_level": "full",
      "token_estimate": 513,
      "symbols": [
        {
          "name": "__dirname",
          "kind": "variable",
          "signature": "any",
          "lines": [
            12,
            12
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_DATA_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            15,
            15
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default pi-brain data directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_DB_PATH",
          "kind": "variable",
          "signature": "any",
          "lines": [
            18,
            18
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default database path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DatabaseOptions",
          "kind": "interface",
          "signature": "DatabaseOptions",
          "lines": [
            20,
            34
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MigrationInfo",
          "kind": "interface",
          "signature": "MigrationInfo",
          "lines": [
            36,
            41
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "openDatabase",
          "kind": "function",
          "signature": "openDatabase(options: DatabaseOptions = {}): Database.Database",
          "lines": [
            46,
            84
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Open or create the pi-brain database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "loadMigrations",
          "kind": "function",
          "signature": "loadMigrations(): {}",
          "lines": [
            89,
            112
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Load migrations from the migrations directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSchemaVersion",
          "kind": "function",
          "signature": "getSchemaVersion(db: Database.Database): number",
          "lines": [
            117,
            127
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get current schema version",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getMigrationSkippedReason",
          "kind": "function",
          "signature": "getMigrationSkippedReason(db: Database.Database, version: number): string",
          "lines": [
            133,
            154
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a specific migration was skipped due to missing dependencies.\nReturns the requirement that caused it to be skipped, or null if not skipped.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseMigrationRequirements",
          "kind": "function",
          "signature": "parseMigrationRequirements(sql: string): {}",
          "lines": [
            161,
            170
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse a migration SQL file for REQUIRES directives.\nFormat: -- REQUIRES: requirement1, requirement2\nReturns array of requirements (e.g., ['sqlite-vec'])",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "checkMigrationRequirements",
          "kind": "function",
          "signature": "checkMigrationRequirements(db: Database.Database, requirements: string[]): string",
          "lines": [
            176,
            187
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if migration requirements are satisfied.\nReturns unsatisfied requirement, or null if all satisfied.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "migrate",
          "kind": "function",
          "signature": "migrate(db: Database.Database): number",
          "lines": [
            192,
            249
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Run pending migrations",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "closeDatabase",
          "kind": "function",
          "signature": "closeDatabase(db: Database.Database): void",
          "lines": [
            254,
            256
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Close the database connection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isDatabaseHealthy",
          "kind": "function",
          "signature": "isDatabaseHealthy(db: Database.Database): boolean",
          "lines": [
            261,
            268
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if the database is healthy",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "loadVecExtension",
          "kind": "function",
          "signature": "loadVecExtension(db: Database.Database): boolean",
          "lines": [
            273,
            281
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Load the sqlite-vec extension",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isVecLoaded",
          "kind": "function",
          "signature": "isVecLoaded(db: Database.Database): boolean",
          "lines": [
            286,
            297
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if sqlite-vec extension is loaded",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3",
        "node:fs",
        "node:os",
        "node:path",
        "node:url",
        "sqlite-vec"
      ]
    },
    {
      "path": "src/storage/decision-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        143
      ],
      "detail_level": "full",
      "token_estimate": 222,
      "symbols": [
        {
          "name": "ListDecisionsFilters",
          "kind": "interface",
          "signature": "ListDecisionsFilters",
          "lines": [
            10,
            19
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filters for querying daemon decisions",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListDecisionsOptions",
          "kind": "interface",
          "signature": "ListDecisionsOptions",
          "lines": [
            22,
            27
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Pagination options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonDecisionResult",
          "kind": "interface",
          "signature": "DaemonDecisionResult",
          "lines": [
            30,
            39
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A daemon decision result with metadata",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListDecisionsResult",
          "kind": "interface",
          "signature": "ListDecisionsResult",
          "lines": [
            42,
            51
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from listDecisions query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listDecisions",
          "kind": "function",
          "signature": "listDecisions(db: Database.Database, filters: ListDecisionsFilters = {}, options: ListDecisionsOptions = {}): ListDecisionsResult",
          "lines": [
            56,
            124
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List daemon decisions with filters and pagination.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateDecisionFeedback",
          "kind": "function",
          "signature": "updateDecisionFeedback(db: Database.Database, decisionId: string, feedback: string | null): boolean",
          "lines": [
            129,
            142
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Update user feedback for a daemon decision",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/edge-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        186
      ],
      "detail_level": "full",
      "token_estimate": 393,
      "symbols": [
        {
          "name": "EdgeRow",
          "kind": "interface",
          "signature": "EdgeRow",
          "lines": [
            19,
            27
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Edge row from the database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateEdgeId",
          "kind": "function",
          "signature": "generateEdgeId(): string",
          "lines": [
            36,
            38
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate a unique edge ID with 'edg_' prefix",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createEdge",
          "kind": "function",
          "signature": "createEdge(db: Database.Database, sourceNodeId: string, targetNodeId: string, type: EdgeType, options: {\n    metadata?: EdgeMetadata;\n    createdBy?: \"boundary\" | \"daemon\" | \"user\";\n  } = {}): Edge",
          "lines": [
            47,
            83
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create an edge between two nodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEdgesFrom",
          "kind": "function",
          "signature": "getEdgesFrom(db: Database.Database, nodeId: string): {}",
          "lines": [
            88,
            95
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get edges from a node (outgoing)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEdgesTo",
          "kind": "function",
          "signature": "getEdgesTo(db: Database.Database, nodeId: string): {}",
          "lines": [
            100,
            107
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get edges to a node (incoming)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeEdges",
          "kind": "function",
          "signature": "getNodeEdges(db: Database.Database, nodeId: string): {}",
          "lines": [
            112,
            119
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all edges for a node (both directions)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllEdges",
          "kind": "function",
          "signature": "getAllEdges(db: Database.Database): {}",
          "lines": [
            124,
            127
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all edges",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEdge",
          "kind": "function",
          "signature": "getEdge(db: Database.Database, edgeId: string): EdgeRow",
          "lines": [
            132,
            135
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get edge by ID",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "deleteEdge",
          "kind": "function",
          "signature": "deleteEdge(db: Database.Database, edgeId: string): boolean",
          "lines": [
            140,
            143
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Delete an edge",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "edgeExists",
          "kind": "function",
          "signature": "edgeExists(db: Database.Database, sourceNodeId: string, targetNodeId: string, type?: EdgeType): boolean",
          "lines": [
            148,
            166
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if an edge exists between two nodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "edgeRowToEdge",
          "kind": "function",
          "signature": "edgeRowToEdge(row: EdgeRow): Edge",
          "lines": [
            175,
            185
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Convert an Edge row from the database to an Edge object",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./node-types.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/embedding-utils.ts",
      "language": "typescript",
      "lines": [
        1,
        625
      ],
      "detail_level": "full",
      "token_estimate": 1306,
      "symbols": [
        {
          "name": "EMBEDDING_FORMAT_VERSION",
          "kind": "variable",
          "signature": "\"[emb:v2]\"",
          "lines": [
            19,
            19
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format version marker appended to rich embedding text.\nUsed to distinguish new-format embeddings (even with empty decisions/lessons)\nfrom old simple-format embeddings.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildEmbeddingText",
          "kind": "function",
          "signature": "buildEmbeddingText(node: Node): string",
          "lines": [
            43,
            83
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build embedding text from a node for semantic search.\n\nFormat:\n```\n[{type}] {summary}\n\nDecisions:\n- {decision.what} (why: {decision.why})\n- ...\n\nLessons:\n- {lesson.summary}\n- ...\n```\n\nThis richer format enables semantic search to find nodes by:\n- What type of work was done\n- What was accomplished (summary)\n- What decisions were made and why\n- What lessons were learned",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildSimpleEmbeddingText",
          "kind": "function",
          "signature": "buildSimpleEmbeddingText(type: string | null, summary: string | null): string",
          "lines": [
            97,
            109
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build simple embedding text from node summary data.\n\nThis is a lightweight version for use with partial node data\n(e.g., NodeSummaryRow from database queries).\n\nReturns:\n- `[type] summary` when both are present\n- `summary` when only summary is present\n- `[type]` when only type is present (sparse but valid for type-only filtering)\n- `` (empty string) when both are null",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isRichEmbeddingFormat",
          "kind": "function",
          "signature": "isRichEmbeddingFormat(inputText: string): boolean",
          "lines": [
            119,
            121
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if embedding text uses the rich format (includes decisions/lessons).\n\nUsed to detect nodes with old-format embeddings that need re-embedding.\n\nDetection relies on the version marker [emb:v2]. This avoids strict\ndependencies on whitespace or formatting of the sections.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "storeEmbeddingWithVec",
          "kind": "function",
          "signature": "storeEmbeddingWithVec(db: Database.Database, nodeId: string, embedding: number[], modelName: string, inputText: string): { rowid: bigint; vecUpdated: boolean; }",
          "lines": [
            135,
            205
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Store an embedding for a node in both node_embeddings and node_embeddings_vec tables.\n\nHandles upsert semantics - if an embedding already exists for the node, it will be\nreplaced. The vec table is only updated if sqlite-vec is loaded.\n\nUses a transaction to ensure atomicity - either both tables are updated or neither.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "deleteEmbedding",
          "kind": "function",
          "signature": "deleteEmbedding(db: Database.Database, nodeId: string): boolean",
          "lines": [
            210,
            237
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Delete an embedding from both node_embeddings and node_embeddings_vec tables.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getEmbedding",
          "kind": "function",
          "signature": "getEmbedding(db: Database.Database, nodeId: string): { embedding: {}; modelName: string; inputText: string; createdAt: string; }",
          "lines": [
            242,
            275
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get embedding for a node.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "hasEmbedding",
          "kind": "function",
          "signature": "hasEmbedding(db: Database.Database, nodeId: string): boolean",
          "lines": [
            280,
            285
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a node has an embedding stored.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "serializeEmbedding",
          "kind": "function",
          "signature": "serializeEmbedding(embedding: number[]): Buffer",
          "lines": [
            296,
            302
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Serialize an embedding array to a binary Buffer (Float32 little-endian).\n\nThis format is used for storing in the node_embeddings table.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "deserializeEmbedding",
          "kind": "function",
          "signature": "deserializeEmbedding(buffer: Buffer): {}",
          "lines": [
            309,
            315
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Deserialize a binary Buffer to an embedding array.\n\nInverse of serializeEmbedding.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BackfillEmbeddingProvider",
          "kind": "interface",
          "signature": "BackfillEmbeddingProvider",
          "lines": [
            325,
            329
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Embedding provider interface for backfill operations.\nMatches the EmbeddingProvider interface from facet-discovery.ts.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BackfillLogger",
          "kind": "interface",
          "signature": "BackfillLogger",
          "lines": [
            334,
            339
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Logger interface for backfill operations.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BackfillEmbeddingsOptions",
          "kind": "interface",
          "signature": "BackfillEmbeddingsOptions",
          "lines": [
            344,
            355
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for backfillEmbeddings function.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BackfillResult",
          "kind": "interface",
          "signature": "BackfillResult",
          "lines": [
            360,
            371
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of a backfill operation.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "noopLogger",
          "kind": "variable",
          "signature": "BackfillLogger",
          "lines": [
            379,
            384
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default no-op logger for backfill",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeNeedingEmbeddingRow",
          "kind": "interface",
          "signature": "NodeNeedingEmbeddingRow",
          "lines": [
            390,
            393
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Row type for nodes query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findNodesNeedingEmbedding",
          "kind": "function",
          "signature": "findNodesNeedingEmbedding(db: Database.Database, provider: BackfillEmbeddingProvider, options: { limit?: number; force?: boolean } = {}): {}",
          "lines": [
            403,
            443
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find nodes that need embedding generation or update.\n\nA node needs embedding if:\n1. No embedding exists for it\n2. Embedding uses a different model than the current provider\n3. Embedding uses old format (not rich format with decisions/lessons)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "backfillEmbeddings",
          "kind": "function",
          "signature": "async backfillEmbeddings(db: Database.Database, provider: BackfillEmbeddingProvider, readNodeFromPath: (dataFile: string) => Node, options: BackfillEmbeddingsOptions = {}): Promise<BackfillResult>",
          "lines": [
            459,
            585
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Backfill embeddings for nodes that are missing or have outdated embeddings.\n\nThis function:\n1. Finds nodes needing embedding (missing, wrong model, or old format)\n2. Loads full node data from JSON files\n3. Builds rich embedding text (summary + decisions + lessons)\n4. Generates embeddings in batches via the provider\n5. Stores in both node_embeddings table and node_embeddings_vec (if available)\n\nErrors are handled gracefully:\n- Individual node failures don't stop the batch\n- Returns statistics including failed node IDs for retry",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countNodesNeedingEmbedding",
          "kind": "function",
          "signature": "countNodesNeedingEmbedding(db: Database.Database, provider: BackfillEmbeddingProvider, options: { force?: boolean } = {}): { total: number; needsEmbedding: number; }",
          "lines": [
            592,
            624
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count nodes that need embedding backfill.\n\nUseful for showing progress or estimating work before running backfill.",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types/index.js",
        "./database.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/graph-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        366
      ],
      "detail_level": "full",
      "token_estimate": 566,
      "symbols": [
        {
          "name": "TraversalDirection",
          "kind": "type",
          "signature": "TraversalDirection = \"incoming\" | \"outgoing\" | \"both\"",
          "lines": [
            28,
            28
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Direction for graph traversal",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ConnectedNodesOptions",
          "kind": "interface",
          "signature": "ConnectedNodesOptions",
          "lines": [
            31,
            47
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for getConnectedNodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "TraversalEdge",
          "kind": "interface",
          "signature": "TraversalEdge",
          "lines": [
            50,
            65
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "An edge with direction information for traversal results",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ConnectedNodesResult",
          "kind": "interface",
          "signature": "ConnectedNodesResult",
          "lines": [
            68,
            75
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from getConnectedNodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getConnectedNodes",
          "kind": "function",
          "signature": "getConnectedNodes(db: Database.Database, nodeId: string, options: ConnectedNodesOptions = {}): ConnectedNodesResult",
          "lines": [
            110,
            215
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all nodes connected to a specific node with graph traversal.\n\nSupports:\n- Multi-hop traversal (depth 1-5)\n- Direction filtering (incoming, outgoing, both)\n- Edge type filtering\n\nBased on specs/storage.md graph traversal query and specs/api.md\nGET /api/v1/nodes/:id/connected endpoint.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSubgraph",
          "kind": "function",
          "signature": "getSubgraph(db: Database.Database, rootNodeIds: string[], options: ConnectedNodesOptions = {}): ConnectedNodesResult",
          "lines": [
            224,
            271
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the subgraph for visualization - returns nodes and edges\nwithin a given depth from multiple root nodes.\n\nUnlike getConnectedNodes, this INCLUDES the root nodes in the result,\nwhich is useful for rendering a graph view starting from selected nodes.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findPath",
          "kind": "function",
          "signature": "findPath(db: Database.Database, fromNodeId: string, toNodeId: string, options: { maxDepth?: number } = {}): { nodeIds: {}; edges: {}; }",
          "lines": [
            279,
            333
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the path between two nodes if one exists.\nUses BFS to find the shortest path.\n\nReturns null if no path exists.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAncestors",
          "kind": "function",
          "signature": "getAncestors(db: Database.Database, nodeId: string, options: { maxDepth?: number; edgeTypes?: EdgeType[] } = {}): ConnectedNodesResult",
          "lines": [
            339,
            349
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all ancestors of a node (nodes that lead TO this node).\nFollows incoming edges only.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDescendants",
          "kind": "function",
          "signature": "getDescendants(db: Database.Database, nodeId: string, options: { maxDepth?: number; edgeTypes?: EdgeType[] } = {}): ConnectedNodesResult",
          "lines": [
            355,
            365
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all descendants of a node (nodes that this node leads TO).\nFollows outgoing edges only.",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./edge-repository.js",
        "./node-crud.js",
        "./node-types.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/index.ts",
      "language": "typescript",
      "lines": [
        1,
        18
      ],
      "detail_level": "full",
      "token_estimate": 95,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./database.js",
        "./edge-repository.js",
        "./embedding-utils.js",
        "./graph-repository.js",
        "./lesson-repository.js",
        "./node-conversion.js",
        "./node-crud.js",
        "./node-queries.js",
        "./node-storage.js",
        "./node-types.js",
        "./quirk-repository.js",
        "./search-repository.js",
        "./tool-error-repository.js"
      ]
    },
    {
      "path": "src/storage/lesson-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        284
      ],
      "detail_level": "full",
      "token_estimate": 430,
      "symbols": [
        {
          "name": "ListLessonsFilters",
          "kind": "interface",
          "signature": "ListLessonsFilters",
          "lines": [
            16,
            25
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filters for querying lessons",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListLessonsOptions",
          "kind": "interface",
          "signature": "ListLessonsOptions",
          "lines": [
            28,
            33
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Pagination options for lessons",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListLessonsResult",
          "kind": "interface",
          "signature": "ListLessonsResult",
          "lines": [
            36,
            55
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from listLessons query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LessonsByLevelResult",
          "kind": "type",
          "signature": "LessonsByLevelResult = Record<\n  string,\n  {\n    count: number;\n    recent: {\n      id: string;\n      summary: string;\n      createdAt: string;\n    }[];\n  }\n>",
          "lines": [
            58,
            68
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from getLessonsByLevel",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listLessons",
          "kind": "function",
          "signature": "listLessons(db: Database.Database, filters: ListLessonsFilters = {}, options: ListLessonsOptions = {}): ListLessonsResult",
          "lines": [
            85,
            184
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List lessons with filters and pagination.\n\nSupports filtering by:\n- level (exact match)\n- project (partial match via nodes table)\n- tags (AND logic via lesson_tags table)\n- confidence (exact match)\n\nPer specs/api.md GET /api/v1/lessons endpoint.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLessonsByLevel",
          "kind": "function",
          "signature": "getLessonsByLevel(db: Database.Database, recentLimit = 5): Record<string, { count: number; recent: {}; }>",
          "lines": [
            192,
            232
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get aggregated lesson stats by level.\nReturns counts and most recent lessons for each level.\n\nPer specs/api.md GET /api/v1/lessons/by-level endpoint.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countLessons",
          "kind": "function",
          "signature": "countLessons(db: Database.Database, filters: ListLessonsFilters = {}): number",
          "lines": [
            237,
            243
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count lessons matching filters (without fetching data)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeLessons",
          "kind": "function",
          "signature": "getNodeLessons(db: Database.Database, nodeId: string): {}",
          "lines": [
            248,
            271
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get lessons for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLessonTags",
          "kind": "function",
          "signature": "getLessonTags(db: Database.Database, lessonId: string): {}",
          "lines": [
            276,
            283
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get tags for a specific lesson",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/node-conversion.ts",
      "language": "typescript",
      "lines": [
        1,
        343
      ],
      "detail_level": "full",
      "token_estimate": 240,
      "symbols": [
        {
          "name": "NodeConversionContext",
          "kind": "interface",
          "signature": "NodeConversionContext",
          "lines": [
            25,
            44
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Context needed to convert AgentNodeOutput to a full Node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "agentOutputToNode",
          "kind": "function",
          "signature": "agentOutputToNode(output: AgentNodeOutput, context: NodeConversionContext): Node",
          "lines": [
            54,
            261
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Convert AgentNodeOutput from the analyzer to a full Node structure\nFills in source, metadata, and identity fields from the job context",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodeRowToNode",
          "kind": "function",
          "signature": "nodeRowToNode(row: NodeRow, loadFull = false): Node",
          "lines": [
            268,
            335
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Transform a NodeRow (flat SQLite row) to Node (nested structure).\nFor listings, constructs Node from row data without reading JSON.\nFor full details, reads the JSON file.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodeRowsToNodes",
          "kind": "function",
          "signature": "nodeRowsToNodes(rows: NodeRow[], loadFull = false): {}",
          "lines": [
            340,
            342
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Transform array of NodeRows to Nodes",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../daemon/processor.js",
        "../daemon/queue.js",
        "./node-crud.js",
        "./node-storage.js",
        "./node-types.js"
      ]
    },
    {
      "path": "src/storage/node-crud.ts",
      "language": "typescript",
      "lines": [
        1,
        751
      ],
      "detail_level": "full",
      "token_estimate": 1246,
      "symbols": [
        {
          "name": "RepositoryOptions",
          "kind": "interface",
          "signature": "RepositoryOptions extends NodeStorageOptions",
          "lines": [
            39,
            42
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for node repository operations",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeRow",
          "kind": "interface",
          "signature": "NodeRow",
          "lines": [
            45,
            67
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Node row from the database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insertLessons",
          "kind": "function",
          "signature": "insertLessons(db: Database.Database, nodeId: string, lessonsByLevel: LessonsByLevel): void",
          "lines": [
            76,
            107
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Insert lessons for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insertModelQuirks",
          "kind": "function",
          "signature": "insertModelQuirks(db: Database.Database, nodeId: string, quirks: ModelQuirk[]): void",
          "lines": [
            112,
            132
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Insert model quirks for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insertToolErrors",
          "kind": "function",
          "signature": "insertToolErrors(db: Database.Database, nodeId: string, errors: ToolError[]): void",
          "lines": [
            137,
            157
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Insert tool errors for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insertDaemonDecisions",
          "kind": "function",
          "signature": "insertDaemonDecisions(db: Database.Database, nodeId: string, decisions: DaemonDecision[]): void",
          "lines": [
            162,
            181
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Insert daemon decisions for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "clearAllData",
          "kind": "function",
          "signature": "clearAllData(db: Database.Database): void",
          "lines": [
            191,
            220
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Clear all data from the database (nodes, edges, etc.)\nUsed by rebuild-index CLI",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "insertNodeToDb",
          "kind": "function",
          "signature": "insertNodeToDb(db: Database.Database, node: Node, dataFile: string, options: { skipFts?: boolean } = {}): void",
          "lines": [
            226,
            292
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Insert a node into the database (without writing JSON file)\nUsed by createNode and rebuild-index CLI",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createNode",
          "kind": "function",
          "signature": "createNode(db: Database.Database, node: Node, options: RepositoryOptions = {}): Node",
          "lines": [
            298,
            312
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a node - writes to both SQLite and JSON storage\nReturns the node with any auto-generated fields filled in",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "upsertNode",
          "kind": "function",
          "signature": "upsertNode(db: Database.Database, node: Node, options: RepositoryOptions = {}): { node: Node; created: boolean; }",
          "lines": [
            323,
            430
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Upsert a node - creates if not exists, updates if exists.\nThis provides idempotent ingestion for analysis jobs.\n\nIf a job crashes after writing JSON but before DB insert, re-running\nwill update the existing data cleanly without duplicates or errors.\n\nReturns the node and whether it was created (true) or updated (false).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateNode",
          "kind": "function",
          "signature": "updateNode(db: Database.Database, node: Node, options: RepositoryOptions = {}): Node",
          "lines": [
            437,
            527
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Update a node - writes new JSON version and updates SQLite row.\nThrows if the node doesn't exist in the database.\nReturns the updated node.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNode",
          "kind": "function",
          "signature": "getNode(db: Database.Database, nodeId: string): NodeRow",
          "lines": [
            532,
            538
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get a node by ID (returns the row from SQLite - always the latest version)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeVersion",
          "kind": "function",
          "signature": "getNodeVersion(db: Database.Database, nodeId: string, version: number): NodeRow",
          "lines": [
            545,
            555
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get a specific version of a node from SQLite.\nNote: SQLite only stores the current/latest version. For historical versions,\nuse getAllNodeVersions() which reads from JSON storage.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodeExistsInDb",
          "kind": "function",
          "signature": "nodeExistsInDb(db: Database.Database, nodeId: string): boolean",
          "lines": [
            560,
            563
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a node exists in the database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllNodeVersions",
          "kind": "function",
          "signature": "getAllNodeVersions(nodeId: string, options: RepositoryOptions = {}): {}",
          "lines": [
            568,
            574
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all versions of a node from JSON storage",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "deleteNode",
          "kind": "function",
          "signature": "deleteNode(db: Database.Database, nodeId: string): boolean",
          "lines": [
            580,
            586
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Delete a node and all related data\nNote: Due to ON DELETE CASCADE, related records are automatically deleted",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findNodeByEndEntryId",
          "kind": "function",
          "signature": "findNodeByEndEntryId(db: Database.Database, sessionFile: string, entryId: string): NodeRow",
          "lines": [
            591,
            603
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find a node that contains a specific entry ID as its end boundary",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findLastNodeInSession",
          "kind": "function",
          "signature": "findLastNodeInSession(db: Database.Database, sessionFile: string): NodeRow",
          "lines": [
            608,
            619
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find the latest node for a given session file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findFirstNodeInSession",
          "kind": "function",
          "signature": "findFirstNodeInSession(db: Database.Database, sessionFile: string): NodeRow",
          "lines": [
            624,
            635
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find the first node for a given session file",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findPreviousProjectNode",
          "kind": "function",
          "signature": "findPreviousProjectNode(db: Database.Database, project: string, beforeTimestamp: string): any",
          "lines": [
            644,
            669
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find the most recent node for a project before a given timestamp.\nUsed for abandoned restart detection.\n\nReturns the full Node from JSON storage (not just the row) to access\nfilesTouched and other content fields.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "STRUCTURAL_EDGE_TYPES",
          "kind": "variable",
          "signature": "any",
          "lines": [
            672,
            679
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Valid structural edge types for boundary detection",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "normalizeEdgeType",
          "kind": "function",
          "signature": "normalizeEdgeType(boundaryType: string | undefined): EdgeType",
          "lines": [
            684,
            689
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Validate and normalize a boundary type to a valid EdgeType",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "linkNodeToPredecessors",
          "kind": "function",
          "signature": "linkNodeToPredecessors(db: Database.Database, node: Node, context: {\n    boundaryType?: string;\n  } = {}): {}",
          "lines": [
            696,
            734
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Automatically link a node to its predecessors based on session structure.\nCreates structural edges based on session continuity and fork relationships.\nIdempotent: will not create duplicate edges if called multiple times.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "edgeExistsInSameSession",
          "kind": "function",
          "signature": "edgeExistsInSameSession(db: Database.Database, nodeId: string): boolean",
          "lines": [
            739,
            750
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a node has any incoming edges from the same session",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./edge-repository.js",
        "./node-storage.js",
        "./node-types.js",
        "./search-repository.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/node-queries.ts",
      "language": "typescript",
      "lines": [
        1,
        455
      ],
      "detail_level": "full",
      "token_estimate": 869,
      "symbols": [
        {
          "name": "getNodeSummary",
          "kind": "function",
          "signature": "getNodeSummary(db: Database.Database, nodeId: string): string",
          "lines": [
            21,
            28
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get node summary from FTS index",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeTags",
          "kind": "function",
          "signature": "getNodeTags(db: Database.Database, nodeId: string): {}",
          "lines": [
            33,
            37
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get tags for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeTopics",
          "kind": "function",
          "signature": "getNodeTopics(db: Database.Database, nodeId: string): {}",
          "lines": [
            42,
            46
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get topics for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllTags",
          "kind": "function",
          "signature": "getAllTags(db: Database.Database): {}",
          "lines": [
            51,
            61
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique tags in the system",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllTopics",
          "kind": "function",
          "signature": "getAllTopics(db: Database.Database): {}",
          "lines": [
            66,
            70
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique topics in the system",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodesByTag",
          "kind": "function",
          "signature": "getNodesByTag(db: Database.Database, tag: string): {}",
          "lines": [
            75,
            85
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find nodes by tag (matches both node tags and lesson tags)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodesByTopic",
          "kind": "function",
          "signature": "getNodesByTopic(db: Database.Database, topic: string): {}",
          "lines": [
            90,
            101
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find nodes by topic",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeSortField",
          "kind": "type",
          "signature": "NodeSortField = | \"timestamp\"\n  | \"analyzed_at\"\n  | \"project\"\n  | \"type\"\n  | \"outcome\"\n  | \"tokens_used\"\n  | \"cost\"\n  | \"duration_minutes\"",
          "lines": [
            108,
            116
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Valid sort fields for listNodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SortOrder",
          "kind": "type",
          "signature": "SortOrder = \"asc\" | \"desc\"",
          "lines": [
            119,
            119
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Sort order",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeTypeFilter",
          "kind": "type",
          "signature": "NodeTypeFilter = | \"coding\"\n  | \"sysadmin\"\n  | \"research\"\n  | \"planning\"\n  | \"debugging\"\n  | \"qa\"\n  | \"brainstorm\"\n  | \"handoff\"\n  | \"refactor\"\n  | \"documentation\"\n  | \"configuration\"\n  | \"other\"",
          "lines": [
            122,
            134
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Node type filter values",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "OutcomeFilter",
          "kind": "type",
          "signature": "OutcomeFilter = \"success\" | \"partial\" | \"failed\" | \"abandoned\"",
          "lines": [
            137,
            137
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Outcome filter values",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListNodesFilters",
          "kind": "interface",
          "signature": "ListNodesFilters",
          "lines": [
            140,
            165
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filters for querying nodes",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListNodesOptions",
          "kind": "interface",
          "signature": "ListNodesOptions",
          "lines": [
            168,
            177
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Pagination and sorting options",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListNodesResult",
          "kind": "interface",
          "signature": "ListNodesResult",
          "lines": [
            180,
            189
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from listNodes query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ALLOWED_SORT_FIELDS",
          "kind": "variable",
          "signature": "any",
          "lines": [
            192,
            201
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Allowed sort fields (validated against SQL injection)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listNodes",
          "kind": "function",
          "signature": "listNodes(db: Database.Database, filters: ListNodesFilters = {}, options: ListNodesOptions = {}): ListNodesResult",
          "lines": [
            219,
            344
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List nodes with filters, pagination, and sorting.\n\nSupports filtering by:\n- project (partial match via LIKE)\n- type (exact match)\n- outcome (exact match)\n- date range (from/to on timestamp field)\n- computer (exact match)\n- hadClearGoal (boolean)\n- isNewProject (boolean)\n- tags (AND logic - nodes must have ALL specified tags)\n- topics (AND logic - nodes must have ALL specified topics)\n\nPer specs/api.md GET /api/v1/nodes endpoint.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionSummaryRow",
          "kind": "interface",
          "signature": "SessionSummaryRow",
          "lines": [
            353,
            365
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Session summary row from aggregation query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSessionSummaries",
          "kind": "function",
          "signature": "getSessionSummaries(db: Database.Database, project: string, options: { limit?: number; offset?: number } = {}): {}",
          "lines": [
            371,
            400
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get aggregated session summaries for a project.\nUsed for the session browser to avoid loading thousands of nodes.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllProjects",
          "kind": "function",
          "signature": "getAllProjects(db: Database.Database): {}",
          "lines": [
            409,
            417
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique projects in the system",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllNodeTypes",
          "kind": "function",
          "signature": "getAllNodeTypes(db: Database.Database): {}",
          "lines": [
            422,
            430
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique node types that have been used",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllComputers",
          "kind": "function",
          "signature": "getAllComputers(db: Database.Database): {}",
          "lines": [
            435,
            443
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique computers (source machines)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countNodes",
          "kind": "function",
          "signature": "countNodes(db: Database.Database, filters: ListNodesFilters = {}): number",
          "lines": [
            448,
            454
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count nodes matching filters (without fetching data)",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./node-crud.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/node-storage.ts",
      "language": "typescript",
      "lines": [
        1,
        292
      ],
      "detail_level": "full",
      "token_estimate": 598,
      "symbols": [
        {
          "name": "DEFAULT_NODES_DIR",
          "kind": "variable",
          "signature": "any",
          "lines": [
            22,
            22
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default nodes directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeStorageOptions",
          "kind": "interface",
          "signature": "NodeStorageOptions",
          "lines": [
            24,
            27
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeDir",
          "kind": "function",
          "signature": "getNodeDir(timestamp: string, nodesDir = DEFAULT_NODES_DIR): string",
          "lines": [
            33,
            41
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the directory path for a node based on its timestamp\nReturns: nodesDir/YYYY/MM",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodePath",
          "kind": "function",
          "signature": "getNodePath(nodeId: string, version: number, timestamp: string, nodesDir = DEFAULT_NODES_DIR): string",
          "lines": [
            47,
            55
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the full file path for a node\nReturns: nodesDir/YYYY/MM/<nodeId>-v<version>.json",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "writeNode",
          "kind": "function",
          "signature": "writeNode(node: Node, options: NodeStorageOptions = {}): string",
          "lines": [
            60,
            82
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Write a node to JSON file storage",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "readNode",
          "kind": "function",
          "signature": "readNode(nodeId: string, version: number, timestamp: string, options: NodeStorageOptions = {}): Node",
          "lines": [
            87,
            102
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Read a node from JSON file storage",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "readNodeFromPath",
          "kind": "function",
          "signature": "readNodeFromPath(filePath: string): Node",
          "lines": [
            107,
            114
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Read a node by file path",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodeExists",
          "kind": "function",
          "signature": "nodeExists(nodeId: string, version: number, timestamp: string, options: NodeStorageOptions = {}): boolean",
          "lines": [
            119,
            128
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if a node file exists",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listNodeFiles",
          "kind": "function",
          "signature": "listNodeFiles(options: NodeStorageOptions = {}): {}",
          "lines": [
            134,
            175
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List all node files in the storage directory\nReturns array of file paths",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listNodeVersions",
          "kind": "function",
          "signature": "listNodeVersions(nodeId: string, options: NodeStorageOptions = {}): {}",
          "lines": [
            181,
            202
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List all versions of a specific node\nReturns array of { version, path } sorted by version ascending",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLatestNodeVersion",
          "kind": "function",
          "signature": "getLatestNodeVersion(nodeId: string, options: NodeStorageOptions = {}): { version: number; path: string; }",
          "lines": [
            207,
            217
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the latest version of a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "readLatestNode",
          "kind": "function",
          "signature": "readLatestNode(nodeId: string, options: NodeStorageOptions = {}): any",
          "lines": [
            222,
            231
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Read the latest version of a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseNodePath",
          "kind": "function",
          "signature": "parseNodePath(filePath: string): { nodeId: string; version: number; year: string; month: string; }",
          "lines": [
            236,
            261
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse a node file path to extract node ID, version, year, and month",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createNodeVersion",
          "kind": "function",
          "signature": "createNodeVersion(existingNode: Node, updates: Partial<Node>, options: NodeStorageOptions = {}): Node",
          "lines": [
            267,
            291
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a new version of an existing node\nCopies the node with incremented version and updated previousVersions",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./node-types.js",
        "node:fs",
        "node:os",
        "node:path"
      ]
    },
    {
      "path": "src/storage/node-types.ts",
      "language": "typescript",
      "lines": [
        1,
        129
      ],
      "detail_level": "full",
      "token_estimate": 406,
      "symbols": [
        {
          "name": "generateNodeId",
          "kind": "function",
          "signature": "generateNodeId(): string",
          "lines": [
            25,
            27
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate a unique 16-character hex node ID\nUses first 16 chars of UUID (64 bits of entropy)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateLessonId",
          "kind": "function",
          "signature": "generateLessonId(): string",
          "lines": [
            29,
            31
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateQuirkId",
          "kind": "function",
          "signature": "generateQuirkId(): string",
          "lines": [
            33,
            35
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateErrorId",
          "kind": "function",
          "signature": "generateErrorId(): string",
          "lines": [
            37,
            39
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateDecisionId",
          "kind": "function",
          "signature": "generateDecisionId(): string",
          "lines": [
            41,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateDeterministicNodeId",
          "kind": "function",
          "signature": "generateDeterministicNodeId(sessionFile: string, segmentStart: string, segmentEnd: string): string",
          "lines": [
            59,
            69
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate a deterministic 16-character hex node ID based on session and segment.\nThis ensures idempotent ingestion - re-running the same job produces the same ID.\n\nThe ID is derived from:\n- Session file path\n- Segment start entry ID\n- Segment end entry ID\n\nUses length-prefix encoding to prevent collisions from inputs containing\ndelimiter characters (e.g., \"a:b\" + \"c\" vs \"a\" + \"b:c\").\n\nTwo jobs with the same inputs will always produce the same node ID.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodeRef",
          "kind": "function",
          "signature": "nodeRef(nodeId: string, version: number): string",
          "lines": [
            74,
            76
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a full node reference with version",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseNodeRef",
          "kind": "function",
          "signature": "parseNodeRef(ref: string): { nodeId: string; version: number; }",
          "lines": [
            81,
            90
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse a node reference into id and version",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "emptyLessons",
          "kind": "function",
          "signature": "emptyLessons(): LessonsByLevel",
          "lines": [
            95,
            105
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create an empty lessons structure",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "emptyObservations",
          "kind": "function",
          "signature": "emptyObservations(): ModelObservations",
          "lines": [
            110,
            118
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create an empty observations structure",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "emptyDaemonMeta",
          "kind": "function",
          "signature": "emptyDaemonMeta(): DaemonMeta",
          "lines": [
            123,
            128
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create an empty daemon meta structure",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types/index.js",
        "node:crypto"
      ]
    },
    {
      "path": "src/storage/pattern-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        369
      ],
      "detail_level": "full",
      "token_estimate": 356,
      "symbols": [
        {
          "name": "FailurePatternRow",
          "kind": "interface",
          "signature": "FailurePatternRow",
          "lines": [
            17,
            27
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelStatsRow",
          "kind": "interface",
          "signature": "ModelStatsRow",
          "lines": [
            29,
            38
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LessonPatternRow",
          "kind": "interface",
          "signature": "LessonPatternRow",
          "lines": [
            40,
            49
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InsightRow",
          "kind": "interface",
          "signature": "InsightRow",
          "lines": [
            51,
            68
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListFailurePatternsOptions",
          "kind": "interface",
          "signature": "ListFailurePatternsOptions",
          "lines": [
            74,
            78
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listFailurePatterns",
          "kind": "function",
          "signature": "listFailurePatterns(db: Database.Database, options: ListFailurePatternsOptions = {}): {}",
          "lines": [
            80,
            111
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listModelStats",
          "kind": "function",
          "signature": "listModelStats(db: Database.Database): {}",
          "lines": [
            117,
            136
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListLessonPatternsOptions",
          "kind": "interface",
          "signature": "ListLessonPatternsOptions",
          "lines": [
            142,
            146
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listLessonPatterns",
          "kind": "function",
          "signature": "listLessonPatterns(db: Database.Database, options: ListLessonPatternsOptions = {}): {}",
          "lines": [
            148,
            182
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListInsightsOptions",
          "kind": "interface",
          "signature": "ListInsightsOptions",
          "lines": [
            188,
            197
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listInsights",
          "kind": "function",
          "signature": "listInsights(db: Database.Database, options: ListInsightsOptions = {}): {}",
          "lines": [
            199,
            252
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getInsight",
          "kind": "function",
          "signature": "getInsight(db: Database.Database, id: string): any",
          "lines": [
            254,
            268
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getInsightsByModel",
          "kind": "function",
          "signature": "getInsightsByModel(db: Database.Database, model: string, options: { minConfidence?: number; promptIncludedOnly?: boolean } = {}): {}",
          "lines": [
            270,
            294
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countInsights",
          "kind": "function",
          "signature": "countInsights(db: Database.Database, options: { type?: InsightType; model?: string; promptIncluded?: boolean } = {}): number",
          "lines": [
            296,
            328
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "updateInsightPrompt",
          "kind": "function",
          "signature": "updateInsightPrompt(db: Database.Database, id: string, promptText: string, promptIncluded: boolean, promptVersion?: string): void",
          "lines": [
            330,
            347
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "rowToInsight",
          "kind": "function",
          "signature": "rowToInsight(row: InsightRow): AggregatedInsight",
          "lines": [
            349,
            368
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../types/index.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/quirk-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        315
      ],
      "detail_level": "full",
      "token_estimate": 615,
      "symbols": [
        {
          "name": "QuirkFrequency",
          "kind": "type",
          "signature": "QuirkFrequency = \"once\" | \"sometimes\" | \"often\" | \"always\"",
          "lines": [
            16,
            16
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Frequency values for model quirks",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QuirkSeverity",
          "kind": "type",
          "signature": "QuirkSeverity = \"low\" | \"medium\" | \"high\"",
          "lines": [
            19,
            19
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Severity values for model quirks (matches spec)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListQuirksFilters",
          "kind": "interface",
          "signature": "ListQuirksFilters",
          "lines": [
            22,
            31
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filters for querying model quirks",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListQuirksOptions",
          "kind": "interface",
          "signature": "ListQuirksOptions",
          "lines": [
            34,
            39
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Pagination options for quirks",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QuirkResult",
          "kind": "interface",
          "signature": "QuirkResult",
          "lines": [
            42,
            51
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A quirk result with metadata",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListQuirksResult",
          "kind": "interface",
          "signature": "ListQuirksResult",
          "lines": [
            54,
            63
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from listQuirks query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelQuirkStats",
          "kind": "interface",
          "signature": "ModelQuirkStats",
          "lines": [
            66,
            76
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Stats for a single model",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "QuirksByModelResult",
          "kind": "type",
          "signature": "QuirksByModelResult = Record<string, ModelQuirkStats>",
          "lines": [
            79,
            79
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from getQuirksByModel",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FREQUENCY_RANK",
          "kind": "variable",
          "signature": "Record<string, number>",
          "lines": [
            86,
            91
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Frequency ranking for filtering (higher = more frequent)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listQuirks",
          "kind": "function",
          "signature": "listQuirks(db: Database.Database, filters: ListQuirksFilters = {}, options: ListQuirksOptions = {}): ListQuirksResult",
          "lines": [
            107,
            167
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List model quirks with filters and pagination.\n\nSupports filtering by:\n- model (exact match)\n- frequency (minimum frequency ranking)\n- project (partial match via nodes table)\n\nPer specs/api.md GET /api/v1/quirks endpoint.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getQuirksByModel",
          "kind": "function",
          "signature": "getQuirksByModel(db: Database.Database, recentLimit = 5): Record<string, ModelQuirkStats>",
          "lines": [
            175,
            213
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get aggregated quirk stats by model.\nReturns counts and most recent quirks for each model that has quirks.\n\nPer specs/api.md GET /api/v1/stats/models endpoint (quirkCount field).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countQuirks",
          "kind": "function",
          "signature": "countQuirks(db: Database.Database, filters: ListQuirksFilters = {}): number",
          "lines": [
            218,
            224
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count quirks matching filters (without fetching data)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllQuirkModels",
          "kind": "function",
          "signature": "getAllQuirkModels(db: Database.Database): {}",
          "lines": [
            229,
            236
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique models that have quirks recorded",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAggregatedQuirks",
          "kind": "function",
          "signature": "getAggregatedQuirks(db: Database.Database, options: { minOccurrences?: number; limit?: number } = {}): {}",
          "lines": [
            244,
            286
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get aggregated quirks - similar observations grouped together.\nUseful for the dashboard \"Model Quirks\" panel.\n\nPer specs/storage.md \"Find model quirks by frequency\" query.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeQuirks",
          "kind": "function",
          "signature": "getNodeQuirks(db: Database.Database, nodeId: string): {}",
          "lines": [
            291,
            314
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get model quirks for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/search-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        549
      ],
      "detail_level": "full",
      "token_estimate": 634,
      "symbols": [
        {
          "name": "SearchField",
          "kind": "type",
          "signature": "SearchField = | \"summary\"\n  | \"decisions\"\n  | \"lessons\"\n  | \"tags\"\n  | \"topics\"",
          "lines": [
            19,
            24
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Fields that can be searched in the FTS index",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ALL_SEARCH_FIELDS",
          "kind": "variable",
          "signature": "SearchField[]",
          "lines": [
            27,
            33
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "All searchable fields",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SearchHighlight",
          "kind": "interface",
          "signature": "SearchHighlight",
          "lines": [
            36,
            41
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Highlight match for search results",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SearchResult",
          "kind": "interface",
          "signature": "SearchResult",
          "lines": [
            44,
            51
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Enhanced search result with score and highlights",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SearchFilters",
          "kind": "interface",
          "signature": "SearchFilters",
          "lines": [
            54,
            75
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filters for search queries (subset of node filters relevant to search)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SearchOptions",
          "kind": "interface",
          "signature": "SearchOptions",
          "lines": [
            78,
            87
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for enhanced search",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SearchNodesResult",
          "kind": "interface",
          "signature": "SearchNodesResult",
          "lines": [
            90,
            99
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from enhanced search with pagination metadata",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "indexNodeForSearch",
          "kind": "function",
          "signature": "indexNodeForSearch(db: Database.Database, node: Node): void",
          "lines": [
            108,
            136
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Index a node for full-text search",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "searchNodes",
          "kind": "function",
          "signature": "searchNodes(db: Database.Database, query: string, limit = 20): {}",
          "lines": [
            146,
            172
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Search nodes using full-text search\nQuotes the query to handle special characters like hyphens",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "quoteSearchQuery",
          "kind": "function",
          "signature": "quoteSearchQuery(query: string): string",
          "lines": [
            182,
            188
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Helper to quote query terms for FTS5 to handle special characters",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildFieldQuery",
          "kind": "function",
          "signature": "buildFieldQuery(query: string, fields: SearchField[]): string",
          "lines": [
            195,
            217
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build column filter for FTS5 search\nReturns column:term syntax for field-specific search",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "escapeRegExp",
          "kind": "variable",
          "signature": "(str: string): any",
          "lines": [
            219,
            220
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "extractSnippet",
          "kind": "function",
          "signature": "extractSnippet(text: string, query: string, maxLength = 100): string",
          "lines": [
            226,
            293
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Extract a highlight snippet from text containing a match",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findHighlights",
          "kind": "function",
          "signature": "findHighlights(db: Database.Database, nodeId: string, query: string, fields: SearchField[]): {}",
          "lines": [
            299,
            351
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find highlights for a search result by checking which fields match",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "buildFilterClause",
          "kind": "function",
          "signature": "buildFilterClause(filters: SearchFilters | undefined): { clause: string; params: {}; }",
          "lines": [
            361,
            432
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Build WHERE clause conditions and params from search filters",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "searchNodesAdvanced",
          "kind": "function",
          "signature": "searchNodesAdvanced(db: Database.Database, query: string, options: SearchOptions = {}): SearchNodesResult",
          "lines": [
            458,
            518
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Enhanced search with scores, highlights, and filter support",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countSearchResults",
          "kind": "function",
          "signature": "countSearchResults(db: Database.Database, query: string, options: Pick<SearchOptions, \"fields\" | \"filters\"> = {}): number",
          "lines": [
            523,
            548
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count total search results (without fetching data)",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./node-crud.js",
        "./node-types.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/semantic-search.ts",
      "language": "typescript",
      "lines": [
        1,
        212
      ],
      "detail_level": "full",
      "token_estimate": 253,
      "symbols": [
        {
          "name": "SemanticSearchResult",
          "kind": "interface",
          "signature": "SemanticSearchResult extends SearchResult",
          "lines": [
            25,
            28
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SemanticSearchOptions",
          "kind": "interface",
          "signature": "SemanticSearchOptions",
          "lines": [
            30,
            39
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "semanticSearch",
          "kind": "function",
          "signature": "semanticSearch(db: Database.Database, queryEmbedding: number[], options: SemanticSearchOptions = {}): {}",
          "lines": [
            55,
            154
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Perform semantic search using vector similarity.\n\nFinds nodes with embeddings close to the query embedding.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeEmbeddingVector",
          "kind": "function",
          "signature": "getNodeEmbeddingVector(db: Database.Database, nodeId: string): {}",
          "lines": [
            164,
            177
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get the embedding vector for a node from the database.\nUseful for finding \"related nodes\" (node-to-node similarity).",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "findSimilarNodes",
          "kind": "function",
          "signature": "findSimilarNodes(db: Database.Database, nodeId: string, options: SemanticSearchOptions = {}): {}",
          "lines": [
            187,
            211
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Find nodes similar to a given node.\nWraps semanticSearch using the node's own embedding.",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./database.js",
        "./embedding-utils.js",
        "./node-crud.js",
        "./search-repository.js",
        "better-sqlite3"
      ]
    },
    {
      "path": "src/storage/tool-error-repository.ts",
      "language": "typescript",
      "lines": [
        1,
        352
      ],
      "detail_level": "full",
      "token_estimate": 557,
      "symbols": [
        {
          "name": "ListToolErrorsFilters",
          "kind": "interface",
          "signature": "ListToolErrorsFilters",
          "lines": [
            16,
            25
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Filters for querying tool errors",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListToolErrorsOptions",
          "kind": "interface",
          "signature": "ListToolErrorsOptions",
          "lines": [
            28,
            33
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Pagination options for tool errors",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolErrorResult",
          "kind": "interface",
          "signature": "ToolErrorResult",
          "lines": [
            36,
            45
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A tool error result with metadata",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListToolErrorsResult",
          "kind": "interface",
          "signature": "ListToolErrorsResult",
          "lines": [
            48,
            57
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from listToolErrors query",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolStats",
          "kind": "interface",
          "signature": "ToolStats",
          "lines": [
            60,
            64
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Stats by tool from getToolErrorStats",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelErrorStats",
          "kind": "interface",
          "signature": "ModelErrorStats",
          "lines": [
            67,
            70
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Stats by model from getToolErrorStats",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolErrorTrends",
          "kind": "interface",
          "signature": "ToolErrorTrends",
          "lines": [
            73,
            77
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Trend data from getToolErrorStats",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolErrorStatsResult",
          "kind": "interface",
          "signature": "ToolErrorStatsResult",
          "lines": [
            80,
            84
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result from getToolErrorStats",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AggregatedToolError",
          "kind": "interface",
          "signature": "AggregatedToolError",
          "lines": [
            87,
            94
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Aggregated tool error result",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeToolError",
          "kind": "interface",
          "signature": "NodeToolError",
          "lines": [
            97,
            103
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A single tool error for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listToolErrors",
          "kind": "function",
          "signature": "listToolErrors(db: Database.Database, filters: ListToolErrorsFilters = {}, options: ListToolErrorsOptions = {}): ListToolErrorsResult",
          "lines": [
            112,
            170
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "List individual tool errors with filters and pagination.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAggregatedToolErrors",
          "kind": "function",
          "signature": "getAggregatedToolErrors(db: Database.Database, filters: ListToolErrorsFilters = {}, options: { limit?: number; offset?: number; groupByModel?: boolean } = {}): {}",
          "lines": [
            176,
            252
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get aggregated tool errors - grouped by tool and error type (and optionally model).\nPer specs/api.md GET /api/v1/tool-errors.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getToolErrorStats",
          "kind": "function",
          "signature": "getToolErrorStats(db: Database.Database): ToolErrorStatsResult",
          "lines": [
            258,
            312
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get tool error statistics for the dashboard.\nPer specs/api.md GET /api/v1/stats/tool-errors.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countToolErrors",
          "kind": "function",
          "signature": "countToolErrors(db: Database.Database, filters: ListToolErrorsFilters = {}): number",
          "lines": [
            317,
            323
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count tool errors matching filters.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getAllToolsWithErrors",
          "kind": "function",
          "signature": "getAllToolsWithErrors(db: Database.Database): {}",
          "lines": [
            328,
            335
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get all unique tools that have errors recorded",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getNodeToolErrors",
          "kind": "function",
          "signature": "getNodeToolErrors(db: Database.Database, nodeId: string): {}",
          "lines": [
            340,
            351
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get tool errors for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "better-sqlite3"
      ]
    },
    {
      "path": "src/sync/index.ts",
      "language": "typescript",
      "lines": [
        1,
        9
      ],
      "detail_level": "full",
      "token_estimate": 18,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./rsync.js",
        "./status.js"
      ]
    },
    {
      "path": "src/sync/rsync.ts",
      "language": "typescript",
      "lines": [
        1,
        353
      ],
      "detail_level": "full",
      "token_estimate": 484,
      "symbols": [
        {
          "name": "execFileAsync",
          "kind": "variable",
          "signature": "any",
          "lines": [
            15,
            15
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RsyncResult",
          "kind": "interface",
          "signature": "RsyncResult",
          "lines": [
            20,
            28
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of an rsync operation",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RsyncOptions",
          "kind": "interface",
          "signature": "RsyncOptions",
          "lines": [
            33,
            44
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Options for running rsync",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseRsyncStats",
          "kind": "function",
          "signature": "parseRsyncStats(output: string): { filesTransferred: number; bytesTransferred: number; }",
          "lines": [
            52,
            86
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse rsync stats output to get transfer details.\n\nLogs a warning if stats cannot be parsed from non-empty output,\nwhich may indicate an older rsync version with different output format.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createFailedResult",
          "kind": "function",
          "signature": "createFailedResult(spokeName: string, message: string, durationMs: number, error?: string): RsyncResult",
          "lines": [
            91,
            106
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Create a failed rsync result",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseRsyncError",
          "kind": "function",
          "signature": "parseRsyncError(stderr: string, source: string | undefined, code: number | null): string",
          "lines": [
            111,
            133
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse rsync error message to make it more user-friendly",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "runRsync",
          "kind": "function",
          "signature": "async runRsync(spoke: SpokeConfig, options: RsyncOptions = {}): Promise<RsyncResult>",
          "lines": [
            140,
            269
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Run rsync for a spoke with rsync sync method",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatBytes",
          "kind": "function",
          "signature": "formatBytes(bytes: number): string",
          "lines": [
            274,
            285
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format bytes to human-readable string",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isRsyncAvailable",
          "kind": "function",
          "signature": "async isRsyncAvailable(): Promise<boolean>",
          "lines": [
            293,
            301
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if rsync is available on the system\n\nUses `rsync --version` instead of `which` for cross-platform compatibility\n(works on Windows, Linux, macOS). Gracefully handles ENOENT.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "countSpokeSessionFiles",
          "kind": "function",
          "signature": "countSpokeSessionFiles(spokePath: string): number",
          "lines": [
            306,
            317
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Count session files in a spoke's sync directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "listSpokeSessions",
          "kind": "function",
          "signature": "listSpokeSessions(spokePath: string): {}",
          "lines": [
            322,
            336
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get list of session files from a spoke's sync directory",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getLastSyncTime",
          "kind": "function",
          "signature": "getLastSyncTime(spokePath: string): any",
          "lines": [
            341,
            352
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get last sync time for a spoke (based on directory modification time)",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/types.js",
        "node:child_process",
        "node:fs",
        "node:path",
        "node:util"
      ]
    },
    {
      "path": "src/sync/status.ts",
      "language": "typescript",
      "lines": [
        1,
        182
      ],
      "detail_level": "full",
      "token_estimate": 184,
      "symbols": [
        {
          "name": "SpokeStatus",
          "kind": "interface",
          "signature": "SpokeStatus",
          "lines": [
            21,
            31
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Status of a single spoke",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SyncStatus",
          "kind": "interface",
          "signature": "SyncStatus",
          "lines": [
            36,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Overall sync status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatTimeAgo",
          "kind": "function",
          "signature": "formatTimeAgo(date: Date): string",
          "lines": [
            48,
            67
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format relative time ago",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSpokeStatus",
          "kind": "function",
          "signature": "getSpokeStatus(spoke: SpokeConfig): SpokeStatus",
          "lines": [
            72,
            88
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get status for a single spoke",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getSyncStatus",
          "kind": "function",
          "signature": "async getSyncStatus(config: PiBrainConfig): Promise<SyncStatus>",
          "lines": [
            93,
            111
          ],
          "exported": true,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get overall sync status",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatSyncStatus",
          "kind": "function",
          "signature": "formatSyncStatus(status: SyncStatus): string",
          "lines": [
            116,
            181
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format sync status for display",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../config/types.js",
        "./rsync.js",
        "node:fs",
        "node:os"
      ]
    },
    {
      "path": "src/types.ts",
      "language": "typescript",
      "lines": [
        1,
        298
      ],
      "detail_level": "full",
      "token_estimate": 553,
      "symbols": [
        {
          "name": "SessionEntryBase",
          "kind": "interface",
          "signature": "SessionEntryBase",
          "lines": [
            10,
            15
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Type definitions for pi session data structures\nBased on pi-coding-agent's session format (version 3)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionHeader",
          "kind": "interface",
          "signature": "SessionHeader",
          "lines": [
            17,
            24
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionMessageEntry",
          "kind": "interface",
          "signature": "SessionMessageEntry extends SessionEntryBase",
          "lines": [
            26,
            29
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CompactionEntry",
          "kind": "interface",
          "signature": "CompactionEntry extends SessionEntryBase",
          "lines": [
            31,
            38
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CompactionDetails",
          "kind": "interface",
          "signature": "CompactionDetails",
          "lines": [
            40,
            43
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BranchSummaryEntry",
          "kind": "interface",
          "signature": "BranchSummaryEntry extends SessionEntryBase",
          "lines": [
            45,
            51
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BranchSummaryDetails",
          "kind": "interface",
          "signature": "BranchSummaryDetails",
          "lines": [
            53,
            56
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelChangeEntry",
          "kind": "interface",
          "signature": "ModelChangeEntry extends SessionEntryBase",
          "lines": [
            58,
            62
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ThinkingLevelChangeEntry",
          "kind": "interface",
          "signature": "ThinkingLevelChangeEntry extends SessionEntryBase",
          "lines": [
            64,
            67
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CustomEntry",
          "kind": "interface",
          "signature": "CustomEntry extends SessionEntryBase",
          "lines": [
            69,
            73
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CustomMessageEntry",
          "kind": "interface",
          "signature": "CustomMessageEntry extends SessionEntryBase",
          "lines": [
            75,
            81
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LabelEntry",
          "kind": "interface",
          "signature": "LabelEntry extends SessionEntryBase",
          "lines": [
            83,
            87
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionInfoEntry",
          "kind": "interface",
          "signature": "SessionInfoEntry extends SessionEntryBase",
          "lines": [
            89,
            92
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionEntry",
          "kind": "type",
          "signature": "SessionEntry = | SessionMessageEntry\n  | CompactionEntry\n  | BranchSummaryEntry\n  | ModelChangeEntry\n  | ThinkingLevelChangeEntry\n  | CustomEntry\n  | CustomMessageEntry\n  | LabelEntry\n  | SessionInfoEntry",
          "lines": [
            94,
            103
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "UserMessage",
          "kind": "interface",
          "signature": "UserMessage",
          "lines": [
            109,
            114
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AssistantMessage",
          "kind": "interface",
          "signature": "AssistantMessage",
          "lines": [
            116,
            124
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolResultMessage",
          "kind": "interface",
          "signature": "ToolResultMessage",
          "lines": [
            126,
            133
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AgentMessage",
          "kind": "type",
          "signature": "AgentMessage = UserMessage | AssistantMessage | ToolResultMessage",
          "lines": [
            135,
            135
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "TextContent",
          "kind": "interface",
          "signature": "TextContent",
          "lines": [
            137,
            140
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ThinkingContent",
          "kind": "interface",
          "signature": "ThinkingContent",
          "lines": [
            142,
            145
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolCallContent",
          "kind": "interface",
          "signature": "ToolCallContent",
          "lines": [
            147,
            152
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ImageContent",
          "kind": "interface",
          "signature": "ImageContent",
          "lines": [
            154,
            157
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ImageSource",
          "kind": "interface",
          "signature": "ImageSource",
          "lines": [
            159,
            164
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ContentBlock",
          "kind": "type",
          "signature": "ContentBlock = | TextContent\n  | ThinkingContent\n  | ToolCallContent\n  | ImageContent",
          "lines": [
            166,
            170
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Usage",
          "kind": "interface",
          "signature": "Usage",
          "lines": [
            172,
            184
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Attachment",
          "kind": "interface",
          "signature": "Attachment",
          "lines": [
            186,
            195
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionInfo",
          "kind": "interface",
          "signature": "SessionInfo",
          "lines": [
            201,
            218
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "TreeNode",
          "kind": "interface",
          "signature": "TreeNode",
          "lines": [
            220,
            233
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionStats",
          "kind": "interface",
          "signature": "SessionStats",
          "lines": [
            235,
            260
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ForkRelationship",
          "kind": "interface",
          "signature": "ForkRelationship",
          "lines": [
            262,
            271
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ProjectGroup",
          "kind": "interface",
          "signature": "ProjectGroup",
          "lines": [
            273,
            280
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "VisualizationData",
          "kind": "interface",
          "signature": "VisualizationData",
          "lines": [
            286,
            297
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/types/index.ts",
      "language": "typescript",
      "lines": [
        1,
        661
      ],
      "detail_level": "full",
      "token_estimate": 1060,
      "symbols": [
        {
          "name": "Node",
          "kind": "interface",
          "signature": "Node",
          "lines": [
            12,
            30
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Shared type definitions for pi-brain\n\nThis file contains pure type definitions (no runtime code) shared between\nthe daemon/storage backend and the web frontend.",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeSource",
          "kind": "interface",
          "signature": "NodeSource",
          "lines": [
            32,
            49
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeType",
          "kind": "type",
          "signature": "NodeType = | \"coding\"\n  | \"debugging\"\n  | \"refactoring\"\n  | \"sysadmin\"\n  | \"research\"\n  | \"planning\"\n  | \"qa\"\n  | \"brainstorm\"\n  | \"handoff\"\n  | \"documentation\"\n  | \"configuration\"\n  | \"data\"\n  | \"other\"",
          "lines": [
            51,
            64
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeClassification",
          "kind": "interface",
          "signature": "NodeClassification",
          "lines": [
            66,
            78
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Outcome",
          "kind": "type",
          "signature": "Outcome = \"success\" | \"partial\" | \"failed\" | \"abandoned\"",
          "lines": [
            80,
            80
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Decision",
          "kind": "interface",
          "signature": "Decision",
          "lines": [
            82,
            86
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ErrorSummary",
          "kind": "interface",
          "signature": "ErrorSummary",
          "lines": [
            88,
            92
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeContent",
          "kind": "interface",
          "signature": "NodeContent",
          "lines": [
            94,
            105
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LessonLevel",
          "kind": "type",
          "signature": "LessonLevel = | \"project\"\n  | \"task\"\n  | \"user\"\n  | \"model\"\n  | \"tool\"\n  | \"skill\"\n  | \"subagent\"",
          "lines": [
            111,
            118
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Confidence",
          "kind": "type",
          "signature": "Confidence = \"high\" | \"medium\" | \"low\"",
          "lines": [
            120,
            120
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Lesson",
          "kind": "interface",
          "signature": "Lesson",
          "lines": [
            122,
            133
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "LessonsByLevel",
          "kind": "interface",
          "signature": "LessonsByLevel",
          "lines": [
            135,
            143
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelUsage",
          "kind": "interface",
          "signature": "ModelUsage",
          "lines": [
            149,
            157
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Frequency",
          "kind": "type",
          "signature": "Frequency = \"once\" | \"sometimes\" | \"often\" | \"always\"",
          "lines": [
            159,
            159
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelQuirk",
          "kind": "interface",
          "signature": "ModelQuirk",
          "lines": [
            161,
            168
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolError",
          "kind": "interface",
          "signature": "ToolError",
          "lines": [
            170,
            176
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelObservations",
          "kind": "interface",
          "signature": "ModelObservations",
          "lines": [
            178,
            186
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeMetadata",
          "kind": "interface",
          "signature": "NodeMetadata",
          "lines": [
            192,
            205
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SemanticData",
          "kind": "interface",
          "signature": "SemanticData",
          "lines": [
            207,
            216
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonDecision",
          "kind": "interface",
          "signature": "DaemonDecision",
          "lines": [
            218,
            225
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonMeta",
          "kind": "interface",
          "signature": "DaemonMeta",
          "lines": [
            227,
            237
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EdgeType",
          "kind": "type",
          "signature": "EdgeType = | \"fork\"\n  | \"branch\"\n  | \"tree_jump\"\n  | \"resume\"\n  | \"compaction\"\n  | \"continuation\"\n  | \"handoff\"\n  // Semantic edges (daemon discovers)\n  | \"semantic\"\n  | \"reference\"\n  | \"lesson_application\"\n  | ...",
          "lines": [
            243,
            258
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EdgeCreator",
          "kind": "type",
          "signature": "EdgeCreator = \"boundary\" | \"daemon\" | \"user\"",
          "lines": [
            260,
            260
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EdgeMetadata",
          "kind": "interface",
          "signature": "EdgeMetadata",
          "lines": [
            262,
            275
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Edge",
          "kind": "interface",
          "signature": "Edge",
          "lines": [
            277,
            286
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "VersionTrigger",
          "kind": "type",
          "signature": "VersionTrigger = | \"initial\"\n  | \"prompt_update\"\n  | \"connection_found\"\n  | \"user_feedback\"\n  | \"schema_migration\"",
          "lines": [
            292,
            297
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeVersion",
          "kind": "interface",
          "signature": "NodeVersion",
          "lines": [
            299,
            306
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AggregatedFailurePattern",
          "kind": "interface",
          "signature": "AggregatedFailurePattern",
          "lines": [
            312,
            322
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AggregatedModelStats",
          "kind": "interface",
          "signature": "AggregatedModelStats",
          "lines": [
            324,
            333
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AggregatedLessonPattern",
          "kind": "interface",
          "signature": "AggregatedLessonPattern",
          "lines": [
            335,
            344
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InsightType",
          "kind": "type",
          "signature": "InsightType = \"quirk\" | \"win\" | \"failure\" | \"tool_error\" | \"lesson\"",
          "lines": [
            350,
            350
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "InsightSeverity",
          "kind": "type",
          "signature": "InsightSeverity = \"low\" | \"medium\" | \"high\"",
          "lines": [
            351,
            351
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AggregatedInsight",
          "kind": "interface",
          "signature": "AggregatedInsight",
          "lines": [
            353,
            380
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PromptAddition",
          "kind": "interface",
          "signature": "PromptAddition",
          "lines": [
            386,
            397
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DateRange",
          "kind": "interface",
          "signature": "DateRange",
          "lines": [
            406,
            411
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Date range for measuring effectiveness before/after prompt addition",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EffectivenessResult",
          "kind": "interface",
          "signature": "EffectivenessResult",
          "lines": [
            416,
            434
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of measuring prompt effectiveness for a single insight",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "PromptEffectiveness",
          "kind": "interface",
          "signature": "PromptEffectiveness",
          "lines": [
            439,
            475
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Full effectiveness measurement record stored in database",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ManualFlag",
          "kind": "interface",
          "signature": "ManualFlag",
          "lines": [
            484,
            491
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Manual flag recorded by user via /brain --flag command",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FrictionSignals",
          "kind": "interface",
          "signature": "FrictionSignals",
          "lines": [
            496,
            511
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Friction signals detected in a session segment",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DelightSignals",
          "kind": "interface",
          "signature": "DelightSignals",
          "lines": [
            516,
            525
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Delight signals detected in a session segment",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeSignals",
          "kind": "interface",
          "signature": "NodeSignals",
          "lines": [
            530,
            534
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Combined signals for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterStatus",
          "kind": "type",
          "signature": "ClusterStatus = \"pending\" | \"confirmed\" | \"dismissed\"",
          "lines": [
            543,
            543
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Cluster status for user feedback",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterSignalType",
          "kind": "type",
          "signature": "ClusterSignalType = \"friction\" | \"delight\" | null",
          "lines": [
            548,
            548
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Signal type a cluster relates to",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Cluster",
          "kind": "interface",
          "signature": "Cluster",
          "lines": [
            553,
            575
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "A discovered cluster from facet discovery",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterNode",
          "kind": "interface",
          "signature": "ClusterNode",
          "lines": [
            580,
            587
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Node membership in a cluster",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeEmbedding",
          "kind": "interface",
          "signature": "NodeEmbedding",
          "lines": [
            592,
            602
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Cached embedding for a node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusteringRun",
          "kind": "interface",
          "signature": "ClusteringRun",
          "lines": [
            607,
            620
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Record of a clustering run",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "EmbeddingConfig",
          "kind": "interface",
          "signature": "EmbeddingConfig",
          "lines": [
            625,
            636
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Configuration for the embedding provider",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusteringConfig",
          "kind": "interface",
          "signature": "ClusteringConfig",
          "lines": [
            641,
            652
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Configuration for clustering algorithm",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FacetDiscoveryResult",
          "kind": "interface",
          "signature": "FacetDiscoveryResult",
          "lines": [
            657,
            660
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Result of facet discovery pipeline",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/web/app/src/app.d.ts",
      "language": "typescript",
      "lines": [
        1,
        12
      ],
      "detail_level": "full",
      "token_estimate": 8,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/web/app/src/lib/api/client.ts",
      "language": "typescript",
      "lines": [
        1,
        724
      ],
      "detail_level": "full",
      "token_estimate": 345,
      "symbols": [
        {
          "name": "getDefaultBaseUrl",
          "kind": "function",
          "signature": "getDefaultBaseUrl(): string",
          "lines": [
            32,
            43
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_BASE_URL",
          "kind": "variable",
          "signature": "string",
          "lines": [
            45,
            45
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DEFAULT_TIMEOUT_MS",
          "kind": "variable",
          "signature": "30000",
          "lines": [
            46,
            46
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ApiResponse",
          "kind": "interface",
          "signature": "ApiResponse<T>",
          "lines": [
            48,
            60
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ApiErrorOptions",
          "kind": "interface",
          "signature": "ApiErrorOptions",
          "lines": [
            62,
            66
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createApiError",
          "kind": "function",
          "signature": "createApiError(options: ApiErrorOptions): Error",
          "lines": [
            68,
            77
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createTimeoutError",
          "kind": "function",
          "signature": "createTimeoutError(timeoutMs: number): Error",
          "lines": [
            79,
            83
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createNetworkError",
          "kind": "function",
          "signature": "createNetworkError(message: string): Error",
          "lines": [
            85,
            89
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createContentTypeError",
          "kind": "function",
          "signature": "createContentTypeError(status: number, contentType: string): Error",
          "lines": [
            91,
            100
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isApiError",
          "kind": "function",
          "signature": "isApiError(error: unknown): boolean",
          "lines": [
            102,
            106
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isTimeoutError",
          "kind": "function",
          "signature": "isTimeoutError(error: unknown): boolean",
          "lines": [
            108,
            110
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isNetworkError",
          "kind": "function",
          "signature": "isNetworkError(error: unknown): boolean",
          "lines": [
            112,
            114
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isContentTypeError",
          "kind": "function",
          "signature": "isContentTypeError(error: unknown): boolean",
          "lines": [
            116,
            120
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "isBackendOffline",
          "kind": "function",
          "signature": "isBackendOffline(error: unknown): boolean",
          "lines": [
            126,
            130
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Check if an error indicates the backend is unreachable\n(network error, timeout, or non-JSON response like 404 HTML page)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getErrorMessage",
          "kind": "function",
          "signature": "getErrorMessage(error: unknown): string",
          "lines": [
            135,
            152
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Get a user-friendly message for API errors",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "toQueryString",
          "kind": "function",
          "signature": "toQueryString(params: Record<string, unknown>): string",
          "lines": [
            154,
            171
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "request",
          "kind": "function",
          "signature": "async request<T>(endpoint: string, options: RequestInit = {}, baseUrl: string = DEFAULT_BASE_URL, timeoutMs: number = DEFAULT_TIMEOUT_MS): Promise<T>",
          "lines": [
            173,
            221
          ],
          "exported": false,
          "is_default": false,
          "is_async": true,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "api",
          "kind": "variable",
          "signature": "api",
          "lines": [
            223,
            710
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "$lib/types"
      ]
    },
    {
      "path": "src/web/app/src/lib/index.ts",
      "language": "typescript",
      "lines": [
        1,
        18
      ],
      "detail_level": "full",
      "token_estimate": 42,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./api/client",
        "./stores/daemon",
        "./stores/nodes",
        "./stores/toast",
        "./stores/websocket",
        "./types"
      ]
    },
    {
      "path": "src/web/app/src/lib/stores/daemon.ts",
      "language": "typescript",
      "lines": [
        1,
        132
      ],
      "detail_level": "full",
      "token_estimate": 125,
      "symbols": [
        {
          "name": "DEFAULT_POLL_INTERVAL_MS",
          "kind": "variable",
          "signature": "30000",
          "lines": [
            15,
            15
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Default polling interval: 30 seconds",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonState",
          "kind": "interface",
          "signature": "DaemonState",
          "lines": [
            17,
            26
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "initialState",
          "kind": "variable",
          "signature": "DaemonState",
          "lines": [
            28,
            35
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createDaemonStore",
          "kind": "function",
          "signature": "createDaemonStore(): { subscribe: any; loadStatus(): any; startPolling(intervalMs?: number): void; stopPolling(): void; setStatus(status: DaemonStatus): void; reset(): void; }",
          "lines": [
            37,
            129
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "daemonStore",
          "kind": "variable",
          "signature": "daemonStore",
          "lines": [
            131,
            131
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "$lib/api/client",
        "$lib/types",
        "svelte/store"
      ]
    },
    {
      "path": "src/web/app/src/lib/stores/nodes.ts",
      "language": "typescript",
      "lines": [
        1,
        112
      ],
      "detail_level": "full",
      "token_estimate": 137,
      "symbols": [
        {
          "name": "NodesState",
          "kind": "interface",
          "signature": "NodesState",
          "lines": [
            10,
            20
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "initialState",
          "kind": "variable",
          "signature": "NodesState",
          "lines": [
            22,
            32
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createNodesStore",
          "kind": "function",
          "signature": "createNodesStore(): { subscribe: any; loadNodes(filters?: NodeFilters, options?: { limit?: number; offset?: number; }): any; loadConnected(nodeId: string, depth?: number): any; selectNode(nodeId: string): void; setFilters(filters: NodeFilters): void; reset(): void; }",
          "lines": [
            34,
            103
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "nodesStore",
          "kind": "variable",
          "signature": "nodesStore",
          "lines": [
            105,
            105
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "selectedNode",
          "kind": "variable",
          "signature": "any",
          "lines": [
            108,
            111
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "$lib/api/client",
        "$lib/types",
        "svelte/store"
      ]
    },
    {
      "path": "src/web/app/src/lib/stores/toast.ts",
      "language": "typescript",
      "lines": [
        1,
        114
      ],
      "detail_level": "full",
      "token_estimate": 168,
      "symbols": [
        {
          "name": "ToastType",
          "kind": "type",
          "signature": "ToastType = \"success\" | \"error\" | \"warning\" | \"info\"",
          "lines": [
            7,
            7
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "Toast",
          "kind": "interface",
          "signature": "Toast",
          "lines": [
            9,
            15
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToastState",
          "kind": "interface",
          "signature": "ToastState",
          "lines": [
            17,
            19
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "initialState",
          "kind": "variable",
          "signature": "ToastState",
          "lines": [
            21,
            23
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "toastIdCounter",
          "kind": "variable",
          "signature": "number",
          "lines": [
            25,
            25
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createToastStore",
          "kind": "function",
          "signature": "createToastStore(): { subscribe: any; success(message: string, duration?: number): string; error(message: string, duration?: number): string; warning(message: string, duration?: number): string; info(message: string, duration?: number): string; dismiss(id: string): void; dismissAll(): void; }",
          "lines": [
            27,
            108
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "toastStore",
          "kind": "variable",
          "signature": "toastStore",
          "lines": [
            110,
            110
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "toasts",
          "kind": "variable",
          "signature": "any",
          "lines": [
            113,
            113
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "svelte/store"
      ]
    },
    {
      "path": "src/web/app/src/lib/stores/websocket.ts",
      "language": "typescript",
      "lines": [
        1,
        179
      ],
      "detail_level": "full",
      "token_estimate": 110,
      "symbols": [
        {
          "name": "WSState",
          "kind": "interface",
          "signature": "WSState",
          "lines": [
            10,
            14
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "MAX_RECONNECT_DELAY",
          "kind": "variable",
          "signature": "60000",
          "lines": [
            16,
            16
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "BASE_DELAY",
          "kind": "variable",
          "signature": "1000",
          "lines": [
            17,
            17
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getDefaultWsUrl",
          "kind": "function",
          "signature": "getDefaultWsUrl(): string",
          "lines": [
            19,
            39
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "createWebSocketStore",
          "kind": "function",
          "signature": "createWebSocketStore(): { subscribe: any; connect: (url?: string) => void; disconnect: () => void; send: (message: Record<string, unknown>) => void; }",
          "lines": [
            41,
            176
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "wsStore",
          "kind": "variable",
          "signature": "wsStore",
          "lines": [
            178,
            178
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./daemon",
        "./nodes",
        "svelte/store"
      ]
    },
    {
      "path": "src/web/app/src/lib/types.ts",
      "language": "typescript",
      "lines": [
        1,
        325
      ],
      "detail_level": "full",
      "token_estimate": 348,
      "symbols": [
        {
          "name": "LessonEntity",
          "kind": "interface",
          "signature": "LessonEntity extends Omit<Lesson, \"tags\">",
          "lines": [
            78,
            84
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ModelQuirkEntity",
          "kind": "interface",
          "signature": "ModelQuirkEntity extends ModelQuirk",
          "lines": [
            86,
            91
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ToolErrorEntity",
          "kind": "interface",
          "signature": "ToolErrorEntity extends ToolError",
          "lines": [
            93,
            98
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ListNodesResponse",
          "kind": "interface",
          "signature": "ListNodesResponse",
          "lines": [
            101,
            106
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SearchResult",
          "kind": "interface",
          "signature": "SearchResult",
          "lines": [
            108,
            116
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DashboardStats",
          "kind": "interface",
          "signature": "DashboardStats",
          "lines": [
            118,
            148
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonStatus",
          "kind": "interface",
          "signature": "DaemonStatus",
          "lines": [
            150,
            170
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "DaemonDecisionEntity",
          "kind": "interface",
          "signature": "DaemonDecisionEntity",
          "lines": [
            174,
            183
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "NodeFilters",
          "kind": "interface",
          "signature": "NodeFilters",
          "lines": [
            186,
            195
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ProjectSummary",
          "kind": "interface",
          "signature": "ProjectSummary",
          "lines": [
            198,
            203
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SessionSummary",
          "kind": "interface",
          "signature": "SessionSummary",
          "lines": [
            205,
            219
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterNodeWithDetails",
          "kind": "interface",
          "signature": "ClusterNodeWithDetails extends ClusterNode",
          "lines": [
            222,
            227
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterWithNodes",
          "kind": "interface",
          "signature": "ClusterWithNodes extends Cluster",
          "lines": [
            229,
            231
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterFeedResponse",
          "kind": "interface",
          "signature": "ClusterFeedResponse",
          "lines": [
            233,
            236
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "ClusterListResponse",
          "kind": "interface",
          "signature": "ClusterListResponse",
          "lines": [
            238,
            243
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AbandonedRestartPattern",
          "kind": "interface",
          "signature": "AbandonedRestartPattern",
          "lines": [
            246,
            262
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "AbandonedRestartsResponse",
          "kind": "interface",
          "signature": "AbandonedRestartsResponse",
          "lines": [
            264,
            270
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "FrictionSummary",
          "kind": "interface",
          "signature": "FrictionSummary",
          "lines": [
            272,
            285
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SyncMethod",
          "kind": "type",
          "signature": "SyncMethod = \"syncthing\" | \"rsync\" | \"api\"",
          "lines": [
            288,
            288
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "RsyncOptions",
          "kind": "interface",
          "signature": "RsyncOptions",
          "lines": [
            290,
            295
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeConfig",
          "kind": "interface",
          "signature": "SpokeConfig",
          "lines": [
            297,
            305
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeCreateRequest",
          "kind": "interface",
          "signature": "SpokeCreateRequest",
          "lines": [
            307,
            315
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SpokeUpdateRequest",
          "kind": "interface",
          "signature": "SpokeUpdateRequest",
          "lines": [
            317,
            324
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../../../../types/index.js"
      ]
    },
    {
      "path": "src/web/app/src/lib/utils/date.ts",
      "language": "typescript",
      "lines": [
        1,
        94
      ],
      "detail_level": "full",
      "token_estimate": 211,
      "symbols": [
        {
          "name": "SECONDS_PER_MINUTE",
          "kind": "variable",
          "signature": "60",
          "lines": [
            5,
            5
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Date formatting utilities for pi-brain web UI",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SECONDS_PER_HOUR",
          "kind": "variable",
          "signature": "number",
          "lines": [
            6,
            6
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SECONDS_PER_DAY",
          "kind": "variable",
          "signature": "number",
          "lines": [
            7,
            7
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SECONDS_PER_WEEK",
          "kind": "variable",
          "signature": "number",
          "lines": [
            8,
            8
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SECONDS_PER_MONTH",
          "kind": "variable",
          "signature": "number",
          "lines": [
            9,
            9
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "SECONDS_PER_YEAR",
          "kind": "variable",
          "signature": "number",
          "lines": [
            10,
            10
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatDistanceToNow",
          "kind": "function",
          "signature": "formatDistanceToNow(date: Date): string",
          "lines": [
            16,
            51
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format a date as a relative distance from now\ne.g., \"5 minutes ago\", \"2 hours ago\", \"3 days ago\"",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatDate",
          "kind": "function",
          "signature": "formatDate(date: Date): string",
          "lines": [
            56,
            65
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format a date as \"MMM D, YYYY at h:mm AM/PM\"",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatDateShort",
          "kind": "function",
          "signature": "formatDateShort(date: Date): string",
          "lines": [
            70,
            76
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format a date as \"MMM D, YYYY\"",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "formatDateForInput",
          "kind": "function",
          "signature": "formatDateForInput(date: Date): string",
          "lines": [
            81,
            86
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Format a date as \"YYYY-MM-DD\" for input[type=\"date\"]",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "parseDate",
          "kind": "function",
          "signature": "parseDate(date: string | Date): Date",
          "lines": [
            91,
            93
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Parse a date string or Date object to Date",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": []
    },
    {
      "path": "src/web/app/vite.config.ts",
      "language": "typescript",
      "lines": [
        1,
        15
      ],
      "detail_level": "full",
      "token_estimate": 20,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "@sveltejs/kit/vite",
        "vite"
      ]
    },
    {
      "path": "src/web/generator.ts",
      "language": "typescript",
      "lines": [
        1,
        948
      ],
      "detail_level": "full",
      "token_estimate": 233,
      "symbols": [
        {
          "name": "CompactSessionInfo",
          "kind": "interface",
          "signature": "CompactSessionInfo",
          "lines": [
            23,
            34
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Compact session info for embedding (removes full content)",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CompactTreeNode",
          "kind": "interface",
          "signature": "CompactTreeNode",
          "lines": [
            36,
            52
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "CompactVisualizationData",
          "kind": "interface",
          "signature": "CompactVisualizationData",
          "lines": [
            54,
            60
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": null,
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "compressSession",
          "kind": "function",
          "signature": "compressSession(session: SessionInfo): CompactSessionInfo",
          "lines": [
            65,
            78
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Compress session data for embedding",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "compressTree",
          "kind": "function",
          "signature": "compressTree(node: TreeNode): CompactTreeNode",
          "lines": [
            83,
            145
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Compress tree node",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "truncateContent",
          "kind": "function",
          "signature": "truncateContent(content: unknown, maxLength = 100): string",
          "lines": [
            150,
            165
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Truncate content to a max length",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "generateHTML",
          "kind": "function",
          "signature": "generateHTML(sessions: SessionInfo[], forks: ForkRelationship[]): string",
          "lines": [
            170,
            240
          ],
          "exported": true,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "Generate complete visualization HTML",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getStyles",
          "kind": "function",
          "signature": "getStyles(): string",
          "lines": [
            245,
            671
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "CSS styles for the visualization",
          "incoming_refs": null,
          "outgoing_refs": null
        },
        {
          "name": "getScript",
          "kind": "function",
          "signature": "getScript(): string",
          "lines": [
            676,
            947
          ],
          "exported": false,
          "is_default": false,
          "is_async": false,
          "is_static": false,
          "is_abstract": false,
          "parent_name": null,
          "annotation": null,
          "comment": "JavaScript for interactivity",
          "incoming_refs": null,
          "outgoing_refs": null
        }
      ],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "../parser/analyzer.js",
        "../types.js"
      ]
    },
    {
      "path": "src/web/index.ts",
      "language": "typescript",
      "lines": [
        1,
        6
      ],
      "detail_level": "full",
      "token_estimate": 14,
      "symbols": [],
      "annotation": null,
      "headings": null,
      "code_blocks": null,
      "imports": [
        "./generator.js"
      ]
    }
  ]
}
